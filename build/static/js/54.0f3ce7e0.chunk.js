(this["webpackJsonpreact-redux-typescript-advance"]=this["webpackJsonpreact-redux-typescript-advance"]||[]).push([[54],{201:function(t,e,s){"use strict";s.d(e,"b",(function(){return d})),s.d(e,"g",(function(){return h})),s.d(e,"e",(function(){return b})),s.d(e,"a",(function(){return m})),s.d(e,"c",(function(){return f})),s.d(e,"h",(function(){return g})),s.d(e,"f",(function(){return x})),s.d(e,"d",(function(){return j}));var n=s(5),o=s.n(n),i=s(7),r=s(8),a=s.n(r),c=s(6),u=s(9),l=s(13),p=s(12),d=function(t){return t(!0,""),function(){var e=Object(i.a)(o.a.mark((function e(s){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Object(l.b)(),e.next=4,a.a.get("".concat(u.a.CLAIMING,"/session-type"));case 4:n=e.sent,console.log({GET_PLANS_TYPES:n.data}),i=[],200===n.status&&null!==n.data&&n.data.length>0&&(i=n.data),s({type:c.a.GET_PLANS_TYPES,payload:i}),t(!1,""),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error({error:Object(p.a)(e.t0)}),t(!1,Object(p.a)(e.t0));case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()},h=function(t){return console.log({thisType:t}),{type:c.a.SELECT_PLAN_TYPE,payload:t}},b=function(t){return t(!0,""),function(){var e=Object(i.a)(o.a.mark((function e(s){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Object(l.b)(),e.next=4,a.a.get("".concat(u.a.CLAIMING,"/session/active/"));case 4:n=e.sent,console.log({GET_ACTIVE_SESSION_PLANS:n.data}),i=void 0,n.data&&void 0!==n.data.is_active&&(i=n.data),console.log({session_plan:n.data}),s({type:c.a.GET_ACTIVE_SESSION_PLANS,payload:i||"none"}),t(!1,"",i||"none"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error({error:Object(p.a)(e.t0)}),t(!1,Object(p.a)(e.t0));case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}()},m=function(t){return t(!0,""),function(){var e=Object(i.a)(o.a.mark((function e(s){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Object(l.b)(),e.next=4,a.a.get("".concat(u.a.CLAIMING,"/session/"));case 4:n=e.sent,console.log({GET_ALL_SESSION_PLANS:n.data}),i=[],200===n.status&&null!==n.data&&n.data.length>0&&(i=n.data),s({type:c.a.GET_ALL_SESSION_PLANS,payload:i}),t(!1,"",i),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error({error:Object(p.a)(e.t0)}),t(!1,Object(p.a)(e.t0));case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()},f=function(t){return{type:c.a.CREATE_SESSION_PLAN,payload:t}},g=function(t){return{type:c.a.UPDATE_SESSION_PLAN,payload:t}},x=function(t){return{type:c.a.SESSION_ACTIVATION,payload:t}},j=function(t){return{type:c.a.DELETE_SESSION_PLAN,payload:t}}},209:function(t,e,s){"use strict";s.d(e,"e",(function(){return d})),s.d(e,"c",(function(){return h})),s.d(e,"a",(function(){return b})),s.d(e,"d",(function(){return m})),s.d(e,"b",(function(){return f})),s.d(e,"f",(function(){return g}));var n=s(5),o=s.n(n),i=s(7),r=s(8),a=s.n(r),c=s(6),u=s(9),l=s(13),p=s(12),d=function(t){return function(){var e=Object(i.a)(o.a.mark((function e(s){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(!0,""),e.prev=1,Object(l.b)(),e.next=5,a.a.get("".concat(u.a.AUTH,"/settings"));case 5:n=e.sent,s({type:c.a.GET_SYSTEM_SETTINGS,payload:n.data}),t(!1,""),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log({code_error:e.t0}),t(!1,Object(p.a)(e.t0));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()},h=function(t){return function(){var e=Object(i.a)(o.a.mark((function e(s){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s({type:c.a.DISABLE_SYSTEM_SETTINGS,payload:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},b=function(t){return function(){var e=Object(i.a)(o.a.mark((function e(s){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(!0,""),e.prev=1,Object(l.b)(),e.next=5,a.a.get("".concat(u.a.AUTH,"/allroleaccess"));case 5:n=e.sent,i=n.data.map((function(t){return{id:t.id,task:t.title,key:t.key,permitted:t.permitted}})),s({type:c.a.GET_TASK_ACCESS,payload:i}),t(!1,"",i),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),console.log({code_error:e.t0}),t(!1,Object(p.a)(e.t0));case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()},m=function(t){return function(){var e=Object(i.a)(o.a.mark((function e(s){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(!0,""),e.prev=1,Object(l.b)(),e.next=5,a.a.get("".concat(u.a.APPLICATION,"/position"));case 5:n=e.sent,s({type:c.a.GET_POSTIONS,payload:n.data}),t(!1,""),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log({code_error:e.t0}),t(!1,Object(p.a)(e.t0));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()},f=function(t){return console.log({deletePosition:t}),function(){var e=Object(i.a)(o.a.mark((function e(s){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s({type:c.a.DELETE_POSITION,payload:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=function(t){return function(){var e=Object(i.a)(o.a.mark((function e(s){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s({type:c.a.PUBLISH_POSITION,payload:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},846:function(t,e,s){"use strict";s.r(e),s.d(e,"marksArray",(function(){return U})),s.d(e,"MarksPublication",(function(){return B}));var n,o=s(5),i=s.n(o),r=s(7),a=s(21),c=s(20),u=s(23),l=s(22),p=s(8),d=s.n(p),h=s(4),b=s(10),m=s(27),f=s(18),g=s(3),x=s(6),j=s(9),k=s(13),v=s(12),P=s(201),y=s(209),O=s(29),_=s(91),N=s.n(_),M=s(197),A=s(11),C=s(33),w=s(1),S=function(t){Object(u.a)(s,t);var e=Object(l.a)(s);function s(t){var n;return Object(a.a)(this,s),(n=e.call(this,t)).setCustomMarks=function(t,e){var s=Object(A.a)(n.props.customMarks),o=s.findIndex((function(e){return e.id===t}));o>=0?s[o].marks=Number(e):s.push({id:t,marks:Number(e)}),n.props.setCustomMarks(s)},n.getMarkByPosition=function(t){return n.props.customMarks.find((function(e){return e.id===t}))},n.setSearchInput=function(t){n.setState({searchInput:t})},n.state={searchInput:""},n}return Object(c.a)(s,[{key:"render",value:function(){var t=this;return Object(w.jsxs)("section",{className:"rounded",children:[Object(w.jsxs)("div",{className:"flex items-center w-full my-1",children:[Object(w.jsx)(b.Cb,{className:"w-6 h-6 absolute ml-2"}),Object(w.jsx)("input",{type:"text",placeholder:"Search",className:"focus:border-2 h-7 ml-1 pl-9 mr-2 bg-gray-100 border-gray-600 focus:border-gray-700 w-full rounded",onChange:function(e){return t.setSearchInput(e.target.value)},value:this.state.searchInput,disabled:!(this.props.positionList.length>0)}),Object(w.jsx)("div",{className:"flex items-center w-auto justify-end gap-1",children:Object(w.jsx)("button",{className:"bg-red-200 text-red-700 py-1 px-2 mr-1 rounded text-sm focus:outline-none",type:"button",onClick:function(){return t.props.setChoosePosition(!1)},children:"Close"})})]}),Object(w.jsx)("div",{className:"w-full h-96 mt-2 divide-y divide-gray-300 overflow-y-auto",children:Object(C.a)(this.props.positionList,this.state.searchInput).length>0?Object(C.a)(this.props.positionList,this.state.searchInput).map((function(e,s){return Object(w.jsx)("section",{children:Object(w.jsxs)("div",{className:"group flex items-center justify-between my-1 hover:bg-gray-100",children:[Object(w.jsx)("div",{className:"p-1 w-full mr-2",children:Object(w.jsx)("p",{className:"text-base font-medium text-black",children:e.position_title})}),Object(w.jsx)("input",{type:"number",min:0,max:100,value:t.getMarkByPosition(e.position_id)?t.getMarkByPosition(e.position_id).marks:t.props.defaultMarks,onChange:function(s){return t.setCustomMarks(e.position_id,s.target.value)},className:"rounded border-2 border-gray-500 focus:border-gray-700 focus:outline-none"})]})},s+e.position_id)})):Object(w.jsx)("div",{className:"text-center p-3",children:Object(w.jsx)("p",{className:"text-base font-medium text-black",children:"No position available"})})})]})}}]),s}(h.Component),E=function(t){Object(u.a)(s,t);var e=Object(l.a)(s);function s(t){var n;return Object(a.a)(this,s),(n=e.call(this,t)).setChoosePosition=function(t){n.setState({choosePosition:t})},n.setFormError=function(t){n.setState({formError:t})},n.changeDefaultMarks=function(t){n.props.customMarks.length>0&&window.confirm("Do you want the default pass mark to override the customized pass marks on some position")&&n.props.setCustomMarks([]),n.props.setInputMarks(t)},n.cleanBeforeClose=function(){"CREATE"===n.props.modalAction&&(n.props.setInputMarks(70),n.props.setInputComment(""),n.props.setCustomMarks([]),n.props.setModalAction(!1))},n.handleSubmit=function(){var t=Object(r.a)(i.a.mark((function t(e){var s,o,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),!(n.props.positionList.length<=0)){t.next=3;break}return t.abrupt("return",n.setFormError({element:"position",msg:"There is no published position available"}));case 3:if(!Object(M.f)(n.props.inputComment)){t.next=5;break}return t.abrupt("return",n.setFormError({element:"comment",msg:"Comment is required"}));case 5:if(window.confirm("Are you sure you wanted to submit")){t.next=7;break}return t.abrupt("return");case 7:return o=[],n.props.positionList.forEach((function(t){if(n.props.customMarks.length>0){var e=n.props.customMarks.find((function(e){return e.id===t.position_id}));e?o.push({position:e.id,marks:e.marks,comment:n.props.inputComment}):o.push({position:t.position_id,marks:n.props.inputMarks,comment:n.props.inputComment})}else o.push({position:t.position_id,marks:n.props.inputMarks,comment:n.props.inputComment})})),s={session:n.props.sessions.session_plan_id,doneby:n.props.auth.user.user_id,created_date:N()(N()().toDate()).format("YYYY-MM-DD").toString(),publication_position_marks:o},console.log("===================================="),console.log({requestData:s}),console.log("===================================="),n.props.setLoadingRequest(!0),t.prev=14,t.next=17,d.a.post("".concat(j.a.CLAIMING,"/publication"),s);case 17:(r=t.sent)&&(console.log("===================================="),console.log({res:r}),console.log("===================================="),n.props.createMarksPublication(r.data),n.props.PushPopupAlert({title:"Mark published successfully!",theme:O.a.success})),n.cleanBeforeClose(),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(14),console.error(t.t0),n.props.PushPopupAlert({title:Object(v.a)(t.t0),theme:O.a.danger});case 26:n.props.setLoadingRequest(!1);case 27:case"end":return t.stop()}}),t,null,[[14,22]])})));return function(e){return t.apply(this,arguments)}}(),n.state={searchPosition:"",formError:null,choosePosition:!1},n}return Object(c.a)(s,[{key:"render",value:function(){var t=this;return Object(w.jsx)("form",{onSubmit:function(e){return t.handleSubmit(e)},method:"post",children:Object(w.jsxs)("div",{className:"pt-2 pb-4 w-full bg-gray-100 px-5 flex flex-col gap-2",children:[Object(w.jsxs)("div",{className:"flex flex-col",children:[Object(w.jsx)("label",{children:"Session"}),Object(w.jsx)("input",{type:"text",className:"text-left input-white w-full inline-block border-gray-500 border-2",placeholder:"Sub Category Title",value:Object(M.a)(this.props.sessions.session_plan_name),disabled:!0})]}),Object(w.jsxs)("div",{className:"flex flex-col",children:[Object(w.jsx)("label",{children:"Default pass marks"}),Object(w.jsx)("select",{className:"outline-none bg-white text-gray-700 text-base mr-1 py-2 px-2 border-2 border-gray-500 rounded",value:this.props.inputMarks,onChange:function(e){return t.changeDefaultMarks(Number(e.target.value))},children:U().map((function(t,e){return Object(w.jsx)("option",{value:t||"-1",children:t},e*(t||-1))}))})]}),Object(w.jsxs)("div",{className:"flex flex-col",children:[Object(w.jsx)("label",{children:"Customize pass marks by position"}),Object(w.jsxs)("div",{className:"text-left bg-white border-2 border-gray-500 rounded w-full ".concat(this.state.choosePosition?"h-auto":"h-10"," ").concat(this.state.formError&&"position"===this.state.formError.element?"border-red-500":""," border-2 ").concat(this.props.loadingRequest?"cursor-not-allowed":"cursor-pointer"),title:"Choose position",onClick:function(){!t.state.choosePosition&&t.setChoosePosition(!0),t.state.formError&&"position"===t.state.formError.element&&t.setFormError(null)},children:[this.props.customMarks.length>0&&!this.state.choosePosition?Object(w.jsx)("p",{className:"my-1 mx-2 text-gray-700",children:"Some position has customized pass marks"}):!this.state.choosePosition&&Object(w.jsx)("p",{className:"my-1 mx-2 text-gray-500",children:"Click to view position"}),this.state.choosePosition&&Object(w.jsx)(S,{positionList:this.props.positionList,setChoosePosition:this.setChoosePosition,loadingRequest:this.props.loadingRequest,defaultMarks:this.props.inputMarks,customMarks:this.props.customMarks,setCustomMarks:this.props.setCustomMarks})]}),this.state.formError&&"position"===this.state.formError.element&&Object(w.jsx)("span",{className:"text-red-500",children:this.state.formError.msg})]}),Object(w.jsxs)("div",{className:"flex flex-col",children:[Object(w.jsx)("label",{children:"Comment"}),Object(w.jsx)("textarea",{placeholder:"Comment for pass mark",cols:50,rows:3,className:"border-2 ".concat(this.state.formError&&"comment"===this.state.formError.element?"border-red-400":"border-gray-500"," rounded px-3 py-1 w-full focus:outline-none"),style:{resize:"none"},value:this.props.inputComment,onChange:function(e){t.props.setInputComment(e.target.value),t.setFormError(null)},disabled:this.props.loadingRequest}),this.state.formError&&"comment"===this.state.formError.element&&Object(w.jsx)("p",{className:"text-red-800",children:this.state.formError.msg})]}),Object(w.jsxs)("div",{className:"pt-4 flex justify-between",children:[Object(w.jsx)("button",{onClick:function(){t.cleanBeforeClose()},className:"btn bg-gray-400 text-white hover:bg-gray-600 focus:outline-none ".concat(this.props.loadingRequest&&"cursor-not-allowed"),type:"button",disabled:this.props.loadingRequest,children:"Exit"}),Object(w.jsx)("div",{className:"flex items-center gap-1",children:Object(w.jsx)("button",{className:"btn bg-primary text-white hover:bg-blue-600 focus:outline-none ".concat(this.props.loadingRequest&&"cursor-wait"),type:"submit",disabled:this.props.loadingRequest,children:this.props.loadingRequest?"Loading...":"Save"})})]})]})})}}]),s}(h.Component),I=Object(f.b)((function(t){return{auth:t.auth}}),{createMarksPublication:function(t){return{type:x.a.CREATE_MARKS_PUBLICATION,payload:t}},PushPopupAlert:g.tb})(E),L=s(205),T=s(67),R=s(76),q=function(t){Object(u.a)(s,t);var e=Object(l.a)(s);function s(t){var n;return Object(a.a)(this,s),(n=e.call(this,t)).setSearchInput=function(t){n.setState({searchInput:t})},n.styelingController=function(t){var e="",s="bg-blue-100 group-hover:bg-blue-50";return n.props.thisPosition&&n.props.thisPosition.position_id===t.position_id&&(n.props.thisPosition.isPublished?(e="bg-blue-100 border border-blue-500",s="bg-blue-100 group-hover:bg-blue-50"):(e="bg-yellow-100 border border-yellow-500",s="bg-yellow-100 group-hover:bg-yellow-50")),{section:e,button:s}},n.getNeededData=function(t,e,s){var n=[];return t.forEach((function(t){var o="none"!==s?e.find((function(t){return t.session===s.session_plan_id})):void 0;if(o){var i=o.publication_position_marks.find((function(e){return e.position===t.position_id}));i&&n.push({province_id:t.province_id,province_name:t.province_name,courses:t.courses,position_title:t.position_title,description:t.description,school_level_id:t.school_level_id,education_institute_id:t.education_institute_id,requirements:t.requirements,isDeleted:t.isDeleted,isPublished:t.isPublished,position_id:t.position_id,marks:i.marks})}})),n},n.setCustomMarks=function(t,e){if(Number(e)<0||Number(e)>100)return n.props.PushPopupAlert({title:"Pass marks must be less or equal to 100 and greater or equal to 0",theme:O.a.danger});var s=Object(A.a)(n.props.customMarks),o=s.findIndex((function(e){return e.id===t}));o>=0?s[o].marks=Number(e):s.push({id:t,marks:Number(e)}),n.props.setCustomMarks(s)},n.getMarkByPosition=function(t){return n.props.customMarks.find((function(e){return e.id===t}))},n.state={searchInput:""},n}return Object(c.a)(s,[{key:"render",value:function(){var t=this;return"none"===this.props.sessions?Object(w.jsxs)("div",{className:"py-10 flex flex-col items-center rounded border border-gray-300 bg-white text-2xl font-medium text-yellow-800 animate__animated animate__pulse",children:[Object(w.jsx)(T.l,{className:"w-32 h-32"}),"No Active session available!"]}):Object(w.jsxs)("div",{children:[this.props.positionList.length<=0&&Object(w.jsxs)("div",{className:"text-gray-400 px-6 py-4 rounded border mt-4 text-xl font-extrabold flex flex-col items-center justify-center bg-gray-100",children:[Object(w.jsx)(L.d,{className:"text-7xl text-gray-400 animate__animated animate__shakeX"}),Object(w.jsx)("span",{children:"No position available"})]}),this.props.positionList.length>0&&Object(w.jsx)("section",{className:"flex flex-col-reverse sm:flex-row items-center gap-2 w-full my-2",children:Object(w.jsx)("div",{className:"w-full",children:Object(w.jsx)("input",{onChange:function(e){return t.setSearchInput(e.target.value)},type:"text",className:"input-white h-10 text-sm border-2 border-gray-400 focus:border-gray-500 w-full",placeholder:"Search position by title or description",value:this.state.searchInput,disabled:!(this.getNeededData(this.props.positionList,this.props.marksPublication,this.props.sessions).length>0)})})}),Object(C.a)(this.getNeededData(this.props.positionList,this.props.marksPublication,this.props.sessions),this.state.searchInput).length>0?Object(C.a)(this.getNeededData(this.props.positionList,this.props.marksPublication,this.props.sessions),this.state.searchInput).map((function(e,s){return Object(w.jsx)("div",{className:"border hover:bg-blue-50",children:Object(w.jsxs)("div",{className:"w-full flex flex-row px-3 py-2 rounded items-start my-1 justify-between group ".concat(t.styelingController(e).section),children:[Object(w.jsxs)("div",{className:"flex flex-col",onClick:function(){!t.props.loadingRequest&&t.props.thisPosition&&t.props.thisPosition.position_id===e.position_id?t.props.setThisPosition(null):t.props.setThisPosition(e)},children:[Object(w.jsx)("span",{className:"text-gray-600 font-bold",children:e.position_title}),Object(w.jsx)("span",{className:"text-xs pr-5 text-gray-500",children:e.description})]}),Object(w.jsx)("div",{className:"flex flex-row items-center gap-2",children:t.props.isUpdateOn?Object(w.jsx)("input",{type:"number",min:0,max:100,value:t.getMarkByPosition(e.position_id)?t.getMarkByPosition(e.position_id).marks:t.props.defaultChanged?t.props.defaultMarks:e.marks,onChange:function(s){return t.setCustomMarks(e.position_id,s.target.value)},className:"rounded border-2 border-gray-500 focus:border-gray-700 focus:outline-none"}):Object(w.jsxs)("span",{className:"text-gray-600 italic font-semibold",children:[e.marks,"%"]})})]})},s+e.position_id)})):Object(w.jsx)(R.b,{theme:R.a.Dark,value:"No position found"})]})}}]),s}(h.Component),D=Object(f.b)(null,{PushPopupAlert:g.tb})(q),U=function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=t?[null]:[0],s=0;s<=100;)e.push(s),s++;return e};!function(t){t.withMarks="Published position(s)",t.withoutMarks="None published position"}(n||(n={}));var G=function(t){Object(u.a)(s,t);var e=Object(l.a)(s);function s(t){var o;return Object(a.a)(this,s),(o=e.call(this,t)).setLoading=function(t){o.setState({loading:t})},o.setLoadingRequest=function(t){o.setState({loadingRequest:t})},o.setModalAction=function(t){o.setState({modalAction:t})},o.setThisTab=function(t){t!==o.state.thisTabs&&o.setState({thisTabs:t,positionId:[],thisPosition:null})},o.setThisPosition=function(t){o.setState({thisPosition:t})},o.setPositionId=function(t){o.setState({positionId:t})},o.setCustomMarks=function(t){o.setState({customMarks:t})},o.setInputMarks=function(t){o.setState({inputMarks:t})},o.setInputComment=function(t){o.setState({inputComment:t})},o.loadPositions=function(){null===o.props.systemPositions?o.props.getPositions((function(t,e){o.setLoading(t),console.log({status:t,msg:e}),!t&&e.length&&o.props.PushPopupAlert({title:e,theme:O.a.danger})})):o.state.loading&&o.setLoading(!1)},o.componentDidMount=function(){null===o.props.sessions||"none"===o.props.sessions?o.props.getActiveSessionPlan((function(t,e,s){o.setLoading(t),t||(e.length&&o.props.PushPopupAlert({title:e,theme:O.a.danger}),s&&"none"!==s&&o.loadPositions())})):o.loadPositions(),null===o.props.marksPublication&&o.props.getMarksPublication((function(t,e,s){o.setLoading(t),!t&&e.length>0&&o.props.PushPopupAlert({title:e,theme:O.a.danger}),!t&&s&&(console.log("===================================="),console.log({data:s}),console.log("===================================="))}))},o.FC_neededPositions=function(t){var e={withMarks:[],withoutMarks:[]},s=t.filter((function(t){return t.isPublished&&!t.isDeleted}));return e.withoutMarks=s,e},o.isMarkPublished=function(t,e){if(t.length>0){var s=t.find((function(t){return t.session===e.session_plan_id}));if(s&&"PUBLISHED"===s.publication_status)return!0}return!1},o.isUpdateAllowed=function(t,e){if(t.length>0&&t.find((function(t){return t.session===e.session_plan_id})))return!0;return!1},o.changeDefaultMarks=function(t){o.state.customMarks.length>0&&window.confirm("Do you want the default pass mark to override the customized pass marks on some position")&&o.setCustomMarks([]),o.setState({defaultChanged:!0}),o.setInputMarks(t)},o.handleUpdate=Object(r.a)(i.a.mark((function t(){var e,s,n,r,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==o.props.sessions){t.next=2;break}return t.abrupt("return",o.props.PushPopupAlert({title:"Load session first!",theme:O.a.info}));case 2:if("none"!==o.props.sessions){t.next=4;break}return t.abrupt("return",o.props.PushPopupAlert({title:"No active session available!",theme:O.a.info}));case 4:if(null!==o.props.marksPublication){t.next=6;break}return t.abrupt("return",o.props.PushPopupAlert({title:"Load published pass marks first!",theme:O.a.info}));case 6:if(e=o.props.sessions,s=o.props.marksPublication.find((function(t){return t.session===e.session_plan_id}))){t.next=10;break}return t.abrupt("return",o.props.PushPopupAlert({title:"No pass marks publication available! Add pass marks instead!",theme:O.a.info}));case 10:if(!(o.state.customMarks.length<=0)||o.state.defaultChanged){t.next=12;break}return t.abrupt("return",o.props.PushPopupAlert({title:"No change have been done!",theme:O.a.info}));case 12:if(window.confirm("Are you sure you wanted to update")){t.next=14;break}return t.abrupt("return");case 14:return r=[],s.publication_position_marks.forEach((function(t){if(o.state.customMarks.length>0){var e=o.state.customMarks.find((function(e){return e.id===t.position}));e?r.push({_id:t._id,position:e.id,marks:e.marks,comment:t.comment}):o.state.defaultChanged?r.push({_id:t._id,position:t.position,marks:o.state.inputMarks,comment:t.comment}):r.push({_id:t._id,position:t.position,marks:t.marks,comment:t.comment})}else o.state.defaultChanged?r.push({_id:t._id,position:t.position,marks:o.state.inputMarks,comment:t.comment}):r.push({_id:t._id,position:t.position,marks:t.marks,comment:t.comment})})),n={session:s.session,doneby:o.props.auth.user.user_id,created_date:s.created_date,publication_position_marks:r,publication_id:s.publication_id,publication_status:s.publication_status,status:s.status,createdAt:s.createdAt,updatedAt:s.updatedAt},console.log("===================================="),console.log({requestData:n}),console.log("===================================="),o.setLoadingRequest(!0),t.prev=21,t.next=24,d.a.put("".concat(j.a.CLAIMING,"/publication/").concat(s.publication_id),n);case 24:(a=t.sent)&&(console.log("===================================="),console.log({res:a}),console.log("===================================="),o.props.updateMarksPublication(a.data),o.props.PushPopupAlert({title:"Pass mark updated successfully!",theme:O.a.success})),o.cleanBeforeClose(),t.next=33;break;case 29:t.prev=29,t.t0=t.catch(21),console.error(t.t0),o.props.PushPopupAlert({title:Object(v.a)(t.t0),theme:O.a.danger});case 33:o.setLoadingRequest(!1);case 34:case"end":return t.stop()}}),t,null,[[21,29]])}))),o.handlePublishMarks=Object(r.a)(i.a.mark((function t(){var e,s,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==o.props.sessions){t.next=2;break}return t.abrupt("return",o.props.PushPopupAlert({title:"Load session first!",theme:O.a.info}));case 2:if("none"!==o.props.sessions){t.next=4;break}return t.abrupt("return",o.props.PushPopupAlert({title:"No active session available!",theme:O.a.info}));case 4:if(null!==o.props.marksPublication){t.next=6;break}return t.abrupt("return",o.props.PushPopupAlert({title:"Load published pass marks first!",theme:O.a.info}));case 6:if(e=o.props.sessions,s=o.props.marksPublication.find((function(t){return t.session===e.session_plan_id}))){t.next=10;break}return t.abrupt("return",o.props.PushPopupAlert({title:"No pass marks publication available! Add pass marks instead!",theme:O.a.info}));case 10:if(window.confirm("Are you sure you wanted to publish marks")){t.next=12;break}return t.abrupt("return");case 12:return console.log("===================================="),console.log({thisPublishedMarks:s.publication_id}),console.log("===================================="),o.setLoadingRequest(!0),t.prev=16,t.next=19,d.a.put("".concat(j.a.CLAIMING,"/publication/publication/").concat(s.publication_id));case 19:(n=t.sent)&&(console.log("===================================="),console.log({res:n}),console.log("===================================="),o.props.getMarksPublication((function(t,e){!t&&e.length>0&&o.props.PushPopupAlert({title:e,theme:O.a.danger})})),o.props.PushPopupAlert({title:"Pass mark published successfully!",theme:O.a.success})),o.cleanBeforeClose(),t.next=28;break;case 24:t.prev=24,t.t0=t.catch(16),console.error(t.t0),o.props.PushPopupAlert({title:Object(v.a)(t.t0),theme:O.a.danger});case 28:o.setLoadingRequest(!1);case 29:case"end":return t.stop()}}),t,null,[[16,24]])}))),o.cleanBeforeClose=function(){"UPDATE"===o.state.modalAction&&(o.setInputMarks(70),o.setInputComment(""),o.setCustomMarks([]),o.setModalAction(!1),o.setState({defaultChanged:!1}))},o.state={loading:!0,loadingRequest:!1,modalAction:!1,searchPosition:"",thisTabs:n.withMarks,positionId:[],thisPosition:null,inputMarks:70,inputComment:"",customMarks:[],defaultChanged:!1},o}return Object(c.a)(s,[{key:"render",value:function(){var t=this;return null===this.props.sessions||null===this.props.systemPositions||null===this.props.marksPublication||this.state.loading?Object(w.jsx)("div",{className:"text-center mt-7 font-bold text-4xl text-gray-400 animate-pulse",children:"Loading..."}):Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"mt-3 rounded flex flex-row justify-between items-center",children:Object(w.jsxs)("div",{className:"flex flex-row items-center gap-3",children:[Object(w.jsx)(m.n,{className:"text-6xl text-blue-600"}),Object(w.jsxs)("div",{className:"flex flex-col",children:[Object(w.jsx)("span",{className:"text-blue-600 text-2xl font-bold",children:"Marks publication"}),Object(w.jsxs)("div",{className:"flex items-center gap-1",children:[Object(w.jsx)("span",{className:"text-gray-600 text-base italic",children:"Session:"}),Object(w.jsx)("span",{className:"text-gray-600 text-base font-bold",children:this.props.sessions&&"none"!==this.props.sessions&&this.props.sessions.session_plan_name})]})]})]})}),Object(w.jsxs)("div",{className:"mt-1 p-1 bg-white",children:[Object(w.jsxs)("div",{className:"flex flex-row items-center bg-gray-100 py-1 ".concat(this.props.sessions&&"none"!==this.props.sessions&&"CREATE"===this.state.modalAction?"justify-between":"justify-end"),children:[this.props.sessions&&"none"!==this.props.sessions&&"CREATE"===this.state.modalAction&&Object(w.jsx)("button",{className:"ml-3 bg-gray-50 hover:bg-blue-100 rounded-full px-1 py-1 focus:outline-none ".concat(this.state.loadingRequest?"cursor-not-allowed":"cursor-pointer"," animate__animated animate__fadeIn"),disabled:this.state.loadingRequest,onClick:function(){return t.setState({modalAction:!1,positionId:[],inputMarks:70,inputComment:""})},children:Object(w.jsx)(b.f,{className:"w-7 h-7"})}),this.props.sessions&&"none"!==this.props.sessions&&!1===this.state.modalAction&&this.props.systemPositions.filter((function(t){return t.isPublished&&!t.isDeleted})).length>0&&!this.isUpdateAllowed(this.props.marksPublication,this.props.sessions)&&Object(w.jsx)("div",{className:"btn bg-blue-600 text-white cursor-pointer hover:bg-blue-800",onClick:function(){t.setModalAction("CREATE")},children:"Add pass marks"}),this.props.sessions&&"none"!==this.props.sessions&&!1===this.state.modalAction&&this.props.systemPositions.filter((function(t){return t.isPublished&&!t.isDeleted})).length>0&&this.isUpdateAllowed(this.props.marksPublication,this.props.sessions)&&!this.isMarkPublished(this.props.marksPublication,this.props.sessions)&&Object(w.jsx)("div",{className:"btn bg-green-600 text-white cursor-pointer hover:bg-green-800",onClick:function(){t.setModalAction("UPDATE"),t.setInputMarks(-1)},children:"Update pass marks"}),this.props.sessions&&"none"!==this.props.sessions&&!1===this.state.modalAction&&this.props.systemPositions.filter((function(t){return t.isPublished&&!t.isDeleted})).length>0&&this.isUpdateAllowed(this.props.marksPublication,this.props.sessions)&&!this.isMarkPublished(this.props.marksPublication,this.props.sessions)&&Object(w.jsx)("div",{className:"btn bg-blue-600 text-white ml-1 hover:bg-blue-800 ".concat(this.state.loadingRequest?"cursor-wait":"cursor-pointer"),onClick:function(){return!t.state.loadingRequest&&t.handlePublishMarks()},children:"Publish pass marks"}),"none"!==this.props.sessions&&this.isMarkPublished(this.props.marksPublication,this.props.sessions)&&Object(w.jsx)("div",{className:"px-3 py-1 text-1xl font-bold text-blue-500 border-4 border-blue-500 border-dotted",children:"Marks published"}),this.props.sessions&&"none"!==this.props.sessions&&"UPDATE"===this.state.modalAction&&this.props.systemPositions.filter((function(t){return t.isPublished&&!t.isDeleted})).length>0&&this.isUpdateAllowed(this.props.marksPublication,this.props.sessions)&&Object(w.jsxs)("div",{className:"flex items-center gap-1 animate__animated animate__fadeInRight animate__faster",children:[Object(w.jsxs)("div",{className:"flex items-center gap-1",children:[Object(w.jsx)("label",{className:"w-full inline-block text-right",children:"Default pass marks"}),Object(w.jsx)("select",{className:"outline-none bg-white text-gray-700 text-base mr-1 py-2 px-2 border-2 border-gray-500 rounded",value:this.state.inputMarks,onChange:function(e){return t.changeDefaultMarks(Number(e.target.value))},children:U(!0).map((function(t,e){return Object(w.jsx)("option",{value:t||"-1",disabled:null===t,children:t||"Select"},e*(t||-1))}))})]}),Object(w.jsx)("button",{className:"btn bg-primary text-white hover:bg-blue-600 focus:outline-none ".concat(this.state.loadingRequest&&"cursor-wait"),type:"button",onClick:function(){return t.handleUpdate()},disabled:this.state.loadingRequest,children:this.state.loadingRequest?"Loading...":"Save"}),Object(w.jsx)("button",{className:"btn bg-red-500 text-white hover:bg-red-600 focus:outline-none ".concat(this.state.loadingRequest&&"cursor-wait"),type:"button",onClick:function(){return t.cleanBeforeClose()},disabled:this.state.loadingRequest,children:"Cancel"})]})]}),Object(w.jsx)("div",{className:"=rounded mx-1 mb-2 mt-3",children:this.state.thisTabs===n.withMarks&&"CREATE"!==this.state.modalAction&&Object(w.jsx)(D,{positionList:this.props.systemPositions.filter((function(t){return t.isPublished&&!t.isDeleted})),marksPublication:this.props.marksPublication,sessions:this.props.sessions,thisPosition:this.state.thisPosition,loadingRequest:this.state.loadingRequest,isUpdateOn:"UPDATE"===this.state.modalAction,setThisPosition:this.setThisPosition,customMarks:this.state.customMarks,setCustomMarks:this.setCustomMarks,defaultChanged:this.state.defaultChanged,defaultMarks:this.state.inputMarks})})]}),this.props.sessions&&"none"!==this.props.sessions&&"CREATE"===this.state.modalAction&&Object(w.jsx)(I,{sessions:this.props.sessions,positionList:this.FC_neededPositions(this.props.systemPositions).withoutMarks,loadingRequest:this.state.loadingRequest,inputMarks:this.state.inputMarks,modalAction:this.state.modalAction,setModalAction:this.setModalAction,setInputMarks:this.setInputMarks,inputComment:this.state.inputComment,setInputComment:this.setInputComment,setLoadingRequest:this.setLoadingRequest,customMarks:this.state.customMarks,setCustomMarks:this.setCustomMarks})]})}}]),s}(h.Component),B=Object(f.b)((function(t){var e=t.auth,s=t.sessionPlan,n=t.marksPublication;return{auth:e,systemPositions:t.system_settings.systemPositions,marksPublication:n,sessions:s.activeSessionPlan}}),{getPositions:y.d,getActiveSessionPlan:P.e,getMarksPublication:function(t){return t(!0,""),function(){var e=Object(r.a)(i.a.mark((function e(s){var n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Object(k.b)(),e.next=4,d.a.get("".concat(j.a.CLAIMING,"/publication"));case 4:n=e.sent,o=[],200===n.status&&null!==n.data&&n.data.length>0&&(o=n.data),console.log("===================================="),console.log({GetMarksPublication:n.data}),console.log("===================================="),s({type:x.a.GET_MARKS_PUBLICATION,payload:o}),t(!1,"",o),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.error({error:Object(v.a)(e.t0)}),t(!1,Object(v.a)(e.t0));case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}()},updateMarksPublication:function(t){return{type:x.a.UPDATE_MARKS_PUBLICATION,payload:t}},PushPopupAlert:g.tb})(G)}}]);
//# sourceMappingURL=54.0f3ce7e0.chunk.js.map