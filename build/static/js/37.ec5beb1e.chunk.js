(this["webpackJsonpreact-redux-typescript-advance"]=this["webpackJsonpreact-redux-typescript-advance"]||[]).push([[37],{1317:function(t,e,s){"use strict";s.r(e),s.d(e,"marksArray",(function(){return Y})),s.d(e,"MarksPublication",(function(){return W}));var n=s(5),o=s.n(n),i=s(7),a=s(26),r=s(25),c=s(28),u=s(27),l=s(4),p=s.n(l),d=s(10),h=s.n(d),m=s(11),b=s(35),f=s(22),x=s(3),g=s(6),j=s(9),k=s(16),v=s(15),P=s(200),O=s(682),y=s(21),_=s(124),C=s.n(_),N=s(40),w=s(12),M=s(47),A=s(1),I=function(t){Object(c.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(a.a)(this,s),(n=e.call(this,t)).setCustomMarks=function(t,e){var s=Object(w.a)(n.props.customMarks),o=s.findIndex((function(e){return e.id===t}));o>=0?s[o].marks=Number(e):s.push({id:t,marks:Number(e)}),n.props.setCustomMarks(s)},n.getMarkByPosition=function(t){return n.props.customMarks.find((function(e){return e.id===t}))},n.setSearchInput=function(t){n.setState({searchInput:t})},n.state={searchInput:""},n}return Object(r.a)(s,[{key:"render",value:function(){var t=this;return Object(A.jsxs)("section",{className:"rounded",children:[Object(A.jsxs)("div",{className:"flex items-center w-full my-1",children:[Object(A.jsx)(m.Mb,{className:"w-6 h-6 absolute ml-2"}),Object(A.jsx)("input",{type:"text",placeholder:"Search",className:"focus:border-2 h-7 ml-1 pl-9 mr-2 bg-gray-100 border-gray-600 focus:border-gray-700 w-full rounded",onChange:function(e){return t.setSearchInput(e.target.value)},value:this.state.searchInput,disabled:!(this.props.positionList.length>0)}),Object(A.jsx)("div",{className:"flex items-center w-auto justify-end gap-1",children:Object(A.jsx)("button",{className:"bg-red-200 text-red-700 py-1 px-2 mr-1 rounded text-sm focus:outline-none",type:"button",onClick:function(){return t.props.setChoosePosition(!1)},children:"Close"})})]}),Object(A.jsx)("div",{className:"w-full h-96 mt-2 divide-y divide-gray-300 overflow-y-auto",children:Object(M.a)(this.props.positionList,this.state.searchInput).length>0?Object(M.a)(this.props.positionList,this.state.searchInput).map((function(e,s){return Object(A.jsx)("section",{children:Object(A.jsxs)("div",{className:"group flex items-center justify-between my-1 hover:bg-gray-100",children:[Object(A.jsx)("div",{className:"p-1 w-full mr-2",children:Object(A.jsx)("p",{className:"text-base font-medium text-black",children:e.position_title})}),Object(A.jsx)("input",{type:"number",min:0,max:100,value:t.getMarkByPosition(e.position_id)?t.getMarkByPosition(e.position_id).marks:t.props.defaultMarks,onChange:function(s){return t.setCustomMarks(e.position_id,s.target.value)},className:"rounded border-2 border-gray-500 focus:border-gray-700 focus:outline-none"})]})},s+e.position_id)})):Object(A.jsx)("div",{className:"text-center p-3",children:Object(A.jsx)("p",{className:"text-base font-medium text-black",children:"No position available"})})})]})}}]),s}(l.Component),S=p.a.memo(I),E=function(t){Object(c.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(a.a)(this,s),(n=e.call(this,t)).setChoosePosition=function(t){n.setState({choosePosition:t})},n.setFormError=function(t){n.setState({formError:t})},n.changeDefaultMarks=function(t){n.props.customMarks.length>0&&window.confirm("Do you want the default pass mark to override the customized pass marks on some position")&&n.props.setCustomMarks([]),n.props.setInputMarks(t)},n.cleanBeforeClose=function(){"CREATE"===n.props.modalAction&&(n.props.setInputMarks(70),n.props.setInputComment(""),n.props.setCustomMarks([]),n.props.setModalAction(!1))},n.handleSubmit=function(){var t=Object(i.a)(o.a.mark((function t(e){var s,i,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),null!==n.props.auth.education_institution_id&&!Object(N.e)(n.props.auth.education_institution_id)){t.next=3;break}return t.abrupt("return",n.props.PushPopupAlert({title:"You don't have access for this action!",theme:y.a.warning}));case 3:if(!(n.props.positionList.length<=0)){t.next=5;break}return t.abrupt("return",n.setFormError({element:"position",msg:"There is no published position available"}));case 5:if(!Object(N.e)(n.props.inputComment)){t.next=7;break}return t.abrupt("return",n.setFormError({element:"comment",msg:"Comment is required"}));case 7:if(window.confirm("Are you sure you wanted to submit")){t.next=9;break}return t.abrupt("return");case 9:return i=[],n.props.positionList.forEach((function(t){if(n.props.customMarks.length>0){var e=n.props.customMarks.find((function(e){return e.id===t.position_id}));e?i.push({position:e.id,marks:e.marks,comment:n.props.inputComment}):i.push({position:t.position_id,marks:n.props.inputMarks,comment:n.props.inputComment})}else i.push({position:t.position_id,marks:n.props.inputMarks,comment:n.props.inputComment})})),s={session:n.props.sessions._id,doneby:n.props.auth.user.user_id,created_date:C()(C()().toDate()).format("YYYY-MM-DD").toString(),publication_position_marks:i,institution:n.props.auth.education_institution_id},console.log("===================================="),console.log({requestData:s}),console.log("===================================="),n.props.setLoadingRequest(!0),t.prev=16,t.next=19,h.a.post("".concat(j.a.PUBLICATION,"/publication"),s);case 19:(a=t.sent)&&(console.log("===================================="),console.log({res:a}),console.log("===================================="),n.props.createMarksPublication(a.data),n.props.PushPopupAlert({title:"Mark published successfully!",theme:y.a.success})),n.cleanBeforeClose(),t.next=28;break;case 24:t.prev=24,t.t0=t.catch(16),console.error(t.t0),n.props.PushPopupAlert({title:Object(v.a)(t.t0),theme:y.a.danger});case 28:n.props.setLoadingRequest(!1);case 29:case"end":return t.stop()}}),t,null,[[16,24]])})));return function(e){return t.apply(this,arguments)}}(),n.state={searchPosition:"",formError:null,choosePosition:!1},n}return Object(r.a)(s,[{key:"render",value:function(){var t=this;return Object(A.jsx)("form",{onSubmit:function(e){return t.handleSubmit(e)},method:"post",children:Object(A.jsxs)("div",{className:"pt-2 pb-4 w-full bg-gray-100 px-5 flex flex-col gap-2",children:[Object(A.jsxs)("div",{className:"flex flex-col",children:[Object(A.jsx)("label",{children:"Session"}),Object(A.jsx)("input",{type:"text",className:"text-left input-white w-full inline-block border-gray-500 border-2",placeholder:"Sub Category Title",value:Object(N.a)(this.props.sessions.session_plan_name),disabled:!0})]}),Object(A.jsxs)("div",{className:"flex flex-col",children:[Object(A.jsx)("label",{children:"Default pass marks"}),Object(A.jsx)("select",{className:"outline-none bg-white text-gray-700 text-base mr-1 py-2 px-2 border-2 border-gray-500 rounded",value:this.props.inputMarks,onChange:function(e){return t.changeDefaultMarks(Number(e.target.value))},children:Y().map((function(t,e){return Object(A.jsx)("option",{value:t||"-1",children:t},e*(t||-1))}))})]}),Object(A.jsxs)("div",{className:"flex flex-col",children:[Object(A.jsx)("label",{children:"Customize pass marks by position"}),Object(A.jsxs)("div",{className:"text-left bg-white border-2 border-gray-500 rounded w-full ".concat(this.state.choosePosition?"h-auto":"h-10"," ").concat(this.state.formError&&"position"===this.state.formError.element?"border-red-500":""," border-2 ").concat(this.props.loadingRequest?"cursor-not-allowed":"cursor-pointer"),title:"Choose position",onClick:function(){!t.state.choosePosition&&t.setChoosePosition(!0),t.state.formError&&"position"===t.state.formError.element&&t.setFormError(null)},children:[this.props.customMarks.length>0&&!this.state.choosePosition?Object(A.jsx)("p",{className:"my-1 mx-2 text-gray-700",children:"Some position has customized pass marks"}):!this.state.choosePosition&&Object(A.jsx)("p",{className:"my-1 mx-2 text-gray-500",children:"Click to view position"}),this.state.choosePosition&&Object(A.jsx)(S,{positionList:this.props.positionList,setChoosePosition:this.setChoosePosition,loadingRequest:this.props.loadingRequest,defaultMarks:this.props.inputMarks,customMarks:this.props.customMarks,setCustomMarks:this.props.setCustomMarks})]}),this.state.formError&&"position"===this.state.formError.element&&Object(A.jsx)("span",{className:"text-red-500",children:this.state.formError.msg})]}),Object(A.jsxs)("div",{className:"flex flex-col",children:[Object(A.jsx)("label",{children:"Comment"}),Object(A.jsx)("textarea",{placeholder:"Comment for pass mark",cols:50,rows:3,className:"border-2 ".concat(this.state.formError&&"comment"===this.state.formError.element?"border-red-400":"border-gray-500"," rounded px-3 py-1 w-full focus:outline-none"),style:{resize:"none"},value:this.props.inputComment,onChange:function(e){t.props.setInputComment(e.target.value),t.setFormError(null)},disabled:this.props.loadingRequest}),this.state.formError&&"comment"===this.state.formError.element&&Object(A.jsx)("p",{className:"text-red-800",children:this.state.formError.msg})]}),Object(A.jsxs)("div",{className:"pt-4 flex justify-between",children:[Object(A.jsx)("button",{onClick:function(){t.cleanBeforeClose()},className:"btn bg-gray-400 text-white hover:bg-gray-600 focus:outline-none ".concat(this.props.loadingRequest&&"cursor-not-allowed"),type:"button",disabled:this.props.loadingRequest,children:"Exit"}),Object(A.jsx)("div",{className:"flex items-center gap-1",children:Object(A.jsx)("button",{className:"btn bg-primary text-white hover:bg-blue-600 focus:outline-none ".concat(this.props.loadingRequest&&"cursor-wait"),type:"submit",disabled:this.props.loadingRequest,children:this.props.loadingRequest?"Loading...":"Save"})})]})]})})}}]),s}(l.Component),L=p.a.memo(Object(f.b)((function(t){return{auth:t.auth}}),{createMarksPublication:function(t){return{type:g.a.CREATE_MARKS_PUBLICATION,payload:t}},PushPopupAlert:x.Pb})(E)),T=s(202),R=s(54),q=s(685),D=s(160),B=function(t){Object(c.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(a.a)(this,s),(n=e.call(this,t)).setSearchInput=function(t){n.setState({searchInput:t})},n.searchPublishedMarks=function(t,e){return void 0===e||""===e?t:t.filter((function(t){var s;for(var n in t)if(s=!1,"province_name"!==n&&"courses"!==n&&"position_title"!==n&&"description"!==n&&"marks"!==n&&"candidate_applied"!==n&&"candidate_passed"!==n||t[n]&&(s=t[n].toString().toLowerCase().indexOf(e.toLowerCase())>-1),s)break;return s}))},n.setCustomMarks=function(t,e){if(Number(e)<0||Number(e)>100)return n.props.PushPopupAlert({title:"Pass marks must be less or equal to 100 and greater or equal to 0",theme:y.a.danger});var s=Object(w.a)(n.props.customMarks),o=s.findIndex((function(e){return e.id===t}));o>=0?s[o].marks=Number(e):s.push({id:t,marks:Number(e)}),n.props.setCustomMarks(s)},n.getMarkByPosition=function(t){return n.props.customMarks.find((function(e){return e.id===t}))},n.loadPublicationCounts=function(){var t=Object(i.a)(o.a.mark((function t(e,s,i){var a,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a="none"!==s?e.find((function(t){return t.session===s._id})):void 0,console.log("===================================="),console.log({allMarks:e,marksBySession:a}),console.log("===================================="),!a){t.next=23;break}return console.log("===================================="),console.log({marksBySession:a}),console.log("===================================="),i(!0),t.prev=9,t.next=12,h.a.get("".concat(j.a.PUBLICATION,"/publication/count/").concat(a.publication_id));case 12:(r=t.sent)&&(console.log("===================================="),console.log({loadPublicationCounts:r}),console.log("===================================="),n.setPublicationCount(r.data)),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(9),console.error({loadPublicationCounts_reply:t.t0}),n.props.PushPopupAlert({title:Object(v.a)(t.t0),theme:y.a.danger});case 20:i(!1),t.next=24;break;case 23:i(!1);case 24:case"end":return t.stop()}}),t,null,[[9,16]])})));return function(e,s,n){return t.apply(this,arguments)}}(),n.setPublicationCount=function(t){n.setState({publicationCount:t})},n.setLoading=function(t){n.setState({loading:t})},n.componentDidMount=function(){null===n.state.publicationCount&&n.loadPublicationCounts(n.props.marksPublication,n.props.sessions,n.setLoading)},n.getNeededData=function(t,e,s,n){var o=[];return t.forEach((function(t){var i="none"!==s?e.find((function(t){return t.session===s._id})):void 0;if(i){var a=i.publication_position_marks.find((function(e){return e.position===t.position_id})),r=n&&n.find((function(e){return e.position===t.position_id}));a&&o.push({province_id:t.province_id,province_name:t.province_name,courses:t.courses,position_title:t.position_title,description:t.description,school_level_id:t.school_level_id,education_institute_id:t.education_institute_id,requirements:t.requirements,isDeleted:t.isDeleted,isPublished:t.isPublished,position_id:t.position_id,marks:a.marks,candidate_applied:r?r.candidate_applied:0,candidate_passed:r?r.candidate_passed:0})}})),o},n.state={searchInput:"",publicationCount:null,loading:!1},n}return Object(r.a)(s,[{key:"render",value:function(){var t=this;return"none"===this.props.sessions?Object(A.jsxs)("div",{className:"py-10 flex flex-col items-center rounded border border-gray-300 bg-white text-2xl font-medium text-yellow-800 animate__animated animate__pulse",children:[Object(A.jsx)(R.q,{className:"w-32 h-32"}),"No Active session available!"]}):Object(A.jsxs)("div",{children:[this.props.positionList.length<=0&&Object(A.jsxs)("div",{className:"text-gray-400 px-6 py-4 rounded border mt-4 text-xl font-extrabold flex flex-col items-center justify-center bg-gray-100",children:[Object(A.jsx)(T.k,{className:"text-7xl text-gray-400 animate__animated animate__shakeX"}),Object(A.jsx)("span",{children:"No position available"})]}),this.props.positionList.length>0&&Object(A.jsx)("section",{className:"flex flex-col-reverse sm:flex-row items-center gap-2 w-full mb-2",children:Object(A.jsx)("div",{className:"w-full",children:Object(A.jsx)("input",{onChange:function(e){return t.setSearchInput(e.target.value)},type:"text",className:"input-white h-10 text-sm border-2 border-gray-400 focus:border-gray-500 w-full",placeholder:"Search position by title or description",value:this.state.searchInput,disabled:!(this.state.publicationCount&&this.getNeededData(this.props.positionList,this.props.marksPublication,this.props.sessions,this.state.publicationCount).length>0)})})}),Object(A.jsxs)("table",{className:"w-full",children:[Object(A.jsx)("thead",{className:"bg-white border-b-2 border-gray-300 text-gray-600 font-bold text-sm",children:Object(A.jsxs)("tr",{children:[Object(A.jsx)("td",{className:"px-2 py-2",children:"Positions"}),Object(A.jsx)("td",{className:"px-2 py-2",children:"All candidates"}),Object(A.jsx)("td",{className:"px-2 py-2",children:"Passed candidates"}),Object(A.jsx)("td",{className:"px-2 py-2",children:"Pass marks"})]})}),Object(A.jsx)("tbody",{children:this.state.loading?Object(A.jsx)(q.a,{cols:4}):this.searchPublishedMarks(this.getNeededData(this.props.positionList,this.props.marksPublication,this.props.sessions,this.state.publicationCount),this.state.searchInput).length>0?this.searchPublishedMarks(this.getNeededData(this.props.positionList,this.props.marksPublication,this.props.sessions,this.state.publicationCount),this.state.searchInput).map((function(e,s){return Object(A.jsxs)("tr",{className:"".concat(s%2!==0?"bg-gray-100":"bg-white"," hover:bg-blue-100 hover:text-blue-700 border-b hover:border-blue-500 text-base text-gray-600 border-gray-300"),children:[Object(A.jsx)("td",{className:"px-2 py-2",children:e.position_title}),Object(A.jsx)("td",{className:"px-2 py-2",children:e.candidate_applied}),Object(A.jsx)("td",{className:"px-2 py-2",children:e.candidate_passed}),Object(A.jsx)("td",{className:"px-2 py-2",children:t.props.isUpdateOn?Object(A.jsx)("input",{type:"number",min:0,max:100,value:t.getMarkByPosition(e.position_id)?t.getMarkByPosition(e.position_id).marks:t.props.defaultChanged?t.props.defaultMarks:e.marks,onChange:function(s){return t.setCustomMarks(e.position_id,s.target.value)},className:"rounded border-2 border-gray-500 w-full focus:border-gray-700 focus:outline-none"}):Object(A.jsxs)("span",{className:"text-gray-600 italic font-semibold",children:[e.marks,"%"]})})]},s+e.position_id)})):Object(A.jsx)("tr",{children:Object(A.jsx)("td",{colSpan:8,className:"px-2 py-2",children:Object(A.jsx)(D.b,{theme:D.a.Dark,value:"No pass marks has been set"})})})})]})]})}}]),s}(l.Component),U=p.a.memo(Object(f.b)(null,{PushPopupAlert:x.Pb})(B)),F=s(23),G=s(680),Y=function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=t?[null]:[0],s=0;s<=100;)e.push(s),s++;return e},z=function(t){Object(c.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(a.a)(this,s),(n=e.call(this,t)).setLoading=function(t){n.setState({loading:t})},n.setLoadingRequest=function(t){n.setState({loadingRequest:t})},n.setModalAction=function(t){n.setState({modalAction:t})},n.setThisPosition=function(t){n.setState({thisPosition:t})},n.setPositionId=function(t){n.setState({positionId:t})},n.setCustomMarks=function(t){n.setState({customMarks:t})},n.setInputMarks=function(t){n.setState({inputMarks:t})},n.setInputComment=function(t){n.setState({inputComment:t})},n.loadPositions=function(){null===n.props.systemPositions&&n.props.auth.education_institution_id?n.props.FC_GetPositionsByInstitution(n.props.auth.education_institution_id,(function(t,e){n.setLoading(t),console.log({status:t,msg:e}),!t&&e.length&&n.props.PushPopupAlert({title:e,theme:y.a.danger})})):n.state.loading&&n.setLoading(!1)},n.componentDidMount=function(){Object(F.c)(n.props.auth.education_institution_id)&&(null===n.props.sessions||"none"===n.props.sessions?n.props.FC_GetActiveSessionPlan(n.props.auth.education_institution_id,(function(t,e,s){n.setLoading(t),t||(e.length&&n.props.PushPopupAlert({title:e,theme:y.a.danger}),s&&"none"!==s&&n.loadPositions())})):n.loadPositions(),null===n.props.marksPublication&&n.props.FC_GetMarksPublicationByInstitution(n.props.auth.education_institution_id,(function(t,e,s){n.setLoading(t),!t&&e.length>0&&n.props.PushPopupAlert({title:e,theme:y.a.danger}),!t&&s&&(console.log("===================================="),console.log({data:s}),console.log("===================================="))})))},n.FC_neededPositions=function(t){var e={withMarks:[],withoutMarks:[]},s=t.filter((function(t){return t.isPublished&&!t.isDeleted}));return e.withoutMarks=s,e},n.isMarkPublished=function(t,e){if(t.length>0){var s=t.find((function(t){return t.session===e._id}));if(s&&"PUBLISHED"===s.publication_status)return!0}return!1},n.isUpdateAllowed=function(t,e){if(t.length>0&&t.find((function(t){return t.session===e._id})))return!0;return!1},n.changeDefaultMarks=function(t){n.state.customMarks.length>0&&window.confirm("Do you want the default pass mark to override the customized pass marks on some position")&&n.setCustomMarks([]),n.setState({defaultChanged:!0}),n.setInputMarks(t)},n.handleUpdate=Object(i.a)(o.a.mark((function t(){var e,s,i,a,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==n.props.sessions){t.next=2;break}return t.abrupt("return",n.props.PushPopupAlert({title:"Load session first!",theme:y.a.info}));case 2:if("none"!==n.props.sessions){t.next=4;break}return t.abrupt("return",n.props.PushPopupAlert({title:"No active session available!",theme:y.a.info}));case 4:if(null!==n.props.marksPublication){t.next=6;break}return t.abrupt("return",n.props.PushPopupAlert({title:"Load published pass marks first!",theme:y.a.info}));case 6:if(e=n.props.sessions,s=n.props.marksPublication.find((function(t){return t.session===e._id}))){t.next=10;break}return t.abrupt("return",n.props.PushPopupAlert({title:"No pass marks publication available! Add pass marks instead!",theme:y.a.info}));case 10:if(!(n.state.customMarks.length<=0)||n.state.defaultChanged){t.next=12;break}return t.abrupt("return",n.props.PushPopupAlert({title:"No change have been done!",theme:y.a.info}));case 12:if(window.confirm("Are you sure you wanted to update")){t.next=14;break}return t.abrupt("return");case 14:return a=[],s.publication_position_marks.forEach((function(t){if(n.state.customMarks.length>0){var e=n.state.customMarks.find((function(e){return e.id===t.position}));e?a.push({_id:t._id,position:e.id,marks:e.marks,comment:t.comment}):n.state.defaultChanged?a.push({_id:t._id,position:t.position,marks:n.state.inputMarks,comment:t.comment}):a.push({_id:t._id,position:t.position,marks:t.marks,comment:t.comment})}else n.state.defaultChanged?a.push({_id:t._id,position:t.position,marks:n.state.inputMarks,comment:t.comment}):a.push({_id:t._id,position:t.position,marks:t.marks,comment:t.comment})})),i={session:s.session,doneby:n.props.auth.user.user_id,created_date:s.created_date,publication_position_marks:a,publication_id:s.publication_id,publication_status:s.publication_status,status:s.status,createdAt:s.createdAt,updatedAt:s.updatedAt,institution:s.institution},console.log("===================================="),console.log({requestData:i}),console.log("===================================="),n.setLoadingRequest(!0),t.prev=21,t.next=24,h.a.put("".concat(j.a.PUBLICATION,"/publication/").concat(s.publication_id),i);case 24:(r=t.sent)&&(console.log("===================================="),console.log({res:r}),console.log("===================================="),n.props.updateMarksPublication(r.data),n.props.PushPopupAlert({title:"Pass mark updated successfully!",theme:y.a.success})),n.cleanBeforeClose(),t.next=33;break;case 29:t.prev=29,t.t0=t.catch(21),console.error(t.t0),n.props.PushPopupAlert({title:Object(v.a)(t.t0),theme:y.a.danger});case 33:n.setLoadingRequest(!1);case 34:case"end":return t.stop()}}),t,null,[[21,29]])}))),n.getWaitingList=function(){var t=Object(i.a)(o.a.mark((function t(e,s){var i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s(!0,""),t.prev=1,t.next=4,h.a.get("".concat(j.a.DO_EXAM,"/waiting/publication/").concat(e));case 4:(i=t.sent)&&(console.log("===================================="),console.log({getWaitingList:i}),console.log("===================================="),s(!1,"")),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(1),console.error({getWaitingListError:t.t0}),s(!1,Object(v.a)(t.t0)),n.props.PushPopupAlert({title:Object(v.a)(t.t0),theme:y.a.danger});case 13:n.setLoadingRequest(!1);case 14:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,s){return t.apply(this,arguments)}}(),n.handlePublishMarks=Object(i.a)(o.a.mark((function t(){var e,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==n.props.sessions){t.next=2;break}return t.abrupt("return",n.props.PushPopupAlert({title:"Load session first!",theme:y.a.info}));case 2:if("none"!==n.props.sessions){t.next=4;break}return t.abrupt("return",n.props.PushPopupAlert({title:"No active session available!",theme:y.a.info}));case 4:if(null!==n.props.marksPublication){t.next=6;break}return t.abrupt("return",n.props.PushPopupAlert({title:"Load published pass marks first!",theme:y.a.info}));case 6:if(e=n.props.sessions,s=n.props.marksPublication.find((function(t){return t.session===e._id}))){t.next=10;break}return t.abrupt("return",n.props.PushPopupAlert({title:"No pass marks publication available! Add pass marks instead!",theme:y.a.info}));case 10:if(window.confirm("Are you sure you wanted to publish marks")){t.next=12;break}return t.abrupt("return");case 12:return console.log("===================================="),console.log({thisPublishedMarks:s.publication_id}),console.log("===================================="),n.setLoadingRequest(!0),t.next=18,n.getWaitingList(e._id,function(){var t=Object(i.a)(o.a.mark((function t(e,i){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e||0!==i.length){t.next=13;break}return t.prev=1,t.next=4,h.a.put("".concat(j.a.PUBLICATION,"/publication/publication/").concat(s.publication_id));case 4:(a=t.sent)&&n.props.auth.education_institution_id&&(console.log("===================================="),console.log({res:a}),console.log("===================================="),n.props.FC_GetMarksPublicationByInstitution(n.props.auth.education_institution_id,(function(t,e){!t&&e.length>0&&n.props.PushPopupAlert({title:e,theme:y.a.danger})})),n.props.PushPopupAlert({title:"Pass mark published successfully!",theme:y.a.success})),n.cleanBeforeClose(),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.error(t.t0),n.props.PushPopupAlert({title:Object(v.a)(t.t0),theme:y.a.danger});case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,s){return t.apply(this,arguments)}}());case 18:n.setLoadingRequest(!1);case 19:case"end":return t.stop()}}),t)}))),n.cleanBeforeClose=function(){"UPDATE"===n.state.modalAction&&(n.setInputMarks(70),n.setInputComment(""),n.setCustomMarks([]),n.setModalAction(!1),n.setState({defaultChanged:!1}))},n.state={loading:!0,loadingRequest:!1,modalAction:!1,searchPosition:"",positionId:[],thisPosition:null,inputMarks:70,inputComment:"",customMarks:[],defaultChanged:!1},n}return Object(r.a)(s,[{key:"render",value:function(){var t=this;return!1===Object(F.c)(this.props.auth.education_institution_id)?Object(A.jsx)(G.a,{title:"Authorization Error",description:"Please contact the administration to get the access."}):null===this.props.sessions||this.state.loading?Object(A.jsx)("div",{className:"text-center mt-7 font-bold text-4xl text-gray-400 animate-pulse",children:"Loading..."}):Object(A.jsxs)("div",{children:[Object(A.jsx)("div",{className:"mt-3 rounded flex flex-row justify-between items-center",children:Object(A.jsxs)("div",{className:"flex flex-row items-center gap-3",children:[Object(A.jsx)(b.n,{className:"text-6xl text-blue-600"}),Object(A.jsxs)("div",{className:"flex flex-col",children:[Object(A.jsx)("span",{className:"text-blue-600 text-2xl font-bold",children:"Marks publication"}),Object(A.jsxs)("div",{className:"flex items-center gap-1",children:[Object(A.jsx)("span",{className:"text-gray-600 text-base italic",children:"Session:"}),Object(A.jsx)("span",{className:"text-gray-600 text-base font-bold",children:this.props.sessions&&"none"!==this.props.sessions&&this.props.sessions.session_plan_name})]})]})]})}),Object(A.jsxs)("div",{className:"mt-1 p-1 bg-white",children:["none"!==this.props.sessions&&Object(A.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-1 bg-gray-100 py-1 mb-2 ".concat(this.props.sessions&&"justify-between"),children:[Object(A.jsx)("div",{className:"flex items-center gap-x-2",children:this.props.sessions&&"CREATE"===this.state.modalAction&&Object(A.jsx)("button",{className:"ml-3 bg-gray-50 hover:bg-blue-100 rounded-full px-1 py-1 focus:outline-none ".concat(this.state.loadingRequest?"cursor-not-allowed":"cursor-pointer"," animate__animated animate__fadeIn"),disabled:this.state.loadingRequest,onClick:function(){return t.setState({modalAction:!1,positionId:[],inputMarks:70,inputComment:""})},children:Object(A.jsx)(m.f,{className:"w-7 h-7"})})}),Object(A.jsxs)("div",{className:"flex items-center",children:[this.props.sessions&&!1===this.state.modalAction&&this.props.systemPositions&&this.props.systemPositions.filter((function(t){return t.isPublished&&!t.isDeleted})).length>0&&this.props.marksPublication&&!this.isUpdateAllowed(this.props.marksPublication,this.props.sessions)&&Object(A.jsx)("div",{className:"btn bg-blue-600 text-white cursor-pointer hover:bg-blue-800",onClick:function(){t.setModalAction("CREATE")},children:"Add pass marks"}),this.props.sessions&&!1===this.state.modalAction&&this.props.systemPositions&&this.props.systemPositions.filter((function(t){return t.isPublished&&!t.isDeleted})).length>0&&this.props.marksPublication&&this.isUpdateAllowed(this.props.marksPublication,this.props.sessions)&&!this.isMarkPublished(this.props.marksPublication,this.props.sessions)&&Object(A.jsx)("div",{className:"btn bg-gray-300 text-blue-600 hover:text-white cursor-pointer hover:bg-blue-800",onClick:function(){t.setModalAction("UPDATE"),t.setInputMarks(-1)},children:"Update pass marks"}),this.props.sessions&&!1===this.state.modalAction&&this.props.systemPositions&&this.props.systemPositions.filter((function(t){return t.isPublished&&!t.isDeleted})).length>0&&this.props.marksPublication&&this.isUpdateAllowed(this.props.marksPublication,this.props.sessions)&&!this.isMarkPublished(this.props.marksPublication,this.props.sessions)&&Object(A.jsx)("div",{className:"btn bg-green-600 text-white ml-1 hover:bg-green-800 ".concat(this.state.loadingRequest?"cursor-wait":"cursor-pointer"),onClick:function(){return!t.state.loadingRequest&&t.handlePublishMarks()},children:"Publish pass marks"}),this.props.marksPublication&&this.isMarkPublished(this.props.marksPublication,this.props.sessions)&&Object(A.jsx)("div",{className:"px-3 py-1 text-1xl font-bold text-blue-500 border-4 border-blue-500 border-dotted",children:"Marks published"}),this.props.sessions&&"UPDATE"===this.state.modalAction&&this.props.systemPositions&&this.props.systemPositions.filter((function(t){return t.isPublished&&!t.isDeleted})).length>0&&this.props.marksPublication&&this.isUpdateAllowed(this.props.marksPublication,this.props.sessions)&&Object(A.jsxs)("div",{className:"flex items-center gap-1 animate__animated animate__fadeInRight animate__faster",children:[Object(A.jsxs)("div",{className:"flex items-center gap-1",children:[Object(A.jsx)("label",{className:"w-full inline-block text-right",children:"Default pass marks"}),Object(A.jsx)("select",{className:"outline-none bg-white text-gray-700 text-base mr-1 py-2 px-2 border-2 border-gray-500 rounded",value:this.state.inputMarks,onChange:function(e){return t.changeDefaultMarks(Number(e.target.value))},children:Y(!0).map((function(t,e){return Object(A.jsx)("option",{value:t||"-1",disabled:null===t,children:t||"Select"},e*(t||-1))}))})]}),Object(A.jsx)("button",{className:"btn bg-primary text-white hover:bg-blue-600 focus:outline-none ".concat(this.state.loadingRequest&&"cursor-wait"),type:"button",onClick:function(){return t.handleUpdate()},disabled:this.state.loadingRequest,children:this.state.loadingRequest?"Loading...":"Save"}),Object(A.jsx)("button",{className:"btn bg-red-500 text-white hover:bg-red-600 focus:outline-none ".concat(this.state.loadingRequest&&"cursor-wait"),type:"button",onClick:function(){return t.cleanBeforeClose()},disabled:this.state.loadingRequest,children:"Cancel"})]})]})]}),Object(A.jsxs)("div",{className:"=rounded mx-1 mb-2 overflow-x-auto",children:["none"===this.props.sessions&&Object(A.jsx)(G.a,{description:"No active session availabl!e"}),"CREATE"!==this.state.modalAction&&this.props.systemPositions&&this.props.marksPublication&&Object(A.jsx)(U,{positionList:this.props.systemPositions.filter((function(t){return t.isPublished&&!t.isDeleted})),marksPublication:this.props.marksPublication,sessions:this.props.sessions,thisPosition:this.state.thisPosition,loadingRequest:this.state.loadingRequest,isUpdateOn:"UPDATE"===this.state.modalAction,setThisPosition:this.setThisPosition,customMarks:this.state.customMarks,setCustomMarks:this.setCustomMarks,defaultChanged:this.state.defaultChanged,defaultMarks:this.state.inputMarks})]})]}),this.props.sessions&&"none"!==this.props.sessions&&"CREATE"===this.state.modalAction&&this.props.systemPositions&&Object(A.jsx)(L,{sessions:this.props.sessions,positionList:this.FC_neededPositions(this.props.systemPositions).withoutMarks,loadingRequest:this.state.loadingRequest,inputMarks:this.state.inputMarks,modalAction:this.state.modalAction,setModalAction:this.setModalAction,setInputMarks:this.setInputMarks,inputComment:this.state.inputComment,setInputComment:this.setInputComment,setLoadingRequest:this.setLoadingRequest,customMarks:this.state.customMarks,setCustomMarks:this.setCustomMarks})]})}}]),s}(l.Component),W=Object(f.b)((function(t){var e=t.auth,s=t.sessionPlan,n=t.marksPublication;return{auth:e,systemPositions:t.system_settings.systemPositions,marksPublication:n,sessions:s.activeSessionPlan}}),{FC_GetPositionsByInstitution:O.a,FC_GetActiveSessionPlan:P.a,FC_GetMarksPublicationByInstitution:function(t,e){return e(!0,""),function(){var s=Object(i.a)(o.a.mark((function s(n){var i,a;return o.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,Object(k.b)(),s.next=4,h.a.get("".concat(j.a.PUBLICATION,"/publication/institution/").concat(t));case 4:i=s.sent,a=[],200===i.status&&null!==i.data&&i.data.length>0&&(a=i.data),console.log("===================================="),console.log({GetMarksPublication:i.data}),console.log("===================================="),n({type:g.a.GET_MARKS_PUBLICATION,payload:a}),e(!1,"",a),s.next=18;break;case 14:s.prev=14,s.t0=s.catch(0),console.error({error:Object(v.a)(s.t0)}),e(!1,Object(v.a)(s.t0));case 18:case"end":return s.stop()}}),s,null,[[0,14]])})));return function(t){return s.apply(this,arguments)}}()},updateMarksPublication:function(t){return{type:g.a.UPDATE_MARKS_PUBLICATION,payload:t}},PushPopupAlert:x.Pb})(z)},680:function(t,e,s){"use strict";var n=s(4),o=s.n(n),i=s(54),a=s(1),r=function(t){t.title;var e=t.description,s=void 0===e?"Please Wait for the system to publish the sessions or contact the administrator":e;return Object(a.jsx)("div",{className:"w-full my-5",children:Object(a.jsxs)("section",{className:"py-10 flex flex-col items-center rounded border border-gray-300 bg-white text-2xl font-medium text-yellow-800 animate__animated animate__pulse",children:[Object(a.jsxs)("div",{className:"flex flex-col items-center",children:[Object(a.jsx)(i.q,{className:"w-32 h-32"}),s]}),!1]})})};e.a=o.a.memo(r)},682:function(t,e,s){"use strict";s.d(e,"f",(function(){return h})),s.d(e,"d",(function(){return m})),s.d(e,"b",(function(){return b})),s.d(e,"e",(function(){return f})),s.d(e,"c",(function(){return x})),s.d(e,"g",(function(){return g})),s.d(e,"a",(function(){return j}));var n=s(5),o=s.n(n),i=s(7),a=s(10),r=s.n(a),c=s(6),u=s(9),l=s(16),p=s(15),d="".concat(u.a.AUTH,"/auth/user/access"),h=function(t){return function(){var e=Object(i.a)(o.a.mark((function e(s){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(!0,""),e.prev=1,Object(l.b)(),e.next=5,r.a.get("".concat(u.a.AUTH,"/system/setting"));case 5:n=e.sent,console.log("=================getSystemSettings==================="),console.log(n),console.log("=================getSystemSettings==================="),s({type:c.a.GET_SYSTEM_SETTINGS,payload:n.data}),t(!1,""),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.log({code_error:e.t0}),t(!1,Object(p.a)(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}()},m=function(t){return function(){var e=Object(i.a)(o.a.mark((function e(s){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s({type:c.a.DISABLE_SYSTEM_SETTINGS,payload:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},b=function(t){return function(){var e=Object(i.a)(o.a.mark((function e(s){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(!0,""),e.prev=1,Object(l.b)(),e.next=5,r.a.get("".concat(d,"/roleaccess"));case 5:n=e.sent,i=n.data.map((function(t){return{id:t.id,task:t.title,key:t.key,permitted:t.permitted}})),s({type:c.a.GET_TASK_ACCESS,payload:i}),t(!1,"",i),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),console.log({code_error:e.t0}),t(!1,Object(p.a)(e.t0));case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()},f=function(t){return function(){var e=Object(i.a)(o.a.mark((function e(s){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(!0,""),e.prev=1,Object(l.b)(),e.next=5,r.a.get("".concat(u.a.APPLICATION,"/position"));case 5:n=e.sent,s({type:c.a.GET_POSTIONS,payload:n.data}),t(!1,""),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log({code_error:e.t0}),t(!1,Object(p.a)(e.t0));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()},x=function(t){return console.log({deletePosition:t}),function(){var e=Object(i.a)(o.a.mark((function e(s){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s({type:c.a.DELETE_POSITION,payload:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=function(t){return function(){var e=Object(i.a)(o.a.mark((function e(s){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s({type:c.a.PUBLISH_POSITION,payload:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},j=function(t,e){return function(){var s=Object(i.a)(o.a.mark((function s(n){var i;return o.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return e(!0,""),s.prev=1,Object(l.b)(),s.next=5,r.a.get("".concat(u.a.APPLICATION,"/position/instituteposition/").concat(t));case 5:i=s.sent,n({type:c.a.GET_POSTIONS,payload:i.data}),e(!1,"",i.data),s.next=14;break;case 10:s.prev=10,s.t0=s.catch(1),console.log({code_error:s.t0}),e(!1,Object(p.a)(s.t0));case 14:case"end":return s.stop()}}),s,null,[[1,10]])})));return function(t){return s.apply(this,arguments)}}()}},685:function(t,e,s){"use strict";s(4);var n=s(1);e.a=function(t){var e=function(){for(var e=[],s=0;s<t.cols;s++)e.push(s);return e.map((function(t){return Object(n.jsx)("td",{className:"p-3 text-center whitespace-nowrap",children:Object(n.jsx)("div",{className:"w-full h-4 rounded bg-gray-200 animate__animated animate__pulse animate__delay-5s animate__infinite"})},t)}))};return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("tr",{className:"border-b border-gray-200",children:e()},228),Object(n.jsx)("tr",{className:"border-b border-gray-200",children:e()},22648),Object(n.jsx)("tr",{className:"border-b border-gray-200",children:e()},229768)]})}}}]);
//# sourceMappingURL=37.ec5beb1e.chunk.js.map