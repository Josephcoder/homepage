(this["webpackJsonpreact-redux-typescript-advance"]=this["webpackJsonpreact-redux-typescript-advance"]||[]).push([[65],{1302:function(e,t,s){"use strict";s.r(t),s.d(t,"UserManagement",(function(){return y}));var a,r=s(11),n=s(26),c=s(25),l=s(28),i=s(27),o=s(4),u=s(53),d=s(202),g=s(77),f=s(12),h=s(22),b=s(3),m=s(686),j=s(21),x=s(40),p=s(705),v=s(1);!function(e){e.All_Users="All Users",e.Active_Users="Active Users",e.Blocked_Users="Blocked Users"}(a||(a={}));var U=function(e){Object(l.a)(s,e);var t=Object(i.a)(s);function s(e){var c;return Object(n.a)(this,s),(c=t.call(this,e)).setUserData=function(e){c.setState({userData:e})},c.setLoadingUsers=function(e){c.setState({loadingUsers:e})},c.setUserTabs=function(e){c.setState({userTabs:e})},c.setFilerByRoleLevel=function(e){c.setState({filterByRoleLevel:e})},c.setOpenFilterByRole=function(e){c.setState({openFilterByRole:e})},c.setLoading=function(e){c.setState({loading:e})},c.setCurrentPage=function(e){c.setState({currentPage:e})},c.setLastLoadedPage=function(e){c.setState({lastLoadedPage:e})},c.setManageUser=function(e){c.setState({manageUser:e})},c.setChangeRole=function(e){c.setState({changeRole:e})},c.componentDidMount=function(){c.props.accessRoles.length||c.props.FC_GetAccessRoles((function(e,t,s){c.setState({loading:e})})),null===c.props.schoolLevels.education_categories||0===c.props.schoolLevels.education_categories.length?c.props.loadEducationCategories((function(e){c.setLoading(e)})):c.setLoading(!1),c.props.userList.users?(c.setUserData(c.props.userList.users[0].data),c.setLoadingUsers(!1)):c.props.fetchUserAccess(1,(function(e,t,s){c.setLoadingUsers(e),e||(Object(x.e)(t)||c.props.PushPopupAlert({title:t,theme:j.a.danger}),s&&(c.setUserData(s),c.setLoadingUsers(!1),console.log("===================================="),console.log({setLoadingUsers:e}),console.log("====================================")))}))},c.reloadUsers=function(e){c.state.lastLoadedPage.includes(e)||c.props.fetchUserAccess(e,(function(t,s,a){if(c.setLoadingUsers(t),!t&&(Object(x.e)(s)||c.props.PushPopupAlert({title:s,theme:j.a.danger}),a)){var n=Object(r.a)(c.state.userData);n=n.concat(a),c.setUserData(n),c.setLastLoadedPage([].concat(Object(r.a)(c.state.lastLoadedPage),[e])),c.setLoadingUsers(!1),console.log("===================================="),console.log({setLoadingUsers:t}),console.log("====================================")}}))},c.labelCounts=function(e){return{allUser:e.length,activeUser:e.filter((function(e){return!e.is_active})).length,blockedUser:e.filter((function(e){return e.is_active})).length}},c.filterByRole=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";return"all"!==t?e.filter((function(e){return e.default_access&&e.default_access.system_user_role_id===t})):e},c.getRoleById=function(e,t){return e.find((function(e){return e.system_user_role_id===t}))},c.generatePages=function(e){var t=Math.ceil(e/m.g),s=Array.from(Array(t+1-1).keys()).map((function(e){return 1+e})).slice(0,5);t>4&&c.state.currentPage>2&&(s=t-c.state.currentPage>1?[c.state.currentPage-2,c.state.currentPage-1,c.state.currentPage,c.state.currentPage+1,c.state.currentPage+2]:t-c.state.currentPage===1?[c.state.currentPage-3,c.state.currentPage-2,c.state.currentPage-1,c.state.currentPage,c.state.currentPage+1]:[c.state.currentPage-4,c.state.currentPage-3,c.state.currentPage-2,c.state.currentPage-1,c.state.currentPage]);var a=!1,r=!1,n=!1,l=!1;return t>1&&1!==c.state.currentPage&&(n=!0),t>1&&c.state.currentPage!==t&&(l=!0),t>3&&c.state.currentPage>3&&(a=!0),t>3&&c.state.currentPage!==t&&t-c.state.currentPage>2&&(r=!0),Object(v.jsxs)("div",{className:"flex text-gray-700",children:[a&&Object(v.jsx)("button",{className:"h-12 w-12 ml-1 flex justify-center items-center rounded-full bg-gray-100 hover:bg-gray-200 cursor-pointer",onClick:function(){return c.setCurrentPage(1)},children:Object(v.jsx)(d.e,{className:"w-6 h-6"})}),n&&Object(v.jsx)("button",{className:"h-12 w-12 ml-1 flex justify-center items-center rounded-full bg-gray-100 hover:bg-gray-200",onClick:function(){return c.setCurrentPage(c.state.currentPage-1)},children:Object(v.jsx)(d.g,{className:"w-6 h-6"})}),Object(v.jsx)("div",{className:"flex h-12 font-medium rounded-full mx-1 bg-gray-100",children:s.map((function(e,t){return Object(v.jsx)("button",{className:"w-12 md:flex justify-center items-center gap-2 rounded-full ".concat(c.state.currentPage===e?"bg-gray-600 hover:bg-gray-500 text-white cursor-auto":"hover:bg-gray-200"),disabled:c.state.currentPage===e,onClick:function(){c.setCurrentPage(e),c.reloadUsers(e)},children:e},Math.random())}))}),l&&Object(v.jsx)("button",{className:"h-12 w-12 mr-1 flex justify-center items-center rounded-full bg-gray-100 hover:bg-gray-200 cursor-pointer",onClick:function(){c.setCurrentPage(c.state.currentPage+1),c.reloadUsers(c.state.currentPage+1)},children:Object(v.jsx)(d.h,{className:"w-6 h-6"})}),r&&Object(v.jsx)("button",{className:"h-12 w-12 mr-1 flex justify-center items-center rounded-full bg-gray-100 hover:bg-gray-200 cursor-pointer",onClick:function(){c.setCurrentPage(t),c.reloadUsers(t)},children:Object(v.jsx)(d.f,{className:"w-6 h-6"})})]})},c.dataResult=function(e){if(c.props.userList.users){var t=c.props.userList.users.findIndex((function(e){return e.page===c.state.currentPage}));if(t>=0)return e===a.Active_Users?c.props.userList.users[t].data.filter((function(e){return e.is_active})):e===a.Blocked_Users?c.props.userList.users[t].data.filter((function(e){return!e.is_active})):c.props.userList.users[t].data}return e===a.Active_Users?c.state.userData.filter((function(e){return e.is_active})):e===a.Blocked_Users?c.state.userData.filter((function(e){return!e.is_active})):c.state.userData},c.state={userTabs:a.All_Users,userData:[],loadingUsers:!0,filterByRoleLevel:"all",openFilterByRole:!1,loading:!0,manageUser:null,changeRole:!1,currentPage:1,lastLoadedPage:[1]},c}return Object(c.a)(s,[{key:"render",value:function(){var e=this;return!0===this.state.loading||null===this.props.userList.users?Object(v.jsx)("div",{className:"text-center mt-7 font-bold text-4xl text-gray-400 animate-pulse",children:"Loading users..."}):Object(v.jsxs)("div",{children:[!this.state.manageUser&&Object(v.jsx)("div",{className:"mt-3 rounded flex flex-row justify-between items-center",children:Object(v.jsxs)("div",{className:"flex flex-row items-center gap-3",children:[Object(v.jsx)(f.Rb,{className:"text-6xl text-blue-600"}),Object(v.jsx)("div",{className:"flex flex-col",children:Object(v.jsx)("span",{className:"text-blue-600 text-2xl font-bold",children:"System Users Management"})})]})}),Object(v.jsxs)("div",{className:"bg-white shadow rounded border border-gray-2 p-2 w-full overflow-x-auto ".concat(this.state.manageUser?"mt-3":""),children:[!this.state.manageUser&&Object(v.jsxs)("section",{className:"flex items-start gap-3",children:[Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"my-2 font-medium text-xl flex items-center gap-2",children:[Object(v.jsx)(u.f,{}),"Filter by roles"]}),Object(v.jsx)("div",{className:"flex flex-col mb-3 w-full",children:Object(v.jsxs)("select",{className:"w-full bg-white text-grey-darker border-2 border-gray-500 rounded h-10 px-2 focus:outline-none focus:bg-gray-100 animate__animated animate__fadeIn ".concat(this.state.loadingUsers&&"cursor-wait"),onChange:function(t){return e.setFilerByRoleLevel(t.target.value)},disabled:this.state.loadingUsers,value:this.state.filterByRoleLevel,children:[Object(v.jsx)("option",{value:"all",children:"All roles"}),this.props.accessRoles.length>0?this.props.accessRoles.map((function(e,t){return Object(v.jsx)("option",{value:e.system_user_role_id,children:e.role},Math.random())})):Object(v.jsx)("option",{value:"",disabled:!0,children:"No Role"})]})})]}),Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"my-2 font-medium text-xl flex items-center gap-2",children:[Object(v.jsx)(u.f,{}),"Filter by status"]}),Object(v.jsx)("div",{className:"flex items-start md:items-center justify-start md:justify-end gap-2",children:Object(v.jsx)("select",{className:"w-full bg-white text-grey-darker border-2 border-gray-500 rounded h-10 px-2 focus:outline-none focus:bg-gray-100 animate__animated animate__fadeIn ".concat(this.state.loadingUsers&&"cursor-wait"),onChange:function(t){return e.setUserTabs(t.target.value)},disabled:this.state.loadingUsers,children:Object.values(a).map((function(e,t){return Object(v.jsx)("option",{value:e,children:e},Math.random())}))})})]})]}),this.state.manageUser&&Object(v.jsxs)("div",{className:"flex items-center gap-3 mb-2 text-gray-600",children:[Object(v.jsx)("button",{className:"inline-block p-3 transition rounded-full bg-gray-400 ripple hover:bg-gray-600 focus:outline-none",onClick:function(){e.setManageUser(null),e.setChangeRole(!1)},children:Object(v.jsx)(g.f,{className:"w-6 h-6 text-gray-50"})}),Object(v.jsxs)("div",{className:"flex flex-col hidden",children:[Object(v.jsx)("span",{className:"text-gray-800 font-semibold text-2xl",children:this.state.manageUser.user_info.fname+" "+this.state.manageUser.user_info.lname}),Object(v.jsx)("span",{className:"text-gray-600 font-normal text-sm",children:this.state.manageUser.email})]})]}),this.state.userData&&Object(v.jsxs)("section",{children:[Object(v.jsx)(p.b,{users:this.filterByRole(this.dataResult(this.state.userTabs),this.state.filterByRoleLevel),roleList:this.props.accessRoles,userTypes:this.state.userTabs===a.Active_Users?"blocked":this.state.userTabs===a.Blocked_Users?"active":"all",loadingUser:this.state.loadingUsers,setLoadingUser:this.setLoadingUsers,manageUser:this.state.manageUser,setManageUser:this.setManageUser,changeRole:this.state.changeRole,setChangeRole:this.setChangeRole,currentPage:this.state.currentPage}),!this.state.loadingUsers&&Object(v.jsx)("div",{className:"flex flex-col items-center mb-3",children:this.props.userList.total_users&&this.generatePages(this.props.userList.total_users)})]})]})]})}}]),s}(o.Component),y=Object(h.b)((function(e){var t=e.users,s=e.access,a=e.schoolLevels;return{userList:t,accessRoles:s.accessRoles,schoolLevels:a}}),{fetchUserAccess:m.d,FC_GetAccessRoles:b.R,loadEducationCategories:b.Fc,PushPopupAlert:b.Pb})(U)}}]);
//# sourceMappingURL=65.002018ba.chunk.js.map