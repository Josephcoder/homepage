(this["webpackJsonpreact-redux-typescript-advance"]=this["webpackJsonpreact-redux-typescript-advance"]||[]).push([[55],{796:function(e,t,s){"use strict";s.r(t),s.d(t,"ClaimReport",(function(){return _}));var a=s(18),l=s(5),n=s.n(l),i=s(2),c=s(7),r=s(25),o=s(24),d=s(27),u=s(26),p=s(10),x=s.n(p),b=s(4),h=s(23),j=s(3),m=s(33),v=s(8),f=s(32),g=s(9),O=s(28),y=s(1),N=function(e){Object(d.a)(s,e);var t=Object(u.a)(s);function s(e){var l;return Object(r.a)(this,s),(l=t.call(this,e)).setLoading=function(e){return l.setState({loading:e})},l.GetClaims=function(){var e=Object(c.a)(n.a.mark((function e(t,s){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.setLoading(!0),e.prev=1,e.next=4,x.a.post("".concat(g.a.CLAIMING,"/user/level/").concat(t),{period_id:s});case 4:(a=e.sent).data&&l.setState({data:a.data}),console.log("Response: ",a.data),l.setLoading(!1),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log("Error: ",Object(i.a)({},e.t0)),l.setLoading(!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,s){return e.apply(this,arguments)}}(),l.GetSummaryFilter=function(e){var t,s=[],l=Object(a.a)(e);try{var n=function(){var e=t.value,a=s.find((function(t){return t.position_title===e.position_title}));void 0!==a?(s=s.filter((function(e){return e.position_title!==a.position_title}))).push({position_title:a.position_title,total:a.total+1,pending:e.status===v.b.PENDING?a.pending+1:a.pending,validated:e.status===v.b.EVALUATED?a.validated+1:a.validated}):s.push({position_title:e.position_title,total:e.total,pending:e.status===v.b.PENDING?1:0,validated:e.status===v.b.EVALUATED?1:0})};for(l.s();!(t=l.n()).done;)n()}catch(i){l.e(i)}finally{l.f()}return s},l.GetSummary=function(e){var t,s=[],n=e.filter((function(e){return e.type_key===l.state.selected_claim_type})),i=Object(a.a)(n);try{for(i.s();!(t=i.n()).done;){var c=t.value;s.push({position_title:c.title,total:1,status:c.claims.filter((function(e){return e.level===l.state.selected_level}))[0].claim_status})}}catch(r){i.e(r)}finally{i.f()}return l.GetSummaryFilter(s).sort((function(e,t){return e.pending<t.pending?1:t.pending<e.pending?-1:0}))},l.GetSummaryCounts=function(e){var t,s=0,l=0,n=0,i=Object(a.a)(e);try{for(i.s();!(t=i.n()).done;){var c=t.value;s+=c.pending,l+=c.validated,n+=c.total}}catch(r){i.e(r)}finally{i.f()}return{pending:s,validated:l,total:n}},l.componentDidMount=function(){if(null===l.props.schoolLevels.selectedEducationCategory){if(null!==l.props.schoolLevels.education_categories){var e=l.props.schoolLevels.education_categories.find((function(e){return e.education_institute_id===l.props.auth.education_institution_id}));void 0!==e&&(l.props.setSelectedEducationCategory(e),null!==e.session_plan&&l.GetClaims(l.state.selected_level,e.session_plan._id))}}else null!==l.props.schoolLevels.selectedEducationCategory.session_plan&&l.GetClaims(l.state.selected_level,l.props.schoolLevels.selectedEducationCategory.session_plan._id)},l.state={loading:!0,error:"",success:"",data:null,selected_level:1,selected_claim_type:v.g.APPLICATION},l}return Object(o.a)(s,[{key:"render",value:function(){var e,t=this,s=null===(e=this.props.schoolLevels.education_categories)||void 0===e?void 0:e.find((function(e){return e.education_institute_id===t.props.auth.education_institution_id}));return void 0===s?Object(y.jsx)("div",{children:Object(y.jsxs)("div",{className:"rounded-xl border-2 border-gray-600 flex flex-col items-center justify-center p-7 text-center w-full mt-5 bg-white",children:[Object(y.jsx)("span",{className:"font-extrabold text-3xl text-gray-600",children:"Your institute is not yet defined"}),Object(y.jsx)("span",{children:"If you have an institute assigned to you, please refresh your page or wait a moment... your page..."})]})}):!0===this.state.loading||null===this.props.schoolLevels.selectedEducationCategory||null===this.state.data?Object(y.jsxs)("div",{className:"bg-white rounded p-5 mt-5",children:[Object(y.jsx)(m.a,{}),Object(y.jsx)("div",{className:"-mt-5 ml-5",children:"Loading report, please wait..."})]}):(""!==this.state.error&&this.state.error,Object(y.jsx)("div",{children:Object(y.jsxs)("div",{className:"mt-4 bg-white rounded",children:[Object(y.jsxs)("div",{className:"p-4 flex flex-row items-center gap-3 justify-between",children:[Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{className:"text-3xl font-extrabold",children:["Claiming report (",Object(y.jsx)("span",{className:"text-blue-600 lowercase",children:Object(f.a)(this.state.selected_claim_type.toString())}),")"]}),Object(y.jsxs)("div",{className:"flex flex-row items-center gap-2 ml-2",children:[Object(y.jsxs)("div",{className:"flex flex-col",children:[Object(y.jsx)("span",{className:"text-sm font-bold",children:"Choose claim type"}),Object(y.jsxs)("select",{onChange:function(e){var s=e.target.value;t.setState({selected_claim_type:s})},value:this.state.selected_claim_type,className:"px-3 py-2 rounded border border-gray-500",children:[Object(y.jsx)("option",{value:v.g.APPLICATION,children:"Applications"}),Object(y.jsx)("option",{value:v.g.DOCUMENT_VALIDATION,children:"Document validation"}),Object(y.jsx)("option",{value:v.g.EXAMINATION,children:"Examinations"})]})]}),Object(y.jsxs)("div",{className:"flex flex-col",children:[Object(y.jsx)("span",{className:"text-sm font-bold",children:"Choose claim level"}),Object(y.jsxs)("select",{value:this.state.selected_level,onChange:function(e){if(null!==s.session_plan){var a=parseInt(e.target.value);t.setState({selected_level:a}),t.setLoading(!0),t.GetClaims(a,s.session_plan._id)}},className:"px-3 py-2 rounded border border-gray-500",children:[Object(y.jsx)("option",{value:1,children:"Level 1"}),Object(y.jsx)("option",{value:2,children:"Public Service Commission Level"})]})]})]})]}),Object(y.jsxs)("div",{className:"flex flex-row items-center gap-3",children:[Object(y.jsxs)("div",{className:"flex flex-col rounded bg-blue-100 p-2 text-right",children:[Object(y.jsx)("span",{className:"text-3xl font-extrabold",children:Object(O.h)(this.GetSummaryCounts(this.GetSummary(this.state.data)).total)}),Object(y.jsx)("span",{className:"font-normal text-sm text-blue-900",children:"Total claims"})]}),Object(y.jsxs)("div",{className:"flex flex-col rounded bg-blue-100 p-2 text-right",children:[Object(y.jsx)("span",{className:"text-3xl font-extrabold",children:Object(O.h)(this.GetSummaryCounts(this.GetSummary(this.state.data)).pending)}),Object(y.jsx)("span",{className:"font-normal text-sm text-blue-900",children:"Waiting claims"})]}),Object(y.jsxs)("div",{className:"flex flex-col rounded bg-green-100 p-2 text-right",children:[Object(y.jsx)("span",{className:"text-3xl font-extrabold text-green-900",children:Object(O.h)(this.GetSummaryCounts(this.GetSummary(this.state.data)).validated)}),Object(y.jsx)("span",{className:"font-normal text-sm text-green-900",children:"Validated claims"})]})]})]}),Object(y.jsxs)("div",{className:"border-t border-gray-400 p-4",children:[Object(y.jsxs)("div",{className:"flex flex-row items-center rounded",children:[Object(y.jsx)("div",{className:"px-3 py-2 bg-blue-100 font-bold text-blue-800 border-b-2 border-blue-600 cursor-pointer",children:"Table view"}),Object(y.jsx)("div",{className:"px-3 py-2 bg-blue-50 font-bold  border-b-2 border-white hover:bg-blue-100 hover:text-blue-800 cursor-pointer",children:"Analytical view"})]}),Object(y.jsxs)("table",{className:"w-full",children:[Object(y.jsx)("thead",{className:"bg-blue-100 ",children:Object(y.jsxs)("tr",{className:"",children:[Object(y.jsx)("th",{className:"px-3 py-1 text-center",children:"#"}),Object(y.jsx)("th",{className:"px-3 py-1 text-left",children:"Position"}),Object(y.jsx)("th",{className:"px-3 py-1 text-center",children:"Total claims"}),Object(y.jsx)("th",{className:"px-3 py-1 text-center",children:"Waiting claims"}),Object(y.jsx)("th",{className:"px-3 py-1 text-center",children:"Validated claims"})]})}),Object(y.jsx)("tbody",{children:0===this.GetSummary(this.state.data).length?Object(y.jsx)("tr",{children:Object(y.jsx)("td",{colSpan:5,className:"text-center p-3 text-3xl font-light bg-gray-100 border border-gray-500 rounded",children:"No result found!"})}):this.GetSummary(this.state.data).map((function(e,t){return Object(y.jsxs)("tr",{className:"".concat(t%2!==0?"bg-gray-100":"bg-white"," ").concat(e.total===e.validated?"text-green-900 font-light":0===e.validated?"text-yellow-900 font-bold":"text-black font-light"),children:[Object(y.jsx)("td",{className:"px-3 py-1 text-center",children:t+1}),Object(y.jsx)("td",{className:"px-3 py-1 text-left",children:e.position_title}),Object(y.jsx)("td",{className:"px-3 py-1 text-center",children:Object(O.h)(e.total)}),Object(y.jsx)("td",{className:"px-3 py-1 text-center",children:Object(O.h)(e.pending)}),Object(y.jsx)("td",{className:"px-3 py-1 text-center",children:Object(O.h)(e.validated)})]},t+1)}))})]})]})]})}))}}]),s}(b.Component),_=Object(h.b)((function(e){return{auth:e.auth,system:e.system,positions:e.positions,schoolLevels:e.schoolLevels}}),{setSelectedEducationCategory:j.hd,loadAllPositionsByInstitute:j.Cc})(N)}}]);
//# sourceMappingURL=55.73b21020.chunk.js.map