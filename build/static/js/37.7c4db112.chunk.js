(this["webpackJsonpreact-redux-typescript-advance"]=this["webpackJsonpreact-redux-typescript-advance"]||[]).push([[37],{1337:function(t,e,i){"use strict";i.r(e),i.d(e,"ShortListingReport",(function(){return C}));var n=i(11),r=i(18),s=i(5),a=i.n(s),c=i(2),d=i(7),o=i(25),l=i(24),u=i(27),f=i(26),_=i(10),b=i.n(_),p=i(4),x=i(12),h=i(714),j=i(23),m=i(3),v=i(33),g=i(19),O=i(32),y=i(9),N=i(690),w=i(28),S=i(704),T=i.n(S),D=i(1),k=function(t){Object(u.a)(i,t);var e=Object(f.a)(i);function i(t){var n;return Object(o.a)(this,i),(n=e.call(this,t)).setLoading=function(t){return n.setState({loading:t})},n.state={loading:!1,maxData:{series:[{name:"Minimum sits",data:n.props.district_max.map((function(t){return t.max_count}))}],options:{chart:{type:"bar",height:500},plotOptions:{bar:{borderRadius:6,horizontal:!0}},dataLabels:{enabled:!0},xaxis:{categories:n.props.district_max.map((function(t){return t.district_name}))}}},allData:{series:[{name:"Minimum sits",data:n.props.district_max.map((function(t){return t.max_count}))},{name:"All applicants",data:n.props.district_max.map((function(t){return t.total_count}))}],options:{chart:{type:"bar",height:800},plotOptions:{bar:{borderRadius:0,horizontal:!0}},dataLabels:{enabled:!1},xaxis:{categories:n.props.district_max.map((function(t){return t.district_name}))}}}},n}return Object(l.a)(i,[{key:"render",value:function(){return Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{className:"bg-white rounded p-3 mb-5 mt-3",children:[Object(D.jsx)("div",{className:"text-2xl font-bold mt-3 text-gray-600",children:"Districts and minimum candidates"}),Object(D.jsx)("div",{id:"chart",children:Object(D.jsx)(T.a,{options:this.state.maxData.options,series:this.state.maxData.series,type:"bar"})})]}),Object(D.jsxs)("div",{className:"bg-white rounded p-3 mb-5 mt-3",children:[Object(D.jsx)("div",{className:"text-2xl font-bold mt-3 text-gray-600",children:"Summary"}),Object(D.jsx)("div",{id:"chart",children:Object(D.jsx)(T.a,{options:this.state.allData.options,series:this.state.allData.series,type:"area"})})]})]})}}]),i}(p.Component),L=function(t){Object(u.a)(i,t);var e=Object(f.a)(i);function i(t){var s;return Object(o.a)(this,i),(s=e.call(this,t)).setLoading=function(t){return s.setState({loading:t})},s.loadShortListingReport=function(){var t=Object(d.a)(a.a.mark((function t(e){var i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===e.session_plan){t.next=14;break}return s.setLoading(!0),t.prev=2,t.next=5,b.a.get("".concat(y.a.APPLICATION,"/counter/dshortlisted/").concat(e.session_plan._id));case 5:200===(i=t.sent).status&&(null===s.props.positions.positions_list&&s.props.loadAllPositionsByInstitute(e.education_institute_id,s.setLoading),s.setState({loading:!1,data:i.data})),console.log("Res data: ",i.data),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),s.setLoading(!1),console.log("Err: ",Object(c.a)({},t.t0));case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}(),s.GetDistrictDataTotal=function(t){var e=0;if(null!==s.state.data){var i,n=Object(r.a)(s.state.data);try{for(n.s();!(i=n.n()).done;){var a=i.value.data.find((function(e){return e.district_of_residence_id===t}));void 0!==a&&(e+=a.count)}}catch(c){n.e(c)}finally{n.f()}}return e},s.GetDistrictMaximumSits=function(t){var e=0,i="",n="";if(null!==s.state.data){var a,c=Object(r.a)(s.state.data);try{var d=function(){var r=a.value,c=r.data.find((function(e){return e.district_of_residence_id===t}));if(void 0!==c&&c.count>e){var d,o=null===(d=s.props.positions.positions_list)||void 0===d?void 0:d.find((function(t){return t.position_id===r._id}));void 0!==o&&(i=o.position_title,n=o.position_id,e=c.count)}};for(c.s();!(a=c.n()).done;)d()}catch(o){c.e(o)}finally{c.f()}}return{position_id:n,position_title:i,count:e}},s.GetDistrictsDataMax=function(){var t=[];if(null!==s.state.data&&null!==s.state.districts){var e,i=Object(r.a)(s.state.districts.districts);try{for(i.s();!(e=i.n()).done;){var a=e.value,c=s.GetDistrictMaximumSits(a.district_code);t=[].concat(Object(n.a)(t),[{district_code:a.district_code,district_name:a.district_name,position_id:c.position_id,position_name:c.position_title,total_count:s.GetDistrictDataTotal(a.district_code),max_count:c.count}])}}catch(d){i.e(d)}finally{i.f()}}return t},s.componentDidMount=function(){if(null===s.state.districts&&(s.setLoading(!0),Object(m.Ib)((function(t,e,i){null!==e?s.setState({districts:e,loading:!1,error:""}):!1===t&&s.setState({error:i,loading:!1,districts:null})}))),null===s.props.schoolLevels.selectedEducationCategory){if(null!==s.props.schoolLevels.education_categories){var t=s.props.schoolLevels.education_categories.find((function(t){return t.education_institute_id===s.props.auth.education_institution_id}));void 0!==t&&(s.props.setSelectedEducationCategory(t),null===s.state.data&&s.loadShortListingReport(t))}}else null===s.state.data&&s.loadShortListingReport(s.props.schoolLevels.selectedEducationCategory)},s.exportExcel=function(){alert("Exported successfully!")},s.FC_UpdateApplicationToPrint=function(){if(s.state.districts&&s.state.data&&s.props.positions.positions_list){var t=[],e=1;for(var i in s.state.data)Object.prototype.hasOwnProperty.call(s.state.data,i)&&function(){var n=s.state.data[i],r=s.props.positions.positions_list.find((function(t){return t.position_id===n._id})),a={n:e,positions:r?r.position_title:"Unknown position",Nyarugenge:n.data.find((function(t){return"11"===t.district_of_residence_id}))?n.data.find((function(t){return"11"===t.district_of_residence_id})).count:0,Gasabo:n.data.find((function(t){return"12"===t.district_of_residence_id}))?n.data.find((function(t){return"12"===t.district_of_residence_id})).count:0,Kicukiro:n.data.find((function(t){return"13"===t.district_of_residence_id}))?n.data.find((function(t){return"13"===t.district_of_residence_id})).count:0,Nyanza:n.data.find((function(t){return"21"===t.district_of_residence_id}))?n.data.find((function(t){return"21"===t.district_of_residence_id})).count:0,Gisagara:n.data.find((function(t){return"22"===t.district_of_residence_id}))?n.data.find((function(t){return"22"===t.district_of_residence_id})).count:0,Nyaruguru:n.data.find((function(t){return"23"===t.district_of_residence_id}))?n.data.find((function(t){return"23"===t.district_of_residence_id})).count:0,Huye:n.data.find((function(t){return"24"===t.district_of_residence_id}))?n.data.find((function(t){return"24"===t.district_of_residence_id})).count:0,Nyamagabe:n.data.find((function(t){return"25"===t.district_of_residence_id}))?n.data.find((function(t){return"25"===t.district_of_residence_id})).count:0,Ruhango:n.data.find((function(t){return"26"===t.district_of_residence_id}))?n.data.find((function(t){return"26"===t.district_of_residence_id})).count:0,Muhanga:n.data.find((function(t){return"27"===t.district_of_residence_id}))?n.data.find((function(t){return"27"===t.district_of_residence_id})).count:0,Kamonyi:n.data.find((function(t){return"28"===t.district_of_residence_id}))?n.data.find((function(t){return"28"===t.district_of_residence_id})).count:0,Karongi:n.data.find((function(t){return"31"===t.district_of_residence_id}))?n.data.find((function(t){return"31"===t.district_of_residence_id})).count:0,Rutsiro:n.data.find((function(t){return"32"===t.district_of_residence_id}))?n.data.find((function(t){return"32"===t.district_of_residence_id})).count:0,Rubavu:n.data.find((function(t){return"33"===t.district_of_residence_id}))?n.data.find((function(t){return"33"===t.district_of_residence_id})).count:0,Nyabihu:n.data.find((function(t){return"34"===t.district_of_residence_id}))?n.data.find((function(t){return"34"===t.district_of_residence_id})).count:0,Ngororero:n.data.find((function(t){return"35"===t.district_of_residence_id}))?n.data.find((function(t){return"35"===t.district_of_residence_id})).count:0,Rusizi:n.data.find((function(t){return"36"===t.district_of_residence_id}))?n.data.find((function(t){return"36"===t.district_of_residence_id})).count:0,Nyamasheke:n.data.find((function(t){return"37"===t.district_of_residence_id}))?n.data.find((function(t){return"37"===t.district_of_residence_id})).count:0,Rulindo:n.data.find((function(t){return"41"===t.district_of_residence_id}))?n.data.find((function(t){return"41"===t.district_of_residence_id})).count:0,Gakenke:n.data.find((function(t){return"42"===t.district_of_residence_id}))?n.data.find((function(t){return"42"===t.district_of_residence_id})).count:0,Musanze:n.data.find((function(t){return"43"===t.district_of_residence_id}))?n.data.find((function(t){return"43"===t.district_of_residence_id})).count:0,Burera:n.data.find((function(t){return"44"===t.district_of_residence_id}))?n.data.find((function(t){return"44"===t.district_of_residence_id})).count:0,Gicumbi:n.data.find((function(t){return"45"===t.district_of_residence_id}))?n.data.find((function(t){return"45"===t.district_of_residence_id})).count:0,Rwamagana:n.data.find((function(t){return"51"===t.district_of_residence_id}))?n.data.find((function(t){return"51"===t.district_of_residence_id})).count:0,Nyagatare:n.data.find((function(t){return"52"===t.district_of_residence_id}))?n.data.find((function(t){return"52"===t.district_of_residence_id})).count:0,Gatsibo:n.data.find((function(t){return"53"===t.district_of_residence_id}))?n.data.find((function(t){return"53"===t.district_of_residence_id})).count:0,Kayonza:n.data.find((function(t){return"54"===t.district_of_residence_id}))?n.data.find((function(t){return"54"===t.district_of_residence_id})).count:0,Kirehe:n.data.find((function(t){return"55"===t.district_of_residence_id}))?n.data.find((function(t){return"55"===t.district_of_residence_id})).count:0,Ngoma:n.data.find((function(t){return"56"===t.district_of_residence_id}))?n.data.find((function(t){return"56"===t.district_of_residence_id})).count:0,Bugesera:n.data.find((function(t){return"57"===t.district_of_residence_id}))?n.data.find((function(t){return"57"===t.district_of_residence_id})).count:0};t.push(a),e++}();s.setState({datToPrint:t}),t=[],e=1}},s.state={loading:!1,data:null,searchData:"",districts:null,error:"",viewType:"Table",datToPrint:null,generateReportModal:null,formError:null,reportTitle:"Shortlisting report"},s}return Object(l.a)(i,[{key:"render",value:function(){var t,e=this;return void 0===(null===(t=this.props.schoolLevels.education_categories)||void 0===t?void 0:t.find((function(t){return t.education_institute_id===e.props.auth.education_institution_id})))?Object(D.jsx)("div",{children:Object(D.jsxs)("div",{className:"rounded-xl border-2 border-gray-600 flex flex-col items-center justify-center p-7 text-center w-full mt-5 bg-white",children:[Object(D.jsx)("span",{className:"font-extrabold text-3xl text-gray-600",children:"Your institute is not yet defined"}),Object(D.jsx)("span",{children:"If you have an institute assigned to you, please refresh your page or wait a moment... your page..."})]})}):null===this.state.loading||null===this.state.data||null===this.props.schoolLevels.selectedEducationCategory||null===this.props.positions.positions_list?Object(D.jsxs)("div",{className:"bg-white rounded p-5 mt-5",children:[Object(D.jsx)(v.a,{}),Object(D.jsx)("div",{className:"-mt-5 ml-5",children:"Loading report, please wait..."})]}):(""!==this.state.error&&this.state.error,Object(D.jsxs)("div",{children:[Object(D.jsxs)("section",{children:[Object(D.jsxs)("div",{className:"grid md:grid-cols-12",children:[Object(D.jsxs)("div",{className:"col-span-8",children:[Object(D.jsx)("div",{className:"mt-4 flex flex-col gap-1",children:Object(D.jsx)("span",{className:"text-4xl font-bold text-gray-700",children:"Shortlisting report"})}),Object(D.jsx)("div",{className:"flex flex-col",children:Object(D.jsx)("span",{className:"text-blue-600 font-bold text-lg",children:this.props.schoolLevels.selectedEducationCategory.description})}),Object(D.jsxs)("div",{className:"flex flex-row items-center bg-white w-max",children:[Object(D.jsxs)("div",{onClick:function(){return e.setState({viewType:"Table"})},className:"cursor-pointer flex flex-row gap-1 items-center border-b-4 px-5 py-2 ".concat("Table"===this.state.viewType?"border-blue-600 text-blue-600 font-extrabold":"border-white"),children:[Object(D.jsx)("div",{children:Object(D.jsx)(x.Wb,{className:"text-2xl"})}),Object(D.jsx)("span",{children:"Table view"})]}),Object(D.jsxs)("div",{onClick:function(){return e.setState({viewType:"Chart"})},className:"cursor-pointer flex flex-row gap-1 items-center border-b-4 px-5 py-2 ".concat("Chart"===this.state.viewType?"border-blue-600 text-blue-600 font-extrabold":"border-white"),children:[Object(D.jsx)("div",{children:Object(D.jsx)(x.m,{className:"text-2xl"})}),Object(D.jsx)("span",{children:"Graph representation"})]})]})]}),Object(D.jsx)("div",{className:"col-span-4",children:Object(D.jsxs)("div",{className:"float-right flex flex-col mr-2 mt-4 bg-white rounded p-3 py-2",children:[Object(D.jsx)("span",{children:"Active Session"}),Object(D.jsx)("div",{className:"border-b border-gray-400 my-1"}),Object(D.jsx)("span",{className:"font-bold text-blue-600 text-lg",children:Object(O.b)(this.props.schoolLevels.selectedEducationCategory.session_plan.session_plan_name)})]})})]}),"Table"===this.state.viewType?Object(D.jsxs)("div",{children:[Object(D.jsx)("div",{className:"flex items-end justify-end mr-3 -mt-7",children:Object(D.jsxs)("div",{onClick:function(){e.FC_UpdateApplicationToPrint(),e.setState({generateReportModal:{reportType:"EXCEL",status:!0}})},className:"cursor-pointer flex flex-row items-center gap-2 rounded bg-blue-100 hover:bg-blue-200 text-blue-600 hover:text-blue-700 px-3 py-2 w-max border border-blue-600 hover:border-blue-700",children:[Object(D.jsx)("div",{children:Object(D.jsx)(h.b,{className:"text-xl"})}),Object(D.jsx)("span",{children:"Export"})]})}),null!==this.state.districts&&this.state.districts.districts.length>0&&Object(D.jsx)("div",{className:"bg-white my-4 mt-2 mr-2",children:Object(D.jsx)("div",{className:"w-full overflow-x-auto mb-10",children:Object(D.jsxs)("table",{className:"w-full shadow",id:"report_content",children:[Object(D.jsx)("thead",{className:"bg-white border-b-2 border-blue-600 text-gray-600 font-extrabold text-sm",children:Object(D.jsxs)("tr",{className:"border-b border-blue-600",children:[Object(D.jsx)("th",{className:"px-4 py-2 text-black border border-blue-400",children:"#"}),Object(D.jsx)("th",{className:"px-4 py-2 text-black text-left border border-blue-400",children:Object(D.jsx)("div",{className:"w-80",children:"Position/District"})}),this.state.districts.districts.map((function(t,e){return Object(D.jsx)("th",{className:"px-4 py-3 border text-black border-blue-400 text-center",children:t.district_name},e+1)}))]})}),Object(D.jsx)("tbody",{children:0===this.state.data.length?Object(D.jsx)("tr",{children:Object(D.jsx)("td",{colSpan:32,className:"p-5 text-xl font-extrabold text-gray-600",children:"No data found!"})}):this.state.data.map((function(t,i){var n,r;return Object(D.jsxs)("tr",{className:"hover:bg-blue-50 hover:text-blue-700 group cursor-pointer",children:[Object(D.jsx)("td",{className:"px-4 py-3 border border-gray-400  text-center",children:i+1}),Object(D.jsx)("td",{className:"px-4 py-3 border border-gray-400 w-80",children:null===(n=e.props.positions.positions_list)||void 0===n||null===(r=n.find((function(e){return e.position_id===t._id})))||void 0===r?void 0:r.position_title}),null!==e.state.districts&&e.state.districts.districts.map((function(e,i){return Object(D.jsx)("td",{className:"px-4 py-3 border border-gray-400 text-center",children:void 0===t.data.find((function(t){return t.district_of_residence_id===e.district_code}))||null===t.data.find((function(t){return t.district_of_residence_id===e.district_code}))?0:Object(w.g)(t.data.find((function(t){return t.district_of_residence_id===e.district_code})).count)},i+1)}))]},i+1)}))}),Object(D.jsxs)("tfoot",{children:[Object(D.jsxs)("tr",{className:"bg-blue-50 text-blue-600",children:[Object(D.jsx)("td",{colSpan:2,className:"font-extrabold text-lg px-4 border border-blue-400",children:"Total shortlisted"}),this.state.districts.districts.map((function(t,i){return Object(D.jsx)("th",{className:"px-4 py-3 border border-blue-400 text-center",children:Object(D.jsxs)("div",{className:"flex flex-col font-extrabold items-center justify-center text-center w-full text-xl",children:[Object(D.jsx)("span",{children:Object(w.g)(e.GetDistrictDataTotal(t.district_code))}),Object(D.jsx)("span",{className:"text-sm text-black font-light",children:t.district_name})]})},i+1)}))]}),Object(D.jsxs)("tr",{className:"bg-green-50 text-green-600",children:[Object(D.jsx)("td",{colSpan:2,className:"font-extrabold text-lg px-4 border border-green-400",children:"Maximum candidates (position)"}),this.state.districts.districts.map((function(t,i){return Object(D.jsx)("th",{className:"border border-green-400 text-center",children:Object(D.jsxs)("div",{className:"flex flex-col font-extrabold items-center justify-center w-max text-xl hover:bg-green-100 px-4 py-3",children:[Object(D.jsx)("span",{children:Object(w.g)(e.GetDistrictMaximumSits(t.district_code).count)}),Object(D.jsx)("span",{className:"text-sm text-black font-light",children:e.GetDistrictMaximumSits(t.district_code).position_title})]})},i+1)}))]})]})]})})})]}):Object(D.jsx)("div",{children:Object(D.jsx)("div",{children:Object(D.jsx)(k,{district_max:this.GetDistrictsDataMax()})})})]}),null!==this.state.generateReportModal&&!0===this.state.generateReportModal.status&&Object(D.jsx)(g.d,{title:Object(D.jsx)("div",{className:"flex flex-row gap-4 items-center",children:Object(D.jsxs)("div",{className:"flex flex-col",children:[Object(D.jsx)("span",{className:"font-bold text-2xl text-gray-500",children:"Generating Report contents"}),Object(D.jsx)("span",{className:"text-sm text-blue-600 font-normal",children:"Generating Shortlisting Report"})]})}),backDrop:!0,theme:g.c.default,close:function(){return e.setState({generateReportModal:null})},backDropClose:!0,widthSizeClass:g.b.medium,displayClose:!0,padding:{title:!0},children:Object(D.jsxs)("div",{className:"px-6",children:[Object(D.jsx)("div",{className:"my-2 text-base text-gray-700 sm:text-lg",children:Object(D.jsxs)("div",{className:"flex flex-col",children:[Object(D.jsx)("label",{children:"Title"}),Object(D.jsx)("input",{type:"text",className:"text-left input-white w-20 inline-block ".concat(this.state.formError&&"report_title"===this.state.formError.element?"border-red-500":"border-gray-500"," border-2"),placeholder:"Report title",value:this.state.reportTitle,onChange:function(t){return e.setState({formError:null,reportTitle:t.target.value})},disabled:!this.state.datToPrint}),this.state.formError&&"report_title"===this.state.formError.element&&Object(D.jsx)("span",{className:"text-red-500",children:this.state.formError.msg})]})}),Object(D.jsx)("div",{className:"flex justify-end mb-2 mt-4",children:this.state.datToPrint&&!Object(O.f)(this.state.reportTitle)&&Object(D.jsx)(N.a,{fileData:this.state.datToPrint,fileName:this.state.reportTitle,btnName:"Generate"})})]})})]}))}}]),i}(p.Component),C=Object(j.b)((function(t){return{auth:t.auth,system:t.system,positions:t.positions,schoolLevels:t.schoolLevels}}),{setSelectedEducationCategory:m.hd,loadAllPositionsByInstitute:m.Cc})(L)},690:function(t,e,i){"use strict";i(4);var n=i(716),r=i(717),s=i(34),a=i(1);e.a=function(t){var e=t.fileData,i=t.fileName,c=t.btnName,d=void 0===c?"Excel":c,o=t.className,l=void 0===o?"flex items-center gap-1 px-4 py-1 rounded text-green-700 bg-white border hover:text-white hover:bg-green-700 border-green-700 font-bold":o,u=t.showIcon,f=void 0===u||u;return Object(a.jsxs)("button",{onClick:function(t){return function(t,e){var i={Sheets:{data:r.utils.json_to_sheet(t)},SheetNames:["data"]},s=r.write(i,{bookType:"xlsx",type:"array"}),a=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});n.saveAs(a,e+".xlsx")}(e,i)},className:l,children:[f&&Object(a.jsx)(s.j,{}),d]})}},713:function(t,e){},718:function(t,e){},719:function(t,e){}}]);
//# sourceMappingURL=37.7c4db112.chunk.js.map