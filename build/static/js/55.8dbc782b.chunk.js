(this["webpackJsonpreact-redux-typescript-advance"]=this["webpackJsonpreact-redux-typescript-advance"]||[]).push([[55],{1315:function(e,t,s){"use strict";s.r(t),s.d(t,"ClaimReport",(function(){return N}));var a=s(18),n=s(5),l=s.n(n),i=s(2),c=s(7),r=s(25),o=s(24),d=s(27),u=s(26),p=s(10),x=s.n(p),h=s(4),j=s(23),b=s(3),m=s(33),f=s(8),g=s(9),v=s(28),O=s(1),y=function(e){Object(d.a)(s,e);var t=Object(u.a)(s);function s(e){var n;return Object(r.a)(this,s),(n=t.call(this,e)).setLoading=function(e){return n.setState({loading:e})},n.GetClaims=function(){var e=Object(c.a)(l.a.mark((function e(t,s){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setLoading(!0),e.prev=1,e.next=4,x.a.post("".concat(g.a.CLAIMING,"/user/level/").concat(t),{period_id:s});case 4:(a=e.sent).data&&n.setState({data:a.data}),console.log("Response: ",a.data),n.setLoading(!1),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log("Error: ",Object(i.a)({},e.t0)),n.setLoading(!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,s){return e.apply(this,arguments)}}(),n.GetSummaryFilter=function(e){var t,s=[],n=Object(a.a)(e);try{var l=function(){var e=t.value,a=s.find((function(t){return t.position_title===e.position_title}));void 0!==a?(s=s.filter((function(e){return e.position_title!==a.position_title}))).push({position_title:a.position_title,total:a.total+1,pending:e.status===f.b.PENDING?a.pending+1:a.pending,validated:e.status===f.b.EVALUATED?a.validated+1:a.validated}):s.push({position_title:e.position_title,total:e.total,pending:e.status===f.b.PENDING?1:0,validated:e.status===f.b.EVALUATED?1:0})};for(n.s();!(t=n.n()).done;)l()}catch(i){n.e(i)}finally{n.f()}return s},n.GetSummary=function(e){var t,s=[],l=e.filter((function(e){return e.type_key===f.g.APPLICATION})),i=Object(a.a)(l);try{for(i.s();!(t=i.n()).done;){var c=t.value;s.push({position_title:c.title,total:1,status:c.claims.filter((function(e){return 1===e.level}))[0].claim_status})}}catch(r){i.e(r)}finally{i.f()}return n.GetSummaryFilter(s).sort((function(e,t){return e.pending<t.pending?1:t.pending<e.pending?-1:0}))},n.GetSummaryCounts=function(e){var t,s=0,n=0,l=0,i=Object(a.a)(e);try{for(i.s();!(t=i.n()).done;){var c=t.value;s+=c.pending,n+=c.validated,l+=c.total}}catch(r){i.e(r)}finally{i.f()}return{pending:s,validated:n,total:l}},n.componentDidMount=function(){if(null===n.props.schoolLevels.selectedEducationCategory){if(null!==n.props.schoolLevels.education_categories){var e=n.props.schoolLevels.education_categories.find((function(e){return e.education_institute_id===n.props.auth.education_institution_id}));void 0!==e&&(n.props.setSelectedEducationCategory(e),null!==e.session_plan&&n.GetClaims(n.state.selected_level,e.session_plan._id))}}else null!==n.props.schoolLevels.selectedEducationCategory.session_plan&&n.GetClaims(n.state.selected_level,n.props.schoolLevels.selectedEducationCategory.session_plan._id)},n.state={loading:!0,error:"",success:"",data:null,selected_level:1,selected_claim_type:f.g.APPLICATION},n}return Object(o.a)(s,[{key:"render",value:function(){var e,t=this;return void 0===(null===(e=this.props.schoolLevels.education_categories)||void 0===e?void 0:e.find((function(e){return e.education_institute_id===t.props.auth.education_institution_id})))?Object(O.jsx)("div",{children:Object(O.jsxs)("div",{className:"rounded-xl border-2 border-gray-600 flex flex-col items-center justify-center p-7 text-center w-full mt-5 bg-white",children:[Object(O.jsx)("span",{className:"font-extrabold text-3xl text-gray-600",children:"Your institute is not yet defined"}),Object(O.jsx)("span",{children:"If you have an institute assigned to you, please refresh your page or wait a moment... your page..."})]})}):null===this.state.loading||null===this.props.schoolLevels.selectedEducationCategory||null===this.state.data?Object(O.jsxs)("div",{className:"bg-white rounded p-5 mt-5",children:[Object(O.jsx)(m.a,{}),Object(O.jsx)("div",{className:"-mt-5 ml-5",children:"Loading report, please wait..."})]}):(""!==this.state.error&&this.state.error,Object(O.jsx)("div",{children:Object(O.jsxs)("div",{className:"mt-4 bg-white rounded",children:[Object(O.jsxs)("div",{className:"p-4 flex flex-row items-center gap-3 justify-between",children:[Object(O.jsxs)("div",{children:[Object(O.jsx)("div",{className:"text-3xl font-extrabold",children:"Claiming report"}),Object(O.jsxs)("div",{className:"flex flex-row items-center gap-2 ml-2",children:[Object(O.jsxs)("div",{className:"flex flex-col",children:[Object(O.jsx)("span",{className:"text-sm font-bold",children:"Choose claim type"}),Object(O.jsxs)("select",{onChange:function(e){return t.setState({selected_claim_type:e.target.value})},value:this.state.selected_claim_type,className:"px-3 py-2 rounded border border-gray-400",children:[Object(O.jsx)("option",{value:f.g.APPLICATION,children:"Applications"}),Object(O.jsx)("option",{value:f.g.DOCUMENT_VALIDATION,children:"Document validation"}),Object(O.jsx)("option",{value:f.g.EXAMINATION,children:"Examinations"})]})]}),Object(O.jsxs)("div",{className:"flex flex-col",children:[Object(O.jsx)("span",{className:"text-sm font-bold",children:"Choose claim level"}),Object(O.jsx)("select",{className:"px-3 py-2 rounded border border-gray-400",children:Object(O.jsx)("option",{children:"Choose claim level"})})]})]})]}),Object(O.jsxs)("div",{className:"flex flex-row items-center gap-3",children:[Object(O.jsxs)("div",{className:"flex flex-col rounded bg-gray-200 p-2 text-right",children:[Object(O.jsx)("span",{className:"text-3xl font-extrabold",children:Object(v.h)(this.GetSummaryCounts(this.GetSummary(this.state.data)).total)}),Object(O.jsx)("span",{className:"font-bold text-gray-500",children:"Total claims"})]}),Object(O.jsxs)("div",{className:"flex flex-col rounded bg-gray-200 p-2 text-right",children:[Object(O.jsx)("span",{className:"text-3xl font-extrabold",children:Object(v.h)(this.GetSummaryCounts(this.GetSummary(this.state.data)).pending)}),Object(O.jsx)("span",{className:"font-bold text-gray-500",children:"Waiting claims"})]}),Object(O.jsxs)("div",{className:"flex flex-col rounded bg-gray-200 p-2 text-right",children:[Object(O.jsx)("span",{className:"text-3xl font-extrabold",children:Object(v.h)(this.GetSummaryCounts(this.GetSummary(this.state.data)).validated)}),Object(O.jsx)("span",{className:"font-bold text-gray-500",children:"Validated claims"})]})]})]}),Object(O.jsx)("div",{className:"border-t border-gray-400 p-4",children:Object(O.jsxs)("table",{className:"w-full",children:[Object(O.jsx)("thead",{className:"bg-blue-100 ",children:Object(O.jsxs)("tr",{className:"",children:[Object(O.jsx)("th",{className:"px-3 py-1 text-center",children:"#"}),Object(O.jsx)("th",{className:"px-3 py-1 text-left",children:"Position"}),Object(O.jsx)("th",{className:"px-3 py-1 text-center",children:"Total claims"}),Object(O.jsx)("th",{className:"px-3 py-1 text-center",children:"Waiting claims"}),Object(O.jsx)("th",{className:"px-3 py-1 text-center",children:"Validated claims"})]})}),Object(O.jsx)("tbody",{children:0===this.GetSummary(this.state.data).length?Object(O.jsx)("tr",{children:Object(O.jsx)("td",{colSpan:5,className:"text-center p-3 text-3xl font-light bg-gray-100 border border-gray-500 rounded",children:"No result found!"})}):this.GetSummary(this.state.data).map((function(e,t){return Object(O.jsxs)("tr",{className:"".concat(t%2!==0?"bg-gray-100":"bg-white"," ").concat(e.total===e.validated?"text-green-900 font-light":0===e.validated?"text-yellow-900 font-bold":"text-black font-light"),children:[Object(O.jsx)("td",{className:"px-3 py-1 text-center",children:t+1}),Object(O.jsx)("td",{className:"px-3 py-1 text-left",children:e.position_title}),Object(O.jsx)("td",{className:"px-3 py-1 text-center",children:Object(v.h)(e.total)}),Object(O.jsx)("td",{className:"px-3 py-1 text-center",children:Object(v.h)(e.pending)}),Object(O.jsx)("td",{className:"px-3 py-1 text-center",children:Object(v.h)(e.validated)})]},t+1)}))})]})})]})}))}}]),s}(h.Component),N=Object(j.b)((function(e){return{auth:e.auth,system:e.system,positions:e.positions,schoolLevels:e.schoolLevels}}),{setSelectedEducationCategory:b.hd,loadAllPositionsByInstitute:b.Cc})(y)}}]);
//# sourceMappingURL=55.8dbc782b.chunk.js.map