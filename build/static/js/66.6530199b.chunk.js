(this["webpackJsonpreact-redux-typescript-advance"]=this["webpackJsonpreact-redux-typescript-advance"]||[]).push([[66],{1306:function(t,e,s){"use strict";s.r(e),s.d(e,"_District",(function(){return M})),s.d(e,"District",(function(){return B}));var o=s(5),i=s.n(o),a=s(7),n=s(11),c=s(25),r=s(24),l=s(27),d=s(26),p=s(10),u=s.n(p),h=s(4),m=s(871),b=s(12),g=s(23),x=s(37),f=s(3),j=s(82),_=s(730),P=s(202),O=s(686),v=s(19),y=s(162),N=s(123),T=s(742),S=s(21),q=s(32),C=s(694),w=s(8),A=s(14),D=s(28),E=s(820),I=s(925),L=s(794),R=s(1),k=[{columnTitle:"SCHOOL",alignText:"left",padding:"p-3"},{columnTitle:"POSITION",alignText:"left",padding:"p-3"},{columnTitle:"Teacher F",alignText:"left",padding:"p-3"},{columnTitle:"Teacher M",alignText:"left",padding:"p-3"},{columnTitle:"REQUESTED POSTS",alignText:"left",padding:"p-3"},{columnTitle:"APPROVED POSTS",alignText:"left",padding:"p-3"},{columnTitle:"ALL POSTS",alignText:"left",padding:"p-3"},{columnTitle:"ALL STAFF",alignText:"left",padding:"p-3"},{columnTitle:"NEW STAFF",alignText:"left",padding:"p-3"},{columnTitle:"VACANT POSTS",alignText:"left",padding:"p-3"},{columnTitle:"",alignText:"left",padding:"p-3"}],F=[{columnTitle:"SCHOOL",alignText:"left",padding:"p-3"},{columnTitle:"POSITION",alignText:"left",padding:"p-3"},{columnTitle:"Teacher F",alignText:"left",padding:"p-3"},{columnTitle:"Teacher M",alignText:"left",padding:"p-3"},{columnTitle:"REQUESTED POSTS",alignText:"left",padding:"p-3"},{columnTitle:"APPROVED POSTS",alignText:"left",padding:"p-3"},{columnTitle:"",alignText:"left",padding:"p-3"}],M=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(t){var o;return Object(c.a)(this,s),(o=e.call(this,t)).setTableColumns=function(t){o.setState({tableColumns:t})},o.setModalState=function(t){o.setState({modalState:t})},o.setFilterByPosition=function(t){o.setState({filterByPosition:t})},o.setInstituteId=function(t){o.setState({institute_id:t})},o.setCategoryId=function(t){o.setState({category_id:t})},o.setQualificationId=function(t){o.setState({qualification_id:t})},o.setLoadingRequest=function(t){o.setState({loadingRequest:t})},o.setLoading=function(t){o.setState({loading:t})},o.setLoadingPost=function(t){o.setState({loadingPost:t})},o.setThisPost=function(t){o.setState({thisPost:t})},o.setThisPostTable=function(t){o.setState({thisPostTable:t})},o.setConfirmedPosts=function(t){o.setState({confirmedPosts:t})},o.setLeftPlacement=function(t){o.setState({leftPlacements:t})},o.setViewPost=function(t){o.setState({viewPost:t})},o.setApprovedPosts=function(t){o.setState({approvedPosts:t})},o.setFormError=function(t){o.setState({formError:t})},o.setSelectedPostId=function(t){o.setState({selectedPostId:t})},o.assignConfirmedPost=function(t,e,s){var i=[],a=o.getLimitations(s,o.props.districtPlacementLimits,t.post_id);if(e>t.requested_post||a.distributed+e>a.general)return o.props.PushPopupAlert({title:"Incorrect value!",theme:S.a.warning});if(o.state.confirmedPosts){var c=(i=Object(n.a)(o.state.confirmedPosts)).findIndex((function(e){return e.requested_post_id===t.post_id}));c>=0?(i[c].confirmed_posts=e,i[c].approval_date=new Date):i.push({requested_post_id:t.post_id,confirmed_posts:e,confirmed_by:o.props.auth.user.user_id,approval_date:new Date,description:"Not defined",requested_post_status:C.c.CONFIRMED})}else i.push({requested_post_id:t.post_id,confirmed_posts:e,confirmed_by:o.props.auth.user.user_id,approval_date:new Date,description:"Not defined",requested_post_status:C.c.CONFIRMED});o.setConfirmedPosts(i)},o.getAssignedValuePost=function(t){var e=0;if(o.state.confirmedPosts){var s=o.state.confirmedPosts.find((function(e){return e.requested_post_id===t}));s&&(e=s.confirmed_posts)}return e},o.loadData=function(t){o.props.document.documentCategory||o.props.getDocumentCategory(),o.props.document.documentSubCategory||o.props.getDocumentSubCategory(),null===o.props.systemPositions&&o.props.auth.education_institution_id&&(o.setLoading(!0),o.props.FC_GetPositionsByInstitution(o.props.auth.education_institution_id,(function(t,e){o.setLoading(t),console.log({status:t,msg:e}),e.length&&o.props.PushPopupAlert({title:e,theme:S.a.danger})}))),!o.props.districtPosts.length&&o.state.loadingPost?o.props.fetchDistrictPosts(o.props.auth.user_access.district_id,(function(t,e){o.setLoadingPost(t),t||e.length>0&&o.state.loadingPost&&(console.error("error loading school post: ",e),o.props.PushPopupAlert({title:e,theme:S.a.danger}))})):o.state.loadingPost&&o.setLoadingPost(!1),o.props.districtPlacements?o.state.loading&&o.setLoading(!1):o.props.getDistrictPlacement(o.props.auth.user_access.district_id,(function(t,e){o.setLoading(t),t||e.length>0&&t&&(console.error("error loading school post: ",e),o.props.PushPopupAlert({title:e,theme:S.a.danger}))})),null!==o.props.schoolLevels.education_categories&&0!==o.props.schoolLevels.education_categories.length||(o.setLoading(!0),o.props.loadEducationCategories(o.setLoading)),o.props.districtPlacementLimits?o.state.loading&&o.setLoading(!1):o.props.getDistrictPlacementLimit(o.props.auth.user_access.district_id,t,(function(t,e){o.setLoading(t),t||e.length>0&&t&&(console.error("error loading getDistrictPlacementLimit: ",e),o.props.PushPopupAlert({title:e,theme:S.a.danger}))}))},o.componentDidMount=function(){Object(q.f)(o.props.auth.user_access.district_id)||(null===o.props.activeAcademicSession||"none"===o.props.activeAcademicSession?o.props.getActiveAcademicSession((function(t,e,s){o.setLoading(t),e.length>0&&(console.error({loadingCandidatesError:e}),o.props.PushPopupAlert({title:e,theme:S.a.danger})),s&&"none"!==s&&o.loadData(s._id)})):o.loadData(o.props.activeAcademicSession._id))},o.doPlacement=function(){var t=Object(a.a)(i.a.mark((function t(e){var s,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.a.post("".concat(w.a.PLACEMENT,"/doplace/").concat(e.school_id,"/").concat(e.position_id),{request_id:e._id});case 3:(s=t.sent)&&(console.log("===================================="),console.log({doPlacement:s}),console.log("===================================="),o.props.fetchDistrictPosts(o.props.auth.user_access.district_id,(function(t,e){t||(e.length>0&&o.state.loadingPost&&(console.error("error loading school post: ",e),o.props.PushPopupAlert({title:e,theme:S.a.danger})),o.setLoadingPost(!1))})),a="",a=s.data.length>0?s.data.length===o.state.approvedPosts?"All confirmed posts has been placed on school!":"".concat(s.data.length," of ").concat(o.state.approvedPosts," post(s) has been placed on school!"):"Post request has been confirmed but no placement done!",o.setThisPost(null),o.setApprovedPosts(0),o.setModalState(null),o.setThisPostTable(null),o.setTableColumns(k),o.setSelectedPostId(""),o.setConfirmedPosts(null),o.props.PushPopupAlert({title:a,theme:s.data.length>0?S.a.success:S.a.info})),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error({doPlacement_reply:t.t0}),o.props.PushPopupAlert({title:Object(A.a)(t.t0),theme:S.a.danger});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),o.reDoPlacement=function(){var t=Object(a.a)(i.a.mark((function t(e){var s,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.a.post("".concat(w.a.PLACEMENT,"/doplace/").concat(e.school_id,"/").concat(e.position_id),{request_id:e._id});case 3:(s=t.sent)&&(console.log("===================================="),console.log({reDoPlacement:s}),console.log("===================================="),o.props.fetchDistrictPosts(o.props.auth.user_access.district_id,(function(t,e){t||(e.length>0&&o.state.loadingPost&&(console.error("error loading school post: ",e),o.props.PushPopupAlert({title:e,theme:S.a.danger})),o.setLoadingPost(!1))})),a="",a=s.data.length>0?s.data.length===o.state.approvedPosts?"All confirmed posts has been placed on school!":"".concat(s.data.length," of ").concat(e.occupied_posts?e.occupied_posts-(e.received_posts?e.received_posts:0):0," post(s) has been placed on school!"):"Placement failed, Please wait for the next application period!",o.props.PushPopupAlert({title:a,theme:s.data.length>0?S.a.success:S.a.info})),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error({doPlacement_reply:t.t0}),o.props.PushPopupAlert({title:Object(A.a)(t.t0),theme:S.a.danger});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),o.generateDataForSchoolRequest=function(t){var e=[],s=[],i=[];return o.props.districtPosts&&t.forEach((function(t){var a=o.props.districtPosts.find((function(e){return e._id===t.requested_post_id}));if(a)if(i.push(a),e.includes(a.school_id)){var n=s.findIndex((function(t){return t.school_id===a.school_id}));s[n].available_places.findIndex((function(t){return t.position_id===a.position_id}))<0&&s[n].available_places.push({position_id:a.position_id,requested_teacher:t.confirmed_posts})}else s.push({school_id:a.school._id,school_name:a.school.school_name,request_id:a._id,district_id:a.district_id,sector_id:a.school.sector_id,province_id:a.school.province_id,gender:a.male_number>a.female_number?"F":"M",available_places:[{position_id:a.position_id,requested_teacher:t.confirmed_posts}]})})),{requests:s,posts:i}},o.addSchoolRequest=function(){var t=Object(a.a)(i.a.mark((function t(e,s){var a,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={requested_teachers:e},t.prev=1,t.next=4,u.a.post("".concat(w.a.PLACEMENT,"/requestteachers/"),a);case 4:if(!(n=t.sent)){t.next=11;break}return console.log("===================================="),console.log({addSchoolRequest:n}),console.log("===================================="),t.next=11,o.doPlacement(s[0]);case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),console.error({addSchoolRequest_reply:t.t0}),o.props.PushPopupAlert({title:Object(A.a)(t.t0),theme:S.a.danger});case 17:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e,s){return t.apply(this,arguments)}}(),o.submitRequest=Object(a.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o.state.confirmedPosts&&0!==o.state.confirmedPosts.length){t.next=2;break}return t.abrupt("return",o.setFormError({element:"approved_posts",msg:"Invalid number of approved post"}));case 2:if(o.setLoadingRequest(!0),t.prev=3,"CONFIRM"!==o.state.modalState){t.next=11;break}return t.next=7,u.a.patch("".concat(w.a.PLACEMENT,"/requestpostdistributed"),{confirmedPost:o.state.confirmedPosts});case 7:if(!t.sent){t.next=11;break}return t.next=11,o.addSchoolRequest(o.generateDataForSchoolRequest(o.state.confirmedPosts).requests,o.generateDataForSchoolRequest(o.state.confirmedPosts).posts);case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(3),console.error({post_relpy:t.t0}),o.props.PushPopupAlert({title:Object(A.a)(t.t0),theme:S.a.danger});case 17:o.setLoadingRequest(!1);case 18:case"end":return t.stop()}}),t,null,[[3,13]])}))),o.filterQualifications=function(t,e){var s=t;return Object(q.f)(e)||(s=t.filter((function(t){return t.category_id===e}))),s},o.generateFormData=function(t,e){var s=null;if(!Object(q.f)(t)&&!Object(q.f)(e)&&o.props.systemPositions&&o.props.districtPosts){var i=o.props.systemPositions.filter((function(s){return s.subcategory_id===e&&s.education_institute_id.education_institute_id===t}));o.props.districtPosts.forEach((function(t){var e=i.find((function(e){return e.position_id===t.position_id}));e&&(null===s?s=[{post_id:t._id,school_id:t.school_id,school_name:t.school.school_name,position_id:e.position_id,position_name:e.position_title,female:t.female_number,male:t.male_number,requested_post:t.needed_posts,distributed_post:t.confirmed_posts?t.confirmed_posts:0,total_post:t.female_number+t.male_number+(t.confirmed_posts?t.confirmed_posts:0),total_staff:t.female_number+t.male_number+(t.received_posts?t.received_posts:0),new_teacher:t.received_posts?t.received_posts:0,vacant_post:(t.confirmed_posts?t.confirmed_posts:0)-(t.received_posts?t.received_posts:0),status:t.requested_post_status}]:s.push({post_id:t._id,school_id:t.school_id,school_name:t.school.school_name,position_id:e.position_id,position_name:e.position_title,female:t.female_number,male:t.male_number,requested_post:t.needed_posts,distributed_post:t.confirmed_posts?t.confirmed_posts:0,total_post:t.female_number+t.male_number+(t.confirmed_posts?t.confirmed_posts:0),total_staff:t.female_number+t.male_number+(t.received_posts?t.received_posts:0),new_teacher:t.received_posts?t.received_posts:0,vacant_post:(t.confirmed_posts?t.confirmed_posts:0)-(t.received_posts?t.received_posts:0),status:t.requested_post_status}))}))}return s},o.getAllowedPlacementByDegree=function(t,e){var s=0,i=o.props.activeAcademicSession&&"none"!==o.props.activeAcademicSession?o.props.activeAcademicSession._id:"",a=t.find((function(t){return t.institution_id===o.state.institute_id&&t.subcategory_id===e&&t.post_request_session_id===i}));return a&&(s=a.confirmed_post),s},o.getLimitations=function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=0,a=0,n=0,c=e.find((function(t){return t.institution_id===o.state.institute_id&&"none"!==o.props.activeAcademicSession&&t.post_request_session_id===o.props.activeAcademicSession._id&&t.subcategory_id===o.state.qualification_id}));return(i=c?c.confirmed_post:0)>0&&t.forEach((function(t){var e=o.state.confirmedPosts?o.state.confirmedPosts.find((function(e){return e.requested_post_id===t.post_id})):void 0;t.post_id===s?a+=t.total_post-t.distributed_post:a+=t.total_post-t.distributed_post+(e?e.confirmed_posts:0),n+=t.total_post+(e?e.confirmed_posts:0)})),{general:i,distributed:a,allDistributed:n}},o.tableData=function(){if(o.state.loadingPost||null===o.props.districtPlacementLimits)return[Object(R.jsx)("tr",{className:"border-b border-gray-200 hover:bg-gray-100",children:Object(R.jsx)("td",{className:"p-3 text-center",colSpan:11,children:"Loading post request(s)"})},1)];if(!o.generateFormData(o.state.institute_id,o.state.qualification_id))return[Object(R.jsx)("tr",{className:"border-b border-gray-200 hover:bg-gray-100",children:Object(R.jsx)("td",{className:"p-3 text-center",colSpan:11,children:Object(R.jsx)(y.b,{theme:y.a.Dark,value:"Select institute and Qualification to view request!"})})},1)];var t=o.generateFormData(o.state.institute_id,o.state.qualification_id);return 0===t.length?[Object(R.jsx)("tr",{className:"border-b border-gray-200 hover:bg-gray-100",children:Object(R.jsx)("td",{className:"p-3 text-center",colSpan:10,children:"No Data Found"})},1)]:(console.log("===================================="),console.log({dataTable:t}),console.log("===================================="),t.map((function(e,s){return Object(R.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-100 group",children:[Object(R.jsx)("td",{className:"py-3 px-4 text-left",children:s+1}),Object(R.jsx)("td",{className:"py-3 px-4 text-left",children:e.school_name}),Object(R.jsx)("td",{className:"py-3 px-4 text-left",children:e.position_name}),Object(R.jsx)("td",{className:"py-3 px-4 text-left text-base font-bold",children:e.female}),Object(R.jsx)("td",{className:"py-3 px-4 text-left text-base font-bold",children:e.male}),Object(R.jsx)("td",{className:"py-3 px-4 text-left text-base font-bold",children:e.requested_post}),Object(R.jsx)("td",{className:"py-3 px-4 text-left text-base font-medium",children:o.state.thisPostTable&&null!==o.state.modalState?Object(R.jsx)("input",{type:"number",value:o.getAssignedValuePost(e.post_id),className:"rounded border px-2 py-1 w-28",autoFocus:e.post_id===o.state.thisPostTable.post_id,onChange:function(s){return o.assignConfirmedPost(e,Number(s.target.value),t)},onFocus:function(){return o.setSelectedPostId(e.post_id)},disabled:o.state.loadingRequest}):e.status!==C.c.INITIATED?e.distributed_post:"-"}),!o.state.thisPostTable&&Object(R.jsxs)(h.Fragment,{children:[Object(R.jsx)("td",{className:"py-3 px-4 text-left text-base font-medium",children:e.total_post}),Object(R.jsx)("td",{className:"py-3 px-4 text-left text-base font-medium",children:e.total_staff}),Object(R.jsx)("td",{className:"py-3 px-4 text-left text-base font-medium",children:e.status===C.c.RECEIVED?e.new_teacher:"-"}),Object(R.jsx)("td",{className:"py-3 px-4 text-left text-base font-medium",children:e.status!==C.c.INITIATED?e.vacant_post:"-"})]}),Object(R.jsxs)("td",{className:"py- text-left",children:[e.post_id===o.state.selectedPostId&&Object(R.jsxs)("div",{className:"flex items-center gap-3",children:[Object(R.jsxs)("div",{className:"rounded text-gray-500 text-base font-bold",children:[Object(R.jsx)("span",{className:"text-black",children:o.getLimitations(t,o.props.districtPlacementLimits,e.post_id).distributed+o.getAssignedValuePost(e.post_id)})," ","of"," ",o.getLimitations(t,o.props.districtPlacementLimits,e.post_id).general]}),Object(R.jsx)("button",{className:"btn bg-blue-100 text-blue-500 group-hover:bg-blue-500 group-hover:text-blue-50 ".concat(o.state.loadingRequest&&"cursor-wait"),title:"Save changes",onClick:function(){return o.submitRequest()},disabled:o.state.loadingRequest,children:o.state.loadingRequest?"Loading...":"Save"}),Object(R.jsx)("button",{className:"btn bg-gray-100 text-gray-500 group-hover:bg-gray-500 group-hover:text-gray-50 ".concat(o.state.loadingRequest&&"cursor-not-allowed"),title:"Cancel changes",onClick:function(){o.setThisPostTable(null),o.setModalState(null),o.setTableColumns(k),o.setSelectedPostId(""),o.setConfirmedPosts(null)},disabled:o.state.loadingRequest,children:"Cancel"})]}),null===o.state.thisPostTable&&null===o.state.modalState&&Object(R.jsx)("div",{className:"flex item-center justify-end gap-1",children:o.getAllowedPlacementByDegree(o.props.districtPlacementLimits,o.state.qualification_id)>0&&e.status===C.c.INITIATED&&Object(R.jsx)("button",{className:"btn btn-blue",title:"View User Profile",onClick:function(){o.setThisPostTable(e),o.setModalState("CONFIRM"),o.setTableColumns(F)},children:"Reply"})})]})]},s+e.post_id)})))},o.state={modalState:null,filterByPosition:"",institute_id:"",category_id:"",qualification_id:"",loadingRequest:!1,loading:!0,loadingPost:!0,thisPost:null,viewPost:!1,approvedPosts:0,selectedPostId:"",formError:null,thisPostTable:null,confirmedPosts:null,leftPlacements:0,tableColumns:k},o}return Object(r.a)(s,[{key:"render",value:function(){var t,e=this;return Object(q.f)(this.props.auth.user_access.district_id)?Object(R.jsx)(x.a,{to:"/"}):null!==this.props.activeAcademicSession&&"none"===this.props.activeAcademicSession?Object(R.jsxs)("div",{className:"bg-yellow-100 rounded flex flex-col items-center justify-center p-6 my-8 text-yellow-900 border border-yellow-900",children:[Object(R.jsx)(b.S,{className:"text-6xl md:text-9xl"}),Object(R.jsxs)("div",{className:"text-center flex flex-col",children:[Object(R.jsx)("span",{className:"text-2xl md:text-4xl font-extrabold",children:"No academic active session"}),Object(R.jsx)("span",{className:"text-lg",children:"Please Wait for the system to publish the sessions or contact the administrator"})]})]}):this.state.loading||this.state.loadingPost?Object(R.jsx)("div",{className:"text-center mt-7 font-bold text-4xl text-gray-400 animate-pulse",children:"Loading data..."}):Object(R.jsxs)("div",{children:[Object(R.jsxs)("div",{className:"flex flex-row items-start gap-4 my-2 overflow-x-auto",children:[Object(R.jsx)(m.a,{className:"text-blue-600 text-5xl md:block hidden"}),Object(R.jsx)("div",{className:"w-full",children:Object(R.jsx)("div",{className:"flex justify-between w-full",children:Object(R.jsxs)("div",{className:"flex flex-col gap-1 justify-between",children:[Object(R.jsx)("h1",{className:"md:text-4xl text-3xl font-semibold",children:"Schools requests"}),Object(R.jsx)("div",{className:"flex-row items-center md:gap-3 gap-2",children:Object(R.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[Object(R.jsx)("span",{className:"text-gray-600 text-lg",children:"Academic session:"}),Object(R.jsx)("span",{className:"text-gray-600 font-semibold text-xl",children:null===(t=this.props.activeAcademicSession)||void 0===t?void 0:t.title})]})})]})})})]}),Object(R.jsxs)("div",{className:"bg-white shadow-md p-2 rounded overflow-x-auto",children:[Object(R.jsxs)("div",{className:"my-2 grid grid-cols-1 sm:grid-cols-3 items-center gap-2",children:[Object(R.jsxs)("select",{className:"border-2 w-full md:w-auto border-gray-700 bg-white p-2 rounded focus:outline-none",value:this.state.institute_id,onChange:function(t){e.setInstituteId(t.target.value),e.setLeftPlacement(0)},disabled:null!==this.state.thisPostTable||null!==this.state.modalState,children:[Object(R.jsx)("option",{value:"",children:"Select Institute"}),this.props.schoolLevels.education_categories&&this.props.schoolLevels.education_categories.length>0?this.props.schoolLevels.education_categories.map((function(t,e){return Object(R.jsx)("option",{value:t.education_institute_id,children:t.education_category_title},e+1)})):Object(R.jsx)("option",{value:"",children:"No institute found"})]}),Object(R.jsxs)("select",{className:"w-full md:w-auto border-2 border-gray-700 bg-white p-2 rounded focus:outline-none",value:this.state.category_id,onChange:function(t){return e.setCategoryId(t.target.value)},disabled:null!==this.state.thisPostTable||null!==this.state.modalState,children:[Object(R.jsx)("option",{value:"",children:"Document category"}),this.props.document.documentCategory&&this.props.document.documentCategory.length>0?this.props.document.documentCategory.map((function(t,e){return Object(R.jsx)("option",{value:t.user_detail_category_id,children:t.title},e+1)})):Object(R.jsx)("option",{value:"",children:"No document category found"})]}),Object(R.jsxs)("select",{className:"w-full md:w-auto border-2 border-gray-700 bg-white p-2 rounded focus:outline-none",value:this.state.qualification_id,onChange:function(t){e.setQualificationId(t.target.value),e.setLeftPlacement(0)},disabled:null!==this.state.thisPostTable||null!==this.state.modalState,children:[Object(R.jsx)("option",{value:"",children:"Select Qualification"}),this.props.document.documentSubCategory&&this.filterQualifications(this.props.document.documentSubCategory,this.state.category_id).length>0?this.filterQualifications(this.props.document.documentSubCategory,this.state.category_id).map((function(t,e){return Object(R.jsx)("option",{value:t.user_detail_subcategory_id,children:t.title},e+1)})):Object(R.jsx)("option",{value:"",children:"No qualification found"})]})]}),Object(R.jsx)(N.a,{columns:this.state.tableColumns,rows:this.tableData,pagination:!0,search:!0,thColor:"gray"})]}),this.state.modalState&&this.state.thisPost&&this.props.systemPositions&&Object(R.jsx)(v.d,{backDrop:!0,theme:v.c.default,close:function(){e.setThisPost(null),e.setModalState(null)},displayClose:!0,backDropClose:!1,title:Object(R.jsx)("div",{className:"flex flex-row gap-4 items-center",children:Object(R.jsx)("div",{className:"flex flex-col",children:Object(R.jsx)("span",{className:"font-bold text-2xl text-gray-500",children:"Responding to requested post"})})}),widthSizeClass:v.b.large,padding:{title:!0,body:!1,footer:!1},children:Object(R.jsx)("div",{className:"px-4 mx-auto mb-4 mt-3",children:Object(R.jsxs)("div",{className:"flex flex-col gap-3",children:[Object(R.jsx)("div",{className:"rounded bg-gray-100 border p-2",children:Object(R.jsx)("table",{children:Object(R.jsxs)("tbody",{children:[Object(R.jsxs)("tr",{children:[Object(R.jsx)("td",{className:"text-lg text-gray-700",children:"School:"}),Object(R.jsx)("td",{className:"font-medium px-4 text-lg text-gray-700",children:this.state.thisPost.school.school_name})]}),Object(R.jsxs)("tr",{children:[Object(R.jsx)("td",{className:"text-lg text-gray-700",children:"Position:"}),Object(R.jsx)("td",{className:"font-medium px-4 text-lg text-gray-700",children:Object(q.d)(this.props.systemPositions,this.state.thisPost.position_id)?Object(q.d)(this.props.systemPositions,this.state.thisPost.position_id).position_title:""})]}),Object(R.jsxs)("tr",{children:[Object(R.jsx)("td",{className:"text-lg text-gray-700",children:"Needed posts (number):"}),Object(R.jsx)("td",{className:"font-medium px-4 text-lg text-gray-700",children:this.state.thisPost.needed_posts})]}),Object(R.jsxs)("tr",{children:[Object(R.jsx)("td",{className:"text-lg text-gray-700",children:"Occupation (number):"}),Object(R.jsx)("td",{className:"font-medium px-4 text-lg text-gray-700",children:this.state.thisPost.occupied_posts})]}),Object(R.jsxs)("tr",{children:[Object(R.jsx)("td",{className:"text-lg text-gray-700",children:"Explanation:"}),Object(R.jsx)("td",{className:"font-medium px-4 text-lg text-gray-700",children:this.state.thisPost.description})]}),Object(R.jsxs)("tr",{children:[Object(R.jsx)("td",{className:"text-lg text-gray-700",children:"Requested date:"}),Object(R.jsx)("td",{className:"font-medium px-4 text-lg text-gray-700",children:Object(D.a)(this.state.thisPost.request_date.toString())})]})]})})}),Object(R.jsx)("div",{className:"bg-white",children:Object(R.jsxs)("form",{onSubmit:this.submitRequest,children:[Object(R.jsx)("div",{className:"text-base leading-6 space-y-4 text-gray-700 sm:text-lg sm:leading-7",children:Object(R.jsxs)("div",{className:"flex flex-col",children:[Object(R.jsx)("label",{children:"Approved posts (number)"}),Object(R.jsx)("input",{type:"number",className:"appearance-none rounded w-full py-1 px-4 border-2 bg-white focus:outline-none focus:bg-gray-100 ".concat(null!==this.state.formError&&"approved_posts"===this.state.formError.element?"border-red-500":"border-gray-700"),value:this.state.approvedPosts,onChange:function(t){e.setApprovedPosts(Number(t.target.value))},min:0,max:this.state.thisPost.needed_posts,placeholder:"1",disabled:this.state.loadingRequest}),null!==this.state.formError&&"approved_posts"===this.state.formError.element&&Object(R.jsx)("span",{className:"text-red-600 font-bold text-xs",children:this.state.formError.msg})]})}),Object(R.jsxs)("div",{className:"pt-4 flex justify-between",children:[Object(R.jsx)("button",{className:"btn bg-gray-400 text-white hover:bg-gray-600",onClick:function(){e.setThisPost(null),e.setApprovedPosts(0),e.setModalState(null)},children:"Exit"}),Object(R.jsx)("button",{className:"btn bg-primary text-white hover:bg-blue-600",disabled:this.state.loadingRequest,children:this.state.loadingRequest?"Loading...":"Respond"})]})]})})]})})}),this.state.viewPost&&null===this.state.modalState&&this.state.thisPost&&this.props.systemPositions&&Object(R.jsx)(v.d,{backDrop:!0,theme:v.c.default,close:function(){e.setThisPost(null),e.setViewPost(!1)},displayClose:!0,backDropClose:!1,title:Object(R.jsx)("div",{className:"flex flex-row gap-4 items-center",children:Object(R.jsx)("div",{className:"flex flex-col",children:Object(R.jsx)("span",{className:"font-bold text-2xl text-gray-500",children:"Viewing Post Request"})})}),widthSizeClass:v.b.extraLarge,padding:{title:!0,body:!1,footer:!1},children:Object(R.jsx)("section",{className:"px-4 mx-auto mb-4 mt-3 flex items-start",children:Object(R.jsxs)("section",{className:"w-full",children:[Object(R.jsxs)("div",{className:"flex flex-row item-center justify-left gap-3 mb-2",children:[Object(R.jsx)("span",{className:"text-gray-500",children:"Position: "}),Object(R.jsx)("span",{className:"font-bold",children:Object(q.d)(this.props.systemPositions,this.state.thisPost.position_id)?Object(q.d)(this.props.systemPositions,this.state.thisPost.position_id).position_title:"Unknown position"})]}),Object(R.jsx)("div",{className:"my-2",children:Object(R.jsxs)("table",{className:"w-full border",id:"report_content",children:[Object(R.jsx)("thead",{className:"bg-blue-50 border-b border-gray-300 text-gray-600 font-bold text-sm",children:Object(R.jsxs)("tr",{children:[Object(R.jsx)("td",{className:"px-2 py-2",children:"Requested posts"}),Object(R.jsx)("td",{className:"px-2 py-2",children:"Approved posts"}),Object(R.jsx)("td",{className:"px-2 py-2",children:"Placed posts"}),Object(R.jsx)("td",{className:"px-2 py-2",children:"Received posts"}),Object(R.jsx)("td",{className:"px-2 py-2",children:"Not received posts"}),Object(R.jsx)("td",{className:"px-2 py-2",children:"Status"}),Object(R.jsx)("td",{})]})}),Object(R.jsx)("tbody",{children:Object(R.jsxs)("tr",{children:[Object(R.jsx)("td",{className:"px-2 py-2",children:this.state.thisPost.needed_posts}),Object(R.jsx)("td",{className:"px-2 py-2",children:this.state.thisPost.requested_post_status!==C.c.INITIATED?Object(R.jsx)("div",{className:"flex items-center gap-1",children:this.state.thisPost.confirmed_posts}):"-"}),Object(R.jsx)("td",{className:"px-2 py-2",children:this.props.districtPlacements&&this.state.thisPost.requested_post_status!==C.c.INITIATED?Object(R.jsx)("span",{children:Object(I.getPlacementByRequest)(this.props.districtPlacements,this.state.thisPost._id).length}):"-"}),Object(R.jsx)("td",{className:"px-2 py-2",children:this.state.thisPost.requested_post_status===C.c.RECEIVED?this.state.thisPost.received_posts:"-"}),Object(R.jsx)("td",{className:"px-2 py-2",children:this.props.districtPlacements&&this.state.thisPost.requested_post_status===C.c.RECEIVED?Object(R.jsx)("span",{children:Object(I.getPlacementByRequest)(this.props.districtPlacements,this.state.thisPost._id,T.b.REJECTED).length}):"-"}),Object(R.jsx)("td",{className:"px-2 py-2",children:Object(R.jsx)("span",{className:"px-2 py-1 font-semibold rounded ".concat(this.state.thisPost.requested_post_status===C.c.INITIATED?"text-gray-700 bg-gray-100 dark:bg-gray-700 dark:text-gray-100":this.state.thisPost.requested_post_status===C.c.CONFIRMED?"text-blue-700 bg-blue-100 dark:bg-blue-700 dark:text-blue-100":"text-green-800 bg-green-100 dark:bg-green-800 dark:text-green-100"),children:this.props.districtPlacements?Object(E.b)(this.state.thisPost.requested_post_status,Object(I.getPlacementByRequest)(this.props.districtPlacements,this.state.thisPost._id,"all").length,Object(I.getPlacementByRequest)(this.props.districtPlacements,this.state.thisPost._id,T.b.PLACED).length,Object(I.getPlacementByRequest)(this.props.districtPlacements,this.state.thisPost._id,T.b.REJECTED).length):Object(E.b)(this.state.thisPost.requested_post_status,0,0,0)})}),Object(R.jsxs)("td",{children:[this.state.thisPost.requested_post_status===C.c.INITIATED&&Object(R.jsx)("button",{className:"font-bold py-1 px-4 rounded bg-gray-500 text-white hover:bg-gray-700",onClick:function(){e.setModalState("UPDATE")},disabled:this.state.thisPost.requested_post_status!==C.c.INITIATED,children:"Reply"}),this.props.districtPlacements&&0===Object(I.getPlacementByRequest)(this.props.districtPlacements,this.state.thisPost._id,T.b.PENDING).length&&Object(I.getPlacementByRequest)(this.props.districtPlacements,this.state.thisPost._id,T.b.REJECTED).length>0&&Object(R.jsx)("button",{className:"font-bold ml-2 py-1 px-4 rounded bg-gray-500 text-white hover:bg-gray-700",onClick:function(){return e.reDoPlacement(e.state.thisPost)},disabled:this.state.loadingRequest,children:"Do placement"})]})]})})]})}),Object(q.d)(this.props.systemPositions,this.state.thisPost.position_id)&&Object(R.jsx)(L.a,{thisPosition:Object(q.d)(this.props.systemPositions,this.state.thisPost.position_id),isGuest:!0})]})})})]})}}]),s}(h.Component),B=Object(g.b)((function(t){var e=t.auth,s=t.schools,o=t.system_settings,i=t.schoolLevels,a=t.document,n=t.sessionPlan;return{auth:e,districtPosts:s.districtPosts,districtPlacements:s.districtPlacements,systemPositions:o.systemPositions,schoolLevels:i,document:a,activeAcademicSession:n.activeAcademicSession,districtPlacementLimits:s.districtPlacementLimits}}),{getDocumentCategory:j.i,getDocumentSubCategory:j.k,FC_GetPositionsByInstitution:O.a,fetchDistrictPosts:_.d,getDistrictPlacement:_.f,updateSchoolPost:_.n,loadEducationCategories:f.Ic,getActiveAcademicSession:P.k,getDistrictPlacementLimit:_.g,PushPopupAlert:f.Rb})(M)}}]);
//# sourceMappingURL=66.6530199b.chunk.js.map