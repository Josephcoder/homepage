(this["webpackJsonpreact-redux-typescript-advance"]=this["webpackJsonpreact-redux-typescript-advance"]||[]).push([[65],{1303:function(e,t,s){"use strict";s.r(t),s.d(t,"UserManagement",(function(){return v}));var r,a=s(11),n=s(25),c=s(24),o=s(27),i=s(26),l=s(4),u=s(66),d=s(203),g=s(67),h=s(12),f=s(23),b=s(3),m=s(689),j=s(21),x=s(32),p=s(713),y=s(1);!function(e){e.All_Users="All Users",e.Active_Users="Active Users",e.Blocked_Users="Blocked Users"}(r||(r={}));var U=function(e){Object(o.a)(s,e);var t=Object(i.a)(s);function s(e){var c;return Object(n.a)(this,s),(c=t.call(this,e)).setUserData=function(e){c.setState({userData:e})},c.setLoadingUsers=function(e){c.setState({loadingUsers:e})},c.setUserTabs=function(e){c.setState({userTabs:e})},c.setFilerByRoleLevel=function(e){c.setState({filterByRoleLevel:e})},c.setOpenFilterByRole=function(e){c.setState({openFilterByRole:e})},c.setLoading=function(e){c.setState({loading:e})},c.setCurrentPage=function(e){c.setState({currentPage:e})},c.setLastLoadedPage=function(e){c.setState({lastLoadedPage:e})},c.setManageUser=function(e){c.setState({manageUser:e})},c.setChangeRole=function(e){c.setState({changeRole:e})},c.setManageUserId=function(e){c.setState({manageUserId:e})},c.componentDidMount=function(){c.props.accessRoles.length||c.props.FC_GetAccessRoles((function(e,t,s){c.setState({loading:e})})),null===c.props.schoolLevels.education_categories||0===c.props.schoolLevels.education_categories.length?c.props.loadEducationCategories((function(e){c.setLoading(e)})):c.setLoading(!1),c.props.userList.users?(c.setUserData(c.props.userList.users[0].data),c.setLoadingUsers(!1)):c.props.fetchUserAccess(1,(function(e,t,s){c.setLoadingUsers(e),e||(Object(x.f)(t)||c.props.PushPopupAlert({title:t,theme:j.a.danger}),s&&(c.setUserData(s),c.setLoadingUsers(!1),console.log("===================================="),console.log({setLoadingUsers:e}),console.log("====================================")))}))},c.reloadUsers=function(e){c.state.lastLoadedPage.includes(e)||c.props.fetchUserAccess(e,(function(t,s,r){if(c.setLoadingUsers(t),!t&&(Object(x.f)(s)||c.props.PushPopupAlert({title:s,theme:j.a.danger}),r)){var n=Object(a.a)(c.state.userData);n=n.concat(r),c.setUserData(n),c.setLastLoadedPage([].concat(Object(a.a)(c.state.lastLoadedPage),[e])),c.setLoadingUsers(!1),console.log("===================================="),console.log({setLoadingUsers:t}),console.log("====================================")}}))},c.labelCounts=function(e){return{allUser:e.length,activeUser:e.filter((function(e){return!e.is_active})).length,blockedUser:e.filter((function(e){return e.is_active})).length}},c.filterByRole=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";return"all"!==t?e.filter((function(e){return e.default_access&&e.default_access.system_user_role_id===t})):e},c.getRoleById=function(e,t){return e.find((function(e){return e.system_user_role_id===t}))},c.generatePages=function(e){var t=Math.ceil(e/m.h),s=Array.from(Array(t+1-1).keys()).map((function(e){return 1+e})).slice(0,5);t>4&&c.state.currentPage>2&&(s=t-c.state.currentPage>1?[c.state.currentPage-2,c.state.currentPage-1,c.state.currentPage,c.state.currentPage+1,c.state.currentPage+2]:t-c.state.currentPage===1?[c.state.currentPage-3,c.state.currentPage-2,c.state.currentPage-1,c.state.currentPage,c.state.currentPage+1]:[c.state.currentPage-4,c.state.currentPage-3,c.state.currentPage-2,c.state.currentPage-1,c.state.currentPage]);var r=!1,a=!1,n=!1,o=!1;return t>1&&1!==c.state.currentPage&&(n=!0),t>1&&c.state.currentPage!==t&&(o=!0),t>3&&c.state.currentPage>3&&(r=!0),t>3&&c.state.currentPage!==t&&t-c.state.currentPage>2&&(a=!0),Object(y.jsxs)("div",{className:"flex text-gray-700",children:[r&&Object(y.jsx)("button",{className:"h-12 w-12 ml-1 flex justify-center items-center rounded-full bg-gray-100 hover:bg-gray-200 cursor-pointer",onClick:function(){return c.setCurrentPage(1)},children:Object(y.jsx)(d.e,{className:"w-6 h-6"})}),n&&Object(y.jsx)("button",{className:"h-12 w-12 ml-1 flex justify-center items-center rounded-full bg-gray-100 hover:bg-gray-200",onClick:function(){return c.setCurrentPage(c.state.currentPage-1)},children:Object(y.jsx)(d.g,{className:"w-6 h-6"})}),Object(y.jsx)("div",{className:"flex h-12 font-medium rounded-full mx-1 bg-gray-100",children:s.map((function(e,t){return Object(y.jsx)("button",{className:"w-12 md:flex justify-center items-center gap-2 rounded-full ".concat(c.state.currentPage===e?"bg-gray-600 hover:bg-gray-500 text-white cursor-auto":"hover:bg-gray-200"),disabled:c.state.currentPage===e,onClick:function(){c.setCurrentPage(e),c.reloadUsers(e)},children:e},Math.random())}))}),o&&Object(y.jsx)("button",{className:"h-12 w-12 mr-1 flex justify-center items-center rounded-full bg-gray-100 hover:bg-gray-200 cursor-pointer",onClick:function(){c.setCurrentPage(c.state.currentPage+1),c.reloadUsers(c.state.currentPage+1)},children:Object(y.jsx)(d.h,{className:"w-6 h-6"})}),a&&Object(y.jsx)("button",{className:"h-12 w-12 mr-1 flex justify-center items-center rounded-full bg-gray-100 hover:bg-gray-200 cursor-pointer",onClick:function(){c.setCurrentPage(t),c.reloadUsers(t)},children:Object(y.jsx)(d.f,{className:"w-6 h-6"})})]})},c.dataResult=function(e){if(c.props.userList.users){var t=c.props.userList.users.findIndex((function(e){return e.page===c.state.currentPage}));if(t>=0)return e===r.Active_Users?c.props.userList.users[t].data.filter((function(e){return e.is_active})):e===r.Blocked_Users?c.props.userList.users[t].data.filter((function(e){return!e.is_active})):c.props.userList.users[t].data}return e===r.Active_Users?c.state.userData.filter((function(e){return e.is_active})):e===r.Blocked_Users?c.state.userData.filter((function(e){return!e.is_active})):c.state.userData},c.FC_DoSearch=function(e){if(e.preventDefault(),Object(x.f)(c.state.searchFind))return c.setState({searchError:"Required!"});Object(m.a)(c.state.searchFind,(function(e,t,s){c.setState({searchLoading:e}),!1===e&&(Object(x.f)(t)?null===s||""===s?c.props.PushPopupAlert({title:"User not found!",theme:j.a.warning}):(console.log("===================--------================="),console.log(s),console.log("===================--------================="),c.setManageUser(s),c.setManageUserId(s.user_id)):c.props.PushPopupAlert({title:t,theme:j.a.danger}))}))},c.state={userTabs:r.All_Users,userData:[],loadingUsers:!0,filterByRoleLevel:"all",openFilterByRole:!1,loading:!0,manageUser:null,changeRole:!1,currentPage:1,lastLoadedPage:[1],searchFind:"",searchLoading:!1,searchError:"",manageUserId:""},c}return Object(c.a)(s,[{key:"render",value:function(){var e=this;return!0===this.state.loading||null===this.props.userList.users?Object(y.jsx)("div",{className:"text-center mt-7 font-bold text-4xl text-gray-400 animate-pulse",children:"Loading users..."}):Object(y.jsxs)("div",{className:"mb-4",children:[!this.state.manageUser&&Object(y.jsx)("div",{className:"mt-3 rounded flex flex-row justify-between items-center",children:Object(y.jsxs)("div",{className:"flex flex-row items-center gap-3",children:[Object(y.jsx)(h.Rb,{className:"text-6xl text-blue-600"}),Object(y.jsx)("div",{className:"flex flex-col",children:Object(y.jsx)("span",{className:"text-blue-600 text-2xl font-bold",children:"System Users Management"})})]})}),Object(y.jsxs)("div",{className:"bg-white shadow rounded border border-gray-2 p-2 w-full overflow-x-auto ".concat(this.state.manageUser?"mt-3":""),children:[!this.state.manageUser&&Object(y.jsxs)("section",{className:"flex flex-col sm:flex-row justify-between items-center gap-2",children:[Object(y.jsxs)("section",{className:"flex flex-col sm:flex-row items-start gap-3",children:[Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{className:"my-0 sm:my-2 font-medium text-xl flex items-center gap-2 w-full",children:[Object(y.jsx)(u.f,{}),"Filter by roles"]}),Object(y.jsx)("div",{className:"flex flex-col mb-0 sm:mb-3 w-full",children:Object(y.jsxs)("select",{className:"w-full bg-white text-grey-darker border-2 border-gray-500 rounded h-10 px-2 focus:outline-none focus:bg-gray-100 animate__animated animate__fadeIn ".concat(this.state.loadingUsers&&"cursor-wait"),onChange:function(t){return e.setFilerByRoleLevel(t.target.value)},disabled:this.state.loadingUsers,value:this.state.filterByRoleLevel,children:[Object(y.jsx)("option",{value:"all",children:"All roles"}),this.props.accessRoles.length>0?this.props.accessRoles.map((function(e,t){return Object(y.jsx)("option",{value:e.system_user_role_id,children:e.role},Math.random())})):Object(y.jsx)("option",{value:"",disabled:!0,children:"No Role"})]})})]}),Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{className:"my-2 font-medium text-xl flex items-center gap-2",children:[Object(y.jsx)(u.f,{}),"Filter by status"]}),Object(y.jsx)("div",{className:"flex items-start md:items-center justify-start md:justify-end gap-2",children:Object(y.jsx)("select",{className:"w-full bg-white text-grey-darker border-2 border-gray-500 rounded h-10 px-2 focus:outline-none focus:bg-gray-100 animate__animated animate__fadeIn ".concat(this.state.loadingUsers&&"cursor-wait"),onChange:function(t){return e.setUserTabs(t.target.value)},disabled:this.state.loadingUsers,children:Object.values(r).map((function(e,t){return Object(y.jsx)("option",{value:e,children:e},Math.random())}))})})]})]}),Object(y.jsxs)("section",{children:[Object(y.jsx)("form",{onSubmit:this.FC_DoSearch,className:"w-full mt-8 bg-transparent border-2 rounded-md lg:max-w-sm ".concat(Object(x.f)(this.state.searchError)?"border-gray-500 dark:border-gray-700 focus-within:border-gray-400 dark:focus-within:border-gray-400":"border-red-500 dark:border-red-700 focus-within:border-red-400 dark:focus-within:border-red-400"),children:Object(y.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[Object(y.jsx)("input",{type:"text",placeholder:"Search by NID or Phone or Email",className:"flex-1 h-10 px-4 py-2 m-1 text-gray-700 placeholder-gray-400 bg-transparent border-none appearance-none dark:text-gray-200 focus:outline-none focus:placeholder-transparent focus:ring-0",disabled:this.state.searchLoading||this.state.loadingUsers||this.state.loading,onChange:function(t){return e.setState({searchFind:t.target.value,searchError:""})}}),Object(y.jsx)("button",{type:"submit",className:"h-10 px-4 py-2 m-1 text-sm text-white transition-colors duration-200 transform bg-gray-500 rounded-md hover:bg-gray-400 focus:outline-none focus:bg-gray-400",disabled:this.state.searchLoading||this.state.loadingUsers||this.state.loading,children:this.state.searchLoading?"Loading":"Search"})]})}),!Object(x.f)(this.state.searchError)&&Object(y.jsx)("span",{className:"text-red-500",children:this.state.searchError})]})]}),this.state.manageUser&&Object(y.jsxs)("div",{className:"flex items-center gap-3 mb-2 text-gray-600",children:[Object(y.jsx)("button",{className:"inline-block p-3 transition rounded-full bg-gray-400 ripple hover:bg-gray-600 focus:outline-none",onClick:function(){e.setManageUser(null),e.setChangeRole(!1),e.setState({searchFind:"",searchError:""})},children:Object(y.jsx)(g.e,{className:"w-6 h-6 text-gray-50"})}),Object(y.jsxs)("div",{className:"flex flex-col hidden",children:[Object(y.jsx)("span",{className:"text-gray-800 font-semibold text-2xl",children:this.state.manageUser.user_info.fname+" "+this.state.manageUser.user_info.lname}),Object(y.jsx)("span",{className:"text-gray-600 font-normal text-sm",children:this.state.manageUser.email})]})]}),this.state.userData&&Object(y.jsxs)("section",{children:[Object(y.jsx)(p.b,{users:this.filterByRole(this.dataResult(this.state.userTabs),this.state.filterByRoleLevel),roleList:this.props.accessRoles,userTypes:this.state.userTabs===r.Active_Users?"blocked":this.state.userTabs===r.Blocked_Users?"active":"all",loadingUser:this.state.loadingUsers,setLoadingUser:this.setLoadingUsers,manageUser:this.state.manageUser,setManageUser:this.setManageUser,changeRole:this.state.changeRole,setChangeRole:this.setChangeRole,currentPage:this.state.currentPage,manageUserId:this.state.manageUserId,setManageUserId:this.setManageUserId,searchFind:this.state.searchFind}),!this.state.loadingUsers&&!this.state.searchLoading&&!this.state.manageUser&&Object(y.jsx)("div",{className:"flex flex-col items-center mb-3",children:this.props.userList.total_users&&this.generatePages(this.props.userList.total_users)})]})]})]})}}]),s}(l.Component),v=Object(f.b)((function(e){var t=e.users,s=e.access,r=e.schoolLevels;return{userList:t,accessRoles:s.accessRoles,schoolLevels:r}}),{fetchUserAccess:m.e,FC_GetAccessRoles:b.R,loadEducationCategories:b.Hc,PushPopupAlert:b.Qb})(U)}}]);
//# sourceMappingURL=65.c7633601.chunk.js.map