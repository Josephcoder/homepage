(this["webpackJsonpreact-redux-typescript-advance"]=this["webpackJsonpreact-redux-typescript-advance"]||[]).push([[61],{1284:function(e,t,a){"use strict";a.r(t),a.d(t,"DoExam",(function(){return A}));var s=a(4),i=a.n(s),n=a(7),o=a(11),d=a(37),r=a(24),c=a(23),l=a(26),m=a(25),p=a(5),x=a(21),u=a(3),_=a(16),E=a(129),f=a(32),b=a(302),h=a(19),j=a(33),g=a(43),w=a(39),v=a(8),y=a.n(v),S=a(9),O=a(10),N=a(56),C=a(1),q=function(e){Object(l.a)(a,e);var t=Object(m.a)(a);function a(e){var s,c;return Object(r.a)(this,a),(c=t.call(this,e)).setLoading=function(e){c.setState({loading:e})},c.setSubmitQuestionAnswer=function(e){c.setState({submitQuestionAnswer:e})},c.setProfileWindowStatus=function(e){c.setState({windowStatus:{profile:e,questionsList:c.state.windowStatus.questionsList}})},c.setQuestionsListWindowStatus=function(e){c.setState({windowStatus:{profile:c.state.windowStatus.profile,questionsList:e}})},c.setSelectedQuestion=function(e){c.setState({selectedQuestion:e})},c.answerQuestionFn=function(e){console.log("sUBMITT: ",e),c.props.setExamQuestionAnswer(e)},c.setCompletedTest=function(e){c.setState({completedTest:e})},c.changingExamStatusLoading=function(e){c.setState({changingExamStatus:e})},c.initializeEmptyList=function(){var e=localStorage.getItem(u.a.ADD_ANSWER);if(null!==e){var t=JSON.parse(e).questionAnswers;if(t&&t.length>0){var a;for(var s in t)c.props.addExamAnswer(t[s]);t.length===(null===(a=c.props.doExam.exam_answers)||void 0===a?void 0:a.exam_questions.length)&&(c.setState({completedTest:!0}),c.props.SubmitExamAnswers(c.props.auth.user.n_id))}}},c.examDetails=function(){if(null!==c.props.periods.selected_period){var e=c.props.candidateExam.selected_exam_details;if(null!==e)return e}return null},c.checkUserExam=function(e){null!==c.props.positions.selected_position&&null!==c.props.candidateExam.selected_exam_details&&null!==c.props.candidateExam.exam_room_details&&c.props.RequestUserExamDetails({user:c.props.auth.user.user_id,position:c.props.positions.selected_position.position_id,exam:e,userExamLocation:{district_id:c.props.candidateExam.exam_room_details.district_id,center_id:c.props.candidateExam.exam_room_details.center_id,room_id:c.props.candidateExam.exam_room_details.room_id}},c.setLoading,c.setLoadExamResultMessage,c.props.BackToExamination)},c.loadUserProfileDetails=function(){c.setState({loading:!0}),c.props.FC_GetProfileDetails(c.props.auth.user.user_id,(function(e,t){c.setState({loading:!1})})),c.setState({loading:!1})},c.componentDidMount=function(){var e,t,a;(""!==c.props.auth.user.sex&&0!==c.props.auth.user.sex.length||c.loadUserProfileDetails(),null!==c.props.course.courses&&0!==c.props.course.courses.length||c.props.loadCourses(c.setLoading),null!==c.props.questionTypes.questionTypes&&0!==c.props.questionTypes.questionTypes.length||c.props.loadQuestionTypes(c.setLoading),c.initializeEmptyList(),0===(null===(e=c.props.doExam.exam_answers)||void 0===e?void 0:e.exam_questions.length)&&c.props.doExam.exam_answers.exam_questions_answers&&(null===(t=c.props.doExam.exam_answers.exam_questions_answers)||void 0===t?void 0:t.questionAnswers.length)>0)&&c.setState({testAnswers:null===(a=c.props.doExam.exam_answers.exam_questions_answers)||void 0===a?void 0:a.questionAnswers})},c.componentWillUnmount=function(){c.props.candidateExam.exam_room_details&&c.props.socket.socket.emit(_.e.USER_DISCONNECTED_ONLINE_SERVER,{room_id:c.props.candidateExam.exam_room_details.room_id,user_id:c.props.auth.user.user_id})},c.setLoadExamResultNoMessage=function(e,t){!1===t&&c.props.PushPopupAlert({title:"Error!",description:e,theme:w.a.danger})},c.setLoadExamResultMessage=function(e,t){(c.props.PushPopupAlert({title:!0===t?"Success!":"Error!",description:e,theme:!0===t?w.a.success:w.a.danger}),!1===t&&null!==c.props.candidateExam.candidate_exam)&&(void 0===c.props.candidateExam.user_exams_done.find((function(e){var t;return e.exam_paper===(null===(t=c.props.candidateExam.candidate_exam)||void 0===t?void 0:t.exam_paper_id)}))&&c.props.CleanCandidateExam(c.props.candidateExam.candidate_exam.exam_paper_id))},c.SubmitAnswer=function(){if(null!==c.props.candidateExam.candidate_exam&&c.props.candidateExam.question_answers.length>0){var e,t=[],a=Object(d.a)(c.props.candidateExam.candidate_exam.questions);try{for(a.s();!(e=a.n()).done;){var s=e.value;t=[].concat(Object(o.a)(t),[s.question_id])}}catch(l){a.e(l)}finally{a.f()}var i,n=Object(d.a)(c.props.candidateExam.question_answers);try{var r=function(){var e=i.value,a=c.props.candidateExam.candidate_exam.questions.find((function(t){return t.question_id===e.question_id}));!1===e.status&&c.props.candidateExam.exam_room_details&&void 0!==a&&!0===Object(N.d)(c.props.candidateExam.question_answers,a,Object(N.b)(a.type,c.props.questionTypes.questionTypes))&&c.props.SubmitExamQuestionAnswer({user:c.props.auth.user.user_id,exam_paper:c.props.candidateExam.candidate_exam.exam_paper_id,position:c.props.candidateExam.exam_room_details.position.position_id,disability:c.props.auth.user.disability,fname:c.props.auth.user.fname,lname:c.props.auth.user.lname,gender:c.props.auth.user.sex,email:c.props.auth.user.email,phone_number:c.props.auth.user.phone_number,in_education:c.props.auth.user.in_education,questions_order:t,question:e.question_id,language:void 0===a.question.find((function(e){return e.language===c.props.candidateExam.selected_language}))?a.question[0].language:c.props.candidateExam.selected_language,userAnswer:e.answers,position_code:c.props.candidateExam.exam_room_details.position.position_code},c.setSubmitQuestionAnswer,c.setLoadExamResultNoMessage)};for(n.s();!(i=n.n()).done;)r()}catch(l){n.e(l)}finally{n.f()}}},c.submitExam=Object(n.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===c.props.candidateExam.candidate_exam||null===c.props.candidateExam.exam_room_details){e.next=15;break}return t=c.props.candidateExam.candidate_exam.exam_paper_id,a=c.props.auth.user.user_id,c.setState({submitWholeExam:!0}),e.prev=4,e.next=7,y.a.put("".concat(S.a.DO_EXAM,"/answersheet/submit/").concat(a,"/").concat(t));case 7:e.sent&&(c.doneExam(),c.setState({submittedExam:!0}),document.fullscreenElement&&document.exitFullscreen&&document.exitFullscreen(),c.props.PushPopupAlert({title:"Success!",description:"Exam submitted successfully!",theme:w.a.success})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),c.props.PushPopupAlert({title:"Error occured!",description:Object(g.f)(e.t0),theme:w.a.danger});case 14:c.setState({submitWholeExam:!1});case 15:case"end":return e.stop()}}),e,null,[[4,11]])}))),c.setSubmitModal=function(e){c.setState({submitModalStatus:e})},c.startExam=function(){c.setState({display_exam:!0,start_exam:!0}),null!==c.props.candidateExam.selected_exam_id&&c.requestExam(c.props.candidateExam.selected_exam_id,(function(e,t){!0===e&&c.props.loadCandidateExamFromSupervisor(t,null!==c.state.candidateDetailsProctoring&&!0===c.state.candidateDetailsProctoring.user.joined)}))},c.pauseExam=function(){c.setState({display_exam:!1,start_exam:!1,inExam:!1})},c.doneExam=function(){if(null!==c.props.candidateExam.exam_room_details&&null!==c.props.candidateExam.candidate_exam){var e,t=c.props.candidateExam.exam_room_details.room_id,a={application_session_id:null===(e=c.props.auth.application_session)||void 0===e?void 0:e.session_plan_id,description:"Done the exam",done_by:"System",event_type_id:_.f.DONE_EXAM,exam_id:c.props.candidateExam.candidate_exam.exam_paper_id,position_id:c.props.candidateExam.exam_room_details.position.position_id,room_id:t,time:(new Date).toString(),user_id:c.props.auth.user.user_id};c.props.FC_SaveEvent(a,(function(e,t){})),c.props.socket.socket.emit(_.e.EXAM_DONE_SERVER,a)}},c.timeOutExam=function(){if(null!==c.props.candidateExam.exam_room_details&&null!==c.props.candidateExam.candidate_exam){var e,t=c.props.candidateExam.exam_room_details.room_id,a={application_session_id:null===(e=c.props.auth.application_session)||void 0===e?void 0:e.session_plan_id,description:"Time out",done_by:"System",event_type_id:_.f.TIME_OUT,exam_id:c.props.candidateExam.candidate_exam.exam_paper_id,position_id:c.props.candidateExam.exam_room_details.position.position_id,room_id:t,time:(new Date).toString(),user_id:c.props.auth.user.user_id};c.props.FC_SaveEvent(a,(function(e,t){})),c.props.socket.socket.emit(_.e.TIME_OUT_SERVER,a),c.submitExam()}},c.requestExam=function(e,t){c.props.socket.socket.emit(_.e.REQUEST_EXAM_SERVER,e,t)},c.state={windowStatus:{profile:!1,questionsList:!1},selectedQuestion:null!==c.props.doExam.exam_answers?null===(s=c.props.doExam.exam_answers)||void 0===s?void 0:s.exam_questions[0]:null,testAnswers:[],completedTest:!1,examStatus:!1,loading:!1,loadUserExamErr:"",submitQuestionAnswer:!1,submitWholeExam:!1,display_exam:!1,changingExamStatus:!1,start_exam:!1,start_time:"",duration:0,added_minutes:0,group_id:"",inExam:!1,submittedExam:!1,candidateDetailsProctoring:null,submitModalStatus:!1},c}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return null===this.props.candidateExam.selected_exam_id?Object(C.jsx)(f.a,{to:"/candidate-exams"}):!0===this.state.loading||null===this.props.candidateExam.exam_room_details?Object(C.jsx)("div",{className:"fixed top-0 left-0 z-50 rounded px-4 py-4 bg-gray-200 w-full h-screen flex flex-col items-center justify-center",children:Object(C.jsxs)("div",{className:"bg-white rounded mx-4 my-4 px-4 py-4 w-full h-full",children:[Object(C.jsx)("div",{className:"text-gray-600 text-lg px-4 mb-4",children:"Loading, Please wait..."}),Object(C.jsx)(j.a,{})]})}):!0===this.state.submitWholeExam?Object(C.jsx)("div",{className:"fixed top-0 left-0 z-50 rounded px-4 py-4 bg-gray-200 w-full h-screen flex flex-col items-center justify-center",children:Object(C.jsxs)("div",{className:"bg-white rounded mx-4 my-4 px-4 py-4 w-full h-full",children:[Object(C.jsx)("div",{className:"text-gray-600 text-lg px-4 mb-4",children:"Submitting your exam, Please wait..."}),Object(C.jsx)(j.a,{})]})}):Object(C.jsx)("div",{className:"fixed top-0 left-0 z-50 w-full",children:Object(C.jsxs)(p.Fragment,{children:[!1===this.state.inExam?Object(C.jsx)("div",{className:"fixed top-0 left-0 z-50 rounded px-4 py-4 bg-gray-200 w-full h-screen flex flex-col items-center justify-center",children:Object(C.jsxs)("div",{className:"bg-white rounded mx-4 my-4 px-4 py-4 w-full h-full",children:[Object(C.jsx)("div",{className:"text-white text-lg px-4 mb-4",children:"Confirm"}),Object(C.jsxs)("div",{className:"flex flex-col items-center justify-center mb-10",children:[Object(C.jsx)(j.a,{}),Object(C.jsx)("div",{className:"text-yellow-800 text-xl font-bold my-5",children:"Something went wrong, retry again!"}),Object(C.jsx)("div",{onClick:function(){return window.location.reload()},className:"btn bg-yellow-100 text-yellow-800 border border-yellow-600 w-max text-center cursor-pointer",children:"Click here to reload"})]})]})}):Object(C.jsx)(b.a,{homeProctoring:!0,startExam:function(){e.startExam(),e.setState({start_exam:!0})},restartExam:function(){if(null!==e.props.candidateExam.candidate_exam){var t=e.props.candidateExam.candidate_exam.exam_paper_id;e.props.CleanCandidateExamAnswers(t),e.props.setExamStatus(e.props.auth.user.user_id,t,E.a.Restart,"Exam restarted by supervisor",e.changingExamStatusLoading)}e.startExam(),e.setState({start_exam:!0}),e.setState({inExam:!0})},stopExam:function(){e.pauseExam(),null!==e.props.candidateExam.candidate_exam&&e.props.setExamStatus(e.props.auth.user.user_id,e.props.candidateExam.candidate_exam.exam_paper_id,E.a.Done,"All candidates ended by supervisor",e.changingExamStatusLoading),null!==e.props.candidateExam.candidate_exam&&e.props.CleanCandidateExam(e.props.candidateExam.candidate_exam.exam_paper_id)},room_id:this.props.candidateExam.exam_room_details.room_id,exam_id:null===this.props.candidateExam.candidate_exam?this.props.candidateExam.selected_exam_id:this.props.candidateExam.candidate_exam.exam_paper_id,position_id:this.props.candidateExam.exam_room_details.position.position_id,application_session_id:this.props.candidateExam.exam_room_details.period_id,removeClient:function(){null!==e.props.candidateExam.candidate_exam&&e.props.setExamStatus(e.props.auth.user.user_id,e.props.candidateExam.candidate_exam.exam_paper_id,E.a.Removed,"Exam stopped by supervisor",e.changingExamStatusLoading),null!==e.props.candidateExam.candidate_exam&&e.props.CleanCandidateExam(e.props.candidateExam.candidate_exam.exam_paper_id)},examAlreadyDone:function(){},candidateStopExam:function(e){},candidateContinueExam:function(t){e.startExam(),e.setState({start_exam:!0}),e.setState({inExam:!0})},joinedRoom:function(t){e.setState({group_id:t.group_id})},changeTime:function(t){e.setState({duration:t.duration,start_time:t.start_time})},candidateProctoringDetails:function(t){e.setState({candidateDetailsProctoring:t}),!0===t.user.joined&&(e.startExam(),e.props.candidateExam.candidate_exam&&e.props.requestUserAnswers(e.props.candidateExam.candidate_exam.exam_paper_id,e.props.auth.user.user_id,e.setLoading)),console.log("Joined: ",t.user.joined)},ejectCandidate:function(e){},children:Object(C.jsx)("div",{className:"p-20 text-center text-4xl",children:"Janvier tests"})}),null===this.props.candidateExam.candidate_exam&&!1===this.state.inExam&&Object(C.jsx)(h.c,{title:"",backDrop:!0,theme:h.b.default,close:function(){return e.props.setSelectedCandidateExam(null)},backDropClose:!1,widthSizeClass:h.a.extraLarge,displayClose:!1,padding:{title:!1},children:Object(C.jsx)("div",{className:"rounded px-4 py-4 mx-2 my-2",children:null===this.props.course.courses?Object(C.jsx)(j.a,{}):Object(C.jsxs)("div",{children:[Object(C.jsx)("div",{className:"flex flex-row items-center gap-2",children:Object(C.jsxs)("div",{className:"my-2 w-full",children:[Object(C.jsx)("div",{className:"text-blue-600 text-2xl font-extrabold mb-2",children:this.props.course.selected_course&&Object(C.jsxs)("div",{children:[Object(C.jsxs)("span",{children:[this.props.course.selected_course.course_code,"-"]}),Object(C.jsx)("span",{children:this.props.course.selected_course.course_name})]})}),Object(C.jsxs)("div",{className:"flex flex-row gap-3 text-sm",children:[Object(C.jsx)("span",{className:"text-gray-600 font-normal",children:"Exam date:"}),Object(C.jsx)("span",{className:"text-blue-600 font-bold",children:this.examDetails()&&Object(g.a)(this.examDetails().exam_date,"DD/MM/YYYY")})]}),Object(C.jsxs)("div",{className:"flex flex-row gap-3 text-sm",children:[Object(C.jsx)("span",{className:"text-gray-600 font-normal",children:"Start time:"}),Object(C.jsx)("span",{className:"text-blue-600 font-bold",children:"start tme"})]}),Object(C.jsxs)("div",{className:"flex flex-row gap-3 text-sm",children:[Object(C.jsx)("span",{className:"text-gray-600 font-normal",children:"Exam duration:"}),"duration of exam"]})]})}),Object(C.jsx)("div",{className:"flex flex-row justify-center items-center"}),Object(C.jsxs)("div",{className:"text-gray-600 font-bold text-l text-center mb-4",children:[Object(C.jsxs)("div",{className:"rounded px-4 py-4 bg-gray-100 my-4 text-sm text-left font-normal",children:[Object(C.jsx)("div",{className:"text-left text-gray-800 text-xl mb-3 font-extrabold",children:"Examination rules"}),"rules hahahha"]}),Object(C.jsxs)("div",{className:"rounded px-4 py-4 bg-gray-100 my-4 text-sm text-left font-normal",children:[Object(C.jsx)("div",{className:"text-left text-gray-800 text-xl mb-3 font-extrabold",children:"Exam Proctoring rules"}),"exam rules"]}),Object(C.jsx)("span",{className:"text-blue-700",children:"If you are ready, click to start the exam now, The system will start to count your time!"})]}),Object(C.jsxs)("div",{className:"flex flex-row items-center justify-between mt-2",children:[Object(C.jsx)("button",{onClick:function(){return e.props.setSelectedCandidateExam(null)},className:"btn bg-gray-50 text-gray-600 border",children:"Go Back"}),Object(C.jsx)("button",{onClick:function(){e.setState({inExam:!0}),null!==e.props.candidateExam.selected_exam_id&&e.requestExam(e.props.candidateExam.selected_exam_id,(function(t,a){!0===t&&e.props.loadCandidateExamFromSupervisor(a,null!==e.state.candidateDetailsProctoring&&!0===e.state.candidateDetailsProctoring.user.joined)}))},className:"btn bg-blue-600 text-white",children:"I accept, Start exam"})]})]})})}),!0===this.state.submittedExam&&Object(C.jsx)(h.c,{title:"",backDrop:!0,theme:h.b.default,close:function(){return e.props.setSelectedCandidateExam(null)},backDropClose:!1,widthSizeClass:h.a.medium,displayClose:!1,padding:{title:!1},children:Object(C.jsxs)("div",{className:"px-5 py-5",children:[Object(C.jsx)("div",{className:"flex flex-row items-center justify-center",children:Object(C.jsx)(O.t,{className:"text-7xl text-blue-600"})}),Object(C.jsx)("div",{className:"flex flex-row items-center justify-center",children:Object(C.jsx)("span",{className:"text-3xl font-extrabold text-blue-600 text-center",children:"Exam submitted"})}),Object(C.jsx)("div",{className:"flex flex-row items-center justify-center mt-3 mb-5",children:Object(C.jsx)("span",{className:"text-center text-gray-500",children:"Thank you for attending the exam, Your exam has been submitted successfully!, click continue to the applications list, you will open the application to view your score right now."})}),Object(C.jsx)("div",{className:"flex flex-row items-center justify-center",children:Object(C.jsx)("div",{onClick:function(){e.setState({submittedExam:!1}),document.fullscreenElement&&document.exitFullscreen&&document.exitFullscreen(),e.props.candidateExam.candidate_exam&&e.props.CleanCandidateExam(e.props.candidateExam.candidate_exam.exam_paper_id),window.location.reload()},className:"btn bg-blue-100 text-blue-700 rounded w-max cursor-pointer",children:"Continue to view marks"})})]})})]})})}}]),a}(p.Component),A=Object(x.b)((function(e){return{auth:e.auth,doExam:e.doExam,candidateExam:e.candidateExam,system:e.system,course:e.course,periods:e.periods,questionTypes:e.questionTypes,positions:e.positions,socket:e.socket,proctoring:e.proctoring}}),{loadExam:u.Ec,addExamAnswer:u.Xb,deleteExamAnswers:u.fc,SubmitExamAnswers:u.Sb,ChangeExamStatus:u.d,setSelectedCandidateExam:u.Wc,loadCandidateExam:u.yc,setSelectedExamQuestion:u.bd,loadCourses:u.Bc,setSelectedPeriod:u.dd,setExamQuestionAnswer:u.Sc,loadQuestionTypes:u.Kc,RequestUserExamDetails:u.Ob,PushPopupAlert:u.Kb,CleanCandidateExam:u.e,SubmitExamQuestionAnswer:u.Tb,GetUserExamDetails:u.Eb,BackToExamination:u.c,setExamStatus:u.Tc,FC_SaveEvent:u.nb,FC_AddRules:u.m,CleanCandidateExamAnswers:u.f,loadCandidateExamFromSupervisor:u.zc,requestUserAnswers:u.Pc,FC_GetProfileDetails:u.S})(q)}}]);
//# sourceMappingURL=61.b06e81cb.chunk.js.map