{"version":3,"sources":["containers/Shortlisting/Shortlisting.tsx"],"names":["RunShortlistAlgorithm","callBack","a","axios","post","API","APPLICATION","res","data","console","log","errorToText","_Shortlisting","props","sendMessages","session","setState","loading","put","DO_EXAM","_id","success","error","componentDidMount","schoolLevels","selectedEducationCategory","education_categories","test","find","itm","education_institute_id","auth","education_institution_id","undefined","setSelectedEducationCategory","state","selected_institute","this","className","description","session_plan","session_plan_name","onClick","window","confirm","Component","Shortlisting","connect","positions","system"],"mappings":"2YA8BaA,EAAqB,uCAAG,WACnCC,GADmC,eAAAC,EAAA,6DAGnCD,GAAS,EAAM,GAAI,GAAI,IAHY,kBAKfE,IAAMC,KAAN,UAAcC,IAAIC,YAAlB,cALe,OAK3BC,EAL2B,OAMjCN,GAAS,EAAO,qBAAsB,GAAIM,EAAIC,MAC9CC,QAAQC,IAAI,YAAaH,GAPQ,gDASjCN,GAAS,EAAO,GAAIU,YAAY,EAAD,IAAS,IACxCF,QAAQC,IAAI,UAAZ,sBAViC,yDAAH,sDAc5BE,E,kDACJ,WAAYC,GAA2B,IAAD,8BACpC,cAAMA,IASRC,aAVsC,uCAUvB,WAAOC,GAAP,eAAAb,EAAA,6DACb,EAAKc,SAAS,CAAEC,SAAS,IADZ,kBAGOd,IAAMe,IAAN,UACbb,IAAIc,QADS,6BACmBJ,EAAQK,MAJlC,OAGLb,EAHK,OAMXE,QAAQC,IAAI,QAASH,GACrB,EAAKS,SAAS,CACZK,QAAS,8BACTC,MAAO,GACPL,SAAS,IAVA,gDAaXR,QAAQC,IAAI,UAAZ,sBACA,EAAKM,SAAS,CAAEK,QAAS,GAAIC,MAAOX,YAAY,EAAD,IAASM,SAAS,IAdtD,yDAVuB,wDA4BtCM,kBAAoB,WAClB,GAA0D,OAAtD,EAAKV,MAAMW,aAAaC,2BAC2B,OAAjD,EAAKZ,MAAMW,aAAaE,qBAA+B,CACzD,IAAMC,EAAO,EAAKd,MAAMW,aAAaE,qBAAqBE,MACxD,SAACC,GAAD,OACEA,EAAIC,yBACJ,EAAKjB,MAAMkB,KAAKC,iCAEPC,IAATN,GACF,EAAKd,MAAMqB,6BAA6BP,KAlC9C,EAAKQ,MAAQ,CACXlB,SAAS,EACTI,QAAS,GACTC,MAAO,IAN2B,E,0CA2CtC,WAAU,IAAD,eACDc,EAAkB,UACtBC,KAAKxB,MAAMW,aAAaE,4BADF,aACtB,EAA8CE,MAC5C,SAACC,GAAD,OACEA,EAAIC,yBACJ,EAAKjB,MAAMkB,KAAKC,4BAEtB,OAA2B,IAAvBK,KAAKF,MAAMlB,QAEX,sBAAKqB,UAAU,4BAAf,UACE,cAAC,IAAD,IACA,qBAAKA,UAAU,aAAf,iDAKJ,cAAC,WAAD,UACE,gCACE,sBAAKA,UAAU,4BAAf,UACE,qBAAKA,UAAU,sCAAf,0BAGA,qBAAKA,UAAU,sBAAf,sIAIA,qBAAKA,UAAU,+CAAf,SACE,qBAAKA,UAAU,0FAAf,gCAKJ,sBAAKA,UAAU,4BAAf,UACE,qBAAKA,UAAU,sCAAf,kCAGA,qBAAKA,UAAU,sBAAf,yKAKA,qBAAKA,UAAU,2CAAf,SACE,sBAAKA,UAAU,iDAAf,UACE,qBAAKA,UAAU,0DAAf,SACE,sBAAMA,UAAU,sBAAhB,mBAEID,KAAKxB,MAAMW,aAAaC,iCAF5B,aAEI,EACIc,gBAIV,sBAAKD,UAAU,+EAAf,UACE,mDACA,sBAAMA,UAAU,sBAAhB,mBAEID,KAAKxB,MAAMW,aAAaC,iCAF5B,iBAEI,EACIe,oBAHR,aAEI,EACkBC,4BAM5B,gCAC0B,KAAvBJ,KAAKF,MAAMd,SACV,qBACEqB,QAAS,kBAAM,EAAK1B,SAAS,CAAEK,QAAS,MACxCiB,UAAU,4DAFZ,SAIGD,KAAKF,MAAMd,UAGM,KAArBgB,KAAKF,MAAMb,OACV,qBACEoB,QAAS,kBAAM,EAAK1B,SAAS,CAAEM,MAAO,MACtCgB,UAAU,8DAFZ,SAIGD,KAAKF,MAAMb,WAIlB,qBAAKgB,UAAU,+CAAf,cAC0BL,IAAvBG,GACC,qBACEM,QAAS,YAIC,IAFNC,OAAOC,QACL,+CAEkC,OAApCR,EAAmBI,cAEnB,EAAK1B,aAAasB,EAAmBI,eAGzCF,UAAU,wFAXZ,yC,GA9HYO,aAoKfC,EAAeC,aAdJ,SAAC,GAUnB,IATJhB,EASG,EATHA,KACAiB,EAQG,EARHA,UASA,MAAO,CAAEjB,KAAMA,EAAMkB,OADlB,EAPHA,OAQ6BD,YAAWxB,aADrC,EANHA,gBAUmD,CACnDU,mCAD0Ba,CAEzBnC","file":"static/js/67.32438390.chunk.js","sourcesContent":["import axios from \"axios\";\nimport React, { Component, Fragment } from \"react\";\nimport { connect } from \"react-redux\";\nimport {\n  Auth,\n  positionsStoreInterface,\n  schoolLevelsStoreInterface,\n  System,\n  setSelectedEducationCategory,\n} from \"../../actions\";\nimport Loading from \"../../components/Loading/Loading\";\nimport { education_category } from \"../../interfaces\";\nimport { ApplicationPeriodGet } from \"../../interfaces/application\";\nimport { StoreState } from \"../../reducers\";\nimport { API } from \"../../utils/api\";\nimport { errorToText } from \"../../utils/functions\";\n\ninterface ShortlistingProps {\n  auth: Auth;\n  system: System;\n  positions: positionsStoreInterface;\n  schoolLevels: schoolLevelsStoreInterface;\n  setSelectedEducationCategory: (category: education_category) => void;\n}\ninterface ShortlistingState {\n  loading: boolean;\n  success: string;\n  error: string;\n}\n\nexport const RunShortlistAlgorithm = async (\n  callBack: (loading: boolean, success: string, error: string, res: any) => void\n) => {\n  callBack(true, \"\", \"\", \"\");\n  try {\n    const res = await axios.post(`${API.APPLICATION}/settings`);\n    callBack(false, \"Done successfully!\", \"\", res.data);\n    console.log(\"Success: \", res);\n  } catch (error: any) {\n    callBack(false, \"\", errorToText(error), \"\");\n    console.log(\"Error: \", { ...error });\n  }\n};\n\nclass _Shortlisting extends Component<ShortlistingProps, ShortlistingState> {\n  constructor(props: ShortlistingProps) {\n    super(props);\n\n    this.state = {\n      loading: false,\n      success: \"\",\n      error: \"\",\n    };\n  }\n\n  sendMessages = async (session: ApplicationPeriodGet) => {\n    this.setState({ loading: true });\n    try {\n      const res = await axios.put(\n        `${API.DO_EXAM}/reports/mailtest/${session._id}`\n      );\n      console.log(\"Res: \", res);\n      this.setState({\n        success: \"Messages sent successfully!\",\n        error: \"\",\n        loading: false,\n      });\n    } catch (error: any) {\n      console.log(\"error: \", { ...error });\n      this.setState({ success: \"\", error: errorToText(error), loading: false });\n    }\n  };\n\n  componentDidMount = () => {\n    if (this.props.schoolLevels.selectedEducationCategory === null) {\n      if (this.props.schoolLevels.education_categories !== null) {\n        const test = this.props.schoolLevels.education_categories.find(\n          (itm) =>\n            itm.education_institute_id ===\n            this.props.auth.education_institution_id\n        );\n        if (test !== undefined) {\n          this.props.setSelectedEducationCategory(test);\n        }\n      }\n    }\n  };\n\n  render() {\n    const selected_institute =\n      this.props.schoolLevels.education_categories?.find(\n        (itm) =>\n          itm.education_institute_id ===\n          this.props.auth.education_institution_id\n      );\n    if (this.state.loading === true) {\n      return (\n        <div className=\"bg-white rounded p-5 mt-5\">\n          <Loading />\n          <div className=\"-mt-5 ml-5\">Sending messages, please wait...</div>\n        </div>\n      );\n    }\n    return (\n      <Fragment>\n        <div>\n          <div className=\"bg-white rounded mt-4 p-4\">\n            <div className=\"text-center text-4xl font-extrabold\">\n              Shortlisting\n            </div>\n            <div className=\"text-center text-lg\">\n              This option allows you to run the shortlisting algorithm. Please\n              remind that the algorithm will cancel custom decisionss\n            </div>\n            <div className=\"flex items-center justify-center w-full pt-4\">\n              <div className=\"px-3 py-2 rounded bg-gray-400 hover:bg-gray-600 text-white cursor-not-allowed font-bold\">\n                Run algorithm\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-white rounded mt-4 p-4\">\n            <div className=\"text-center text-4xl font-extrabold\">\n              Shortlisting results\n            </div>\n            <div className=\"text-center text-lg\">\n              This option allows you to send all applicants shortlisting updates\n              to inform them come to the system to view their applications\n              statuses through mobile sms\n            </div>\n            <div className=\"flex items-center justify-center text-lg\">\n              <div className=\"bg-blue-100 text-blue-900 w-max px-3 py-2 mt-3\">\n                <div className=\"flex flex-row items-center justify-center gap-3 text-xl\">\n                  <span className=\"uppercase font-bold\">\n                    {\n                      this.props.schoolLevels.selectedEducationCategory\n                        ?.description\n                    }\n                  </span>\n                </div>\n                <div className=\"flex flex-row items-center justify-center gap-3 text-black underline text-sm\">\n                  <span>Active session:</span>\n                  <span className=\"uppercase font-bold\">\n                    {\n                      this.props.schoolLevels.selectedEducationCategory\n                        ?.session_plan?.session_plan_name\n                    }\n                  </span>\n                </div>\n              </div>\n            </div>\n            <div>\n              {this.state.success !== \"\" && (\n                <div\n                  onClick={() => this.setState({ success: \"\" })}\n                  className=\"bg-green-100 text-green-800 px-3 py-2 cursor-pointer my-2\"\n                >\n                  {this.state.success}\n                </div>\n              )}\n              {this.state.error !== \"\" && (\n                <div\n                  onClick={() => this.setState({ error: \"\" })}\n                  className=\"bg-yellow-100 text-yellow-800 px-3 py-2 cursor-pointer my-2\"\n                >\n                  {this.state.error}\n                </div>\n              )}\n            </div>\n            <div className=\"flex items-center justify-center w-full pt-4\">\n              {selected_institute !== undefined && (\n                <div\n                  onClick={() => {\n                    if (\n                      window.confirm(\n                        \"Are you sure do you want to send messages?\"\n                      ) === true &&\n                      selected_institute.session_plan !== null\n                    ) {\n                      this.sendMessages(selected_institute.session_plan);\n                    }\n                  }}\n                  className=\"px-3 py-2 rounded bg-green-600 hover:bg-green-800 text-white font-bold cursor-pointer\"\n                >\n                  Send messages\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nconst mapStateToProps = ({\n  auth,\n  positions,\n  system,\n  schoolLevels,\n}: StoreState): {\n  auth: Auth;\n  system: System;\n  positions: positionsStoreInterface;\n  schoolLevels: schoolLevelsStoreInterface;\n} => {\n  return { auth: auth, system, positions, schoolLevels };\n};\n\nexport const Shortlisting = connect(mapStateToProps, {\n  setSelectedEducationCategory,\n})(_Shortlisting);\n"],"sourceRoot":""}